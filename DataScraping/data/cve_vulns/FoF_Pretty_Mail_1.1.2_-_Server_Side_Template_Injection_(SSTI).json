{"source": "https://www.exploit-db.com/exploits/51948", "vulnName": "FoF Pretty Mail 1.1.2 - Server Side Template Injection (SSTI)", "vulnEDBID": "51948", "vulnCVE": "N/A", "author": "CHOKRI HAMMEDI", "exploitType": "WEBAPPS", "platform": "PHP", "datePublished": "2024-04-02", "vulnContent": "Exploit Title: FoF Pretty Mail 1.1.2 - Server Side Template Injection (SSTI)\nDate: 03/28/2024\nExploit Author: Chokri Hammedi\nVendor Homepage: https://flarum.org/\nSoftware Link: https://github.com/FriendsOfFlarum/pretty-mail\nVersion: 1.1.2\nTested on: Windows XP\nCVE: N/A\nDescription:\n\nThe FoF Pretty Mail extension for Flarum is vulnerable to Server-Side\nTemplate Injection (SSTI) due to the unsafe handling of template variables.\nAn attacker with administrative access can inject malicious code into the\nemail template, leading to arbitrary code execution on the server.\n\nSteps to Reproduce:\n\n- Log in as an administrator on the Flarum forum.\n- Navigate to the FoF Pretty Mail extension settings.\n- Edit the email default template and insert the following payload:\n\n{{ 7*7 }}\n{{ system('id') }}\n{{ system('echo \"Take The Rose\"') }}\n\n- Save the changes to the email template.\n- Trigger any action that sends an email, such as user registration or password reset.\n- The recipient of the email will see the result of the injected expressions (e.g., \"49\" for {{ 7*7 }}, the output of the id command for {{ system('id') }}, and the output of the echo \"Take The Rose\" command for {{ system('echo\"Take The Rose\"') }}) in the email content.\n            "}