{"source": "https://www.exploit-db.com/exploits/51947", "vulnName": "FoF Pretty Mail 1.1.2 - Local File Inclusion (LFI)", "vulnEDBID": "51947", "vulnCVE": "N/A", "author": "CHOKRI HAMMEDI", "exploitType": "WEBAPPS", "platform": "PHP", "datePublished": "2024-04-02", "vulnContent": "Exploit Title: FoF Pretty Mail 1.1.2 - Local File Inclusion (LFI)\nDate: 03/28/2024\nExploit Author: Chokri Hammedi\nVendor Homepage: https://flarum.org/\nSoftware Link: https://github.com/FriendsOfFlarum/pretty-mail\nVersion: 1.1.2\nTested on: Windows XP\nCVE: N/A\nDescription:\n\nThe FoF Pretty Mail extension for Flarum is vulnerable to Local File Inclusion (LFI) due to the unsafe handling of file paths in the email template. An attacker with administrative access can exploit this vulnerability to include sensitive files from the server's file system in the email content, potentially leading to information disclosure.\n\nSteps to Reproduce:\n\nLog in as an administrator on the Flarum forum.\n\nNavigate to the FoF Pretty Mail extension settings.\n\nEdit the email default template and insert the following payload at the end of the template:\n\n{{ include('/etc/passwd') }}\n\nSave the changes to the email template.\n\nTrigger any action that sends an email, such as user registration or password reset.\n\nThe recipient of the email will see the contents of the included file (in this case, /etc/passwd) in the email content.\n            "}