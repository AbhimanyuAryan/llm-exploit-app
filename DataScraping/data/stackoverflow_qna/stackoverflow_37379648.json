{"questionTitle": "how can I disable php file upload in wordpress", "question": "<p>I am trying to make upload avatar image for wordpress users in front end. I am using this code </p>\n\n<pre><code>$files = $_FILES['post_files'];\n\nforeach($files as $file){\n\n  if(is_array($file)){\n\n    $uploaded_file_type = $file['type'];\n    $allowed_file_types = array('image/jpg', 'image/jpeg', 'image/png', 'image/gif');\n    if(!in_array($uploaded_file_type, $allowed_file_types)) {\n      $errors['image_empty'] = __( 'this image is not valid', 'themename' );\n    } \n\n  }\n\n}\n</code></pre>\n\n<p>it's not allowing to upload php file , but if they change the php file extension as png or jpeg they can upload the php file to my server. I try to use <code>getimagesize()</code> but I couldn't, I am newbie for php. Or is there any other solution? </p>\n\n<p>thanks for answers</p>\n", "acceptedAnswer": "<p>If you use Wordpress image uplaoder(media uploader vs.) use this:</p>\n\n<p><strong>For disable any file format:</strong></p>\n\n<pre><code>add_filter('upload_mimes','remove_mime_types');\nfunction remove_mime_types($mimes){\n  unset( $mimes['mp4'] );\n}\n</code></pre>\n\n<p><strong>For enable any file format:</strong></p>\n\n<pre><code>add_filter('upload_mimes','add_custom_mime_types');\nfunction add_custom_mime_types($mimes){\n   return array_merge($mimes,array (\n     'ac3' =&gt; 'audio/ac3',\n     'mpa' =&gt; 'audio/MPA',\n     'flv' =&gt; 'video/x-flv',\n     'svg' =&gt; 'image/svg+xml'\n   ));\n}\n</code></pre>\n\n<p>for more information visit paulund's article: <a href=\"https://paulund.co.uk/change-wordpress-upload-mime-types\" rel=\"nofollow\">https://paulund.co.uk/change-wordpress-upload-mime-types</a></p>\n", "questionSource": "https://stackoverflow.com/questions/37379648/how-can-i-disable-php-file-upload-in-wordpress"}