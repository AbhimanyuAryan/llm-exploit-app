{"questionTitle": "I need a return D if value on 3 columns (A,B,C) match the reference table 3 column", "question": "<p>I need to know how many sessions the insurance allows depending on demographics.\nI have column A (insurance 1 or insurance 2), Column B (adult or minor), and column 3 (level of care 1 or 2). Depending on which 3 values in Columns A, B, and C, column D will have a different number of allowed sessions. This is the simple explanation for the example, in my real-life situation, there are 5 insurances and 5 levels.</p>\n<p>COLUMN A  / COLUMN B/ COLUMN C / COLUMN D</p>\n<p>INSURANCE 1 / MINOR / LEVEL 1 / 10 SESSIONS</p>\n<p>INSURANCE 1 / MINOR / LEVEL 2 / 20 SESSIONS</p>\n<p>INSURANCE 1 / ADULT / LEVEL 1 / 5 SESSIONS</p>\n<p>INSURANCE 1 / ADULT / LEVEL 2 / 10 SESSIONS</p>\n<p>INSURANCE 2 / MINOR / LEVEL 1 / 15 SESSIONS</p>\n<p>INSURANCE 2 / MINOR / LEVEL 2 / 30 SESSIONS</p>\n<p>INSURANCE 2 / ADULT / LEVEL 1 / 10 SESSIONS</p>\n<p>INSURANCE 2 / ADULT / LEVEL 2 / 20 SESSIONS</p>\n<p>I tried the IF, THEN type of formulas, but I didn't quite get the exact order of the elements of the formula.</p>\n", "acceptedAnswer": "<p>You can use the <code>FILTER</code> function.</p>\n<p>In the formula below, I <code>Name</code>'d the table <code>Sessions</code> and used Named Ranges for the three variables.</p>\n<p>I would also suggest you use <code>Data Validation</code> list dropdowns for the named variables to avoid the possibility of misspellings.</p>\n<pre><code>=IFERROR(\n    FILTER(\n        Sessions[COLUMN D],\n        (Sessions[COLUMN A] = Company) *\n            (Sessions[COLUMN B] = Age) *\n            (Sessions[COLUMN C] = Level)\n    ),\n    &quot;&quot;\n)\n</code></pre>\n<p><a href=\"https://i.stack.imgur.com/sm1eo.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/sm1eo.png\" alt=\"enter image description here\" /></a></p>\n<p><em>If you have an older version of Excel which lacks the <code>FILTER</code> function, you can use:</em></p>\n<pre><code>=IFERROR(\n    INDEX(\n        Sessions[COLUMN D],\n        MATCH(\n            1,\n            (Sessions[COLUMN A] = Company) *\n                (Sessions[COLUMN B] = Age) *\n                (Sessions[COLUMN C] = Level),\n            0\n        )\n    ),\n    &quot;&quot;\n)\n</code></pre>\n", "questionSource": "https://stackoverflow.com/questions/78277026/i-need-a-return-d-if-value-on-3-columns-a-b-c-match-the-reference-table-3-colu"}