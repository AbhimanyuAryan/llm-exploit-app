{"questionTitle": "How to find the total payment based on specific age ranges", "question": "<p>I am trying to solve a problem in MySQL where there is an insurance table, through which I need to find the total payment based on age ranges. Such as, 0-10 would have a certain amount of payment, 11-20 a certain amount and so on.</p>\n<p>I have written the following code to generate the age range</p>\n<pre><code>SELECT * FROM \n(\nSELECT \n    CASE\n        WHEN age &lt; 11 THEN '0-10'\n        WHEN age &gt; 10 AND age&lt; 21 THEN '11-20'\n        WHEN age &gt; 20 AND age&lt; 31 THEN '21-30'\n        WHEN age &gt; 30 AND age&lt; 41 THEN '31-40'\n        WHEN age &gt; 40 AND age&lt; 51 THEN '41-50'\n        WHEN age &gt; 50 AND age&lt; 61 THEN '51-60'\n    END AS age_range\n    FROM insurance\n) age_table\nGROUP BY age_range\nORDER BY age_range;\n</code></pre>\n<p>What I want to do now is to grab the payment and sum it according to the age ranges. I can't figure that out</p>\n", "acceptedAnswer": "<p>You need a <code>conditional sum</code>:</p>\n<pre><code>SELECT \n  SUM(CASE WHEN age &lt; 11 THEN amount END) AS &quot;0-10&quot;,\n  SUM(CASE WHEN age BETWEEN 11 AND 20 THEN amount END) AS &quot;11-20&quot;,\n  SUM(CASE WHEN age BETWEEN 21 AND 30 THEN amount END) AS &quot;21-30&quot;,\n  SUM(CASE WHEN age BETWEEN 31 AND 40 THEN amount END) AS &quot;31-40&quot;,\n  SUM(CASE WHEN age BETWEEN 41 AND 50 THEN amount END) AS &quot;41-50&quot;,\n  SUM(CASE WHEN age BETWEEN 51 AND 60 THEN amount END) AS &quot;51-60&quot;\nFROM insurance;\n</code></pre>\n<p>See this <a href=\"https://dbfiddle.uk/6zmlVgWI\" rel=\"nofollow noreferrer\">fiddle</a> with some sample data.</p>\n<p>Note: If it's possible you won't get any values for a specific range, the sum will be <code>NULL</code> for those ranges. If this is not intended and you would rather like to get 0 in this case, you can use <code>COALESCE</code>...</p>\n<p><code>...COALESCE(SUM(CASE WHEN age BETWEEN 31 AND 40 THEN amount END),0) AS &quot;31-40&quot;...</code></p>\n<p>... or add <code>ELSE 0</code>:</p>\n<p><code>...SUM(CASE WHEN age BETWEEN 41 AND 50 THEN amount ELSE 0 END) AS &quot;41-50&quot;...</code></p>\n<p>The mentioned fiddle shows that, too.</p>\n<p>Sidenote: Of course, you can also keep your original <code>&gt; x and &lt; y</code> conditions instead of using <code>BETWEEN</code>. I changed that because I think <code>BETWEEN</code> has a better readability.</p>\n", "questionSource": "https://stackoverflow.com/questions/78278436/how-to-find-the-total-payment-based-on-specific-age-ranges"}