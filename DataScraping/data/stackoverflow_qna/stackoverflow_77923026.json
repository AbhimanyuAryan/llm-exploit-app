{"questionTitle": "DockerFile PHP8.1 Debian SQL Server", "question": "<p>I had some trouble with my DockerFile, I have to create a docker image with php8.1, Linux and SQL Server.\nI made the following Docker, but I can\u00b4t make a connection to my DB, for example if I want to use the <code>slqcmd</code> command, I have to edit bash, then if a try a connection doesn\u00b4t work, just give me this error</p>\n<pre><code>Sqlcmd: Error: Microsoft ODBC Driver 18 for SQL Server : Login timeout expired.\nSqlcmd: Error: Microsoft ODBC Driver 18 for SQL Server : TCP Provider: Error code 0x2749.\nSqlcmd: Error: Microsoft ODBC Driver 18 for SQL Server : A network-related or instance-specific error has occurred while establishing a connection to 3332a686a938. Server is not found or not accessible. Check if instance name is correct and if SQL Server is configured to allow remote connections. For more information see SQL Server Books Online..\n</code></pre>\n<p>I just starting in this, so any help is welcome</p>\n<pre><code>FROM debian:11\n\nENV DEBIAN_FRONTEND noninteractive\n\n# ESTABLECER ZONA HORARIA\nENV     TZ=America/Santiago\nRUN     ln -snf /usr/share/zoneinfo/$TZ /etc/localtime &amp;&amp; echo $TZ &gt; /etc/timezone\n\n#Install update\nRUN apt-get update\nRUN apt-get upgrade -y\n\n#Install facilitators\nRUN apt-get -y install locate mlocate wget apt-utils curl apt-transport-https lsb-release \\\n             ca-certificates software-properties-common zip unzip vim rpl sendmail\n\nENV     PHP_MAX_SIZE=&quot;50M&quot;\n\n# Fix \u2018add-apt-repository command not found\u2019\nRUN apt-get install software-properties-common\n\nRUN wget -O /etc/apt/trusted.gpg.d/php.gpg https://packages.sury.org/php/apt.gpg\nRUN echo &quot;deb https://packages.sury.org/php/ $(lsb_release -sc) main&quot; | tee /etc/apt/sources.list.d/php.list\n\n#Install update\nRUN apt-get update\n\n# Set Timezone\nRUN ln -fs /usr/share/zoneinfo/${TZ} /etc/localtime \\\n    &amp;&amp; apt-get update \\\n    &amp;&amp; apt-get install -y --no-install-recommends tzdata \\\n    &amp;&amp; dpkg-reconfigure --frontend noninteractive tzdata\n\n#intall Apache + PHP\nRUN apt-get -y install apache2 libapache2-mod-php8.1 php8.1 php8.1-cli php8.1-common php8.1-opcache\n\n#OpenSsl\nRUN     apt-get update &amp;&amp; \\ \n    apt-get install -y libssl-dev\n\n#PHP Install CURl\nRUN apt-get -y install curl php8.1-curl\n\n#PHP Intall DOM, Json, XML e Zip\nRUN apt-get -y install php8.1-dom php8.1-xml php8.1-zip php8.1-soap php8.1-intl php8.1-xsl\n\n#PHP Install MbString\nRUN apt-get -y install php8.1-mbstring\n\n#PHP Install GD\nRUN apt-get -y install php8.1-gd\n\n#PHP Install PDO SqLite\nRUN apt-get -y install php8.1-pdo php8.1-pdo-sqlite php8.1-sqlite3\n\n#PHP Install PDO MySQL\nRUN apt-get -y install php8.1-pdo php8.1-pdo-mysql php8.1-mysql \n\n#PHP Install PDO PostGress\nRUN apt-get -y install php8.1-pdo php8.1-pgsql\n\n## -------- Config Apache ----------------\nRUN a2dismod mpm_event\nRUN a2dismod mpm_worker\nRUN a2enmod  mpm_prefork\nRUN a2enmod  rewrite\nRUN a2enmod  php8.1\n\n# Enable .htaccess reading\nRUN LANG=&quot;en_US.UTF-8&quot; rpl &quot;AllowOverride None&quot; &quot;AllowOverride All&quot; /etc/apache2/apache2.conf\n\n## ------------- LDAP ------------------\n#PHP Install LDAP\nRUN apt-get -y install php8.1-ldap\n\n#Apache2 enebla LDAP\nRUN a2enmod authnz_ldap\nRUN a2enmod ldap\n\n## ------------- Add-ons ------------------\n#Install GIT\nRUN apt-get -y install -y git-core\n\n#PHP Install Composer\nRUN curl -sS https://getcomposer.org/installer | php -- --install-dir=/usr/local/bin --filename=composer\n\n#PHP Install PHPUnit\n#https://phpunit.  de/announcements/phpunit-9.html\nRUN wget -O /usr/local/bin/phpunit-9.phar https://phar.phpunit.de/phpunit-9.phar; chmod +x /usr/local/bin/phpunit-9.phar; \\\nln -s /usr/local/bin/phpunit-9.phar /usr/local/bin/phpunit\n\nRUN apt-get -y install php8.1-dev php8.1-xml php8.1-intl\n\nENV ACCEPT_EULA=Y\n\nRUN curl -s  https://packages.microsoft.com/keys/microsoft.asc | apt-key add - \\\n    &amp;&amp; curl -s  https://packages.microsoft.com/config/debian/11/prod.list &gt; /etc/apt/sources.list.d/mssql-release.list\n\nRUN apt-get update\n\nRUN apt-get install -y --no-install-recommends \\\n        locales \\\n        apt-transport-https \\\n    &amp;&amp; echo &quot;en_US.UTF-8 UTF-8&quot; &gt; /etc/locale.gen \\\n    &amp;&amp; locale-gen\n\n# install MS ODBC 18\nRUN apt-get -y install msodbcsql18 mssql-tools18\n\nRUN echo 'export PATH=&quot;$PATH:/opt/mssql-tools18/bin&quot;' &gt;&gt; ~/.bash_profile\nRUN echo 'export PATH=&quot;$PATH:/opt/mssql-tools18/bin&quot;' &gt;&gt; ~/.bashrc\nRUN exec bash\n\nRUN apt-get install -y --allow-downgrades odbcinst=2.3.7 odbcinst1debian2=2.3.7 unixodbc=2.3.7 unixodbc-dev=2.3.7\n\n#RUN apt-get -y install unixodbc unixodbc-dev\nRUN apt-get -y install gcc g++ make autoconf libc-dev pkg-config\n\n##------------ Install Drive 5.10.1 for SQL Server -----------\nRUN apt-get install php-pear\nRUN pecl -vvv install sqlsrv-5.10.1\nRUN pecl -vvv install pdo_sqlsrv-5.10.1\n\n#instalacion de nano\nRUN apt-get install nano\n\n#For PHP CLI\nRUN echo extension=pdo_sqlsrv.so &gt;&gt; `php --ini | grep &quot;Scan for additional .ini files&quot; | sed -e &quot;s|.*:\\s*||&quot;`/30-pdo_sqlsrv.ini\nRUN echo extension=sqlsrv.so &gt;&gt; `php --ini | grep &quot;Scan for additional .ini files&quot; | sed -e &quot;s|.*:\\s*||&quot;`/20-sqlsrv.ini\n\n#For PHP WEB\nRUN echo &quot;extension=pdo_sqlsrv.so&quot; &gt;&gt; /etc/php/8.1/apache2/conf.d/30-pdo_sqlsrv.ini\nRUN echo &quot;extension=sqlsrv.so&quot; &gt;&gt; /etc/php/8.1/apache2/conf.d/20-sqlsrv.ini\n\n#Config Apache\nRUN a2dismod mpm_event\nRUN a2enmod mpm_prefork\nRUN a2enmod php8.1\n\n## ------------- Finishing ------------------\nRUN apt-get clean\n\n#Creating index of files\nRUN updatedb\n\nEXPOSE 80\nEXPOSE 443\nCMD apachectl -D FOREGROUND\n\n</code></pre>\n", "acceptedAnswer": "<p>Ok I finnally find the solution, just a fix, the openssl.cnf doesn\u00b4t match with te permition that sql server require, so\u2026 i added \u201cTrustServerCertificate\u201d =&gt; true in my query on php, and it works\nthats the same if i put in the console -C at the end of my connection setting, like this:</p>\n<pre><code>./sqlcmd -S host -U user -P password -d database -C\n</code></pre>\n", "questionSource": "https://stackoverflow.com/questions/77923026/dockerfile-php8-1-debian-sql-server"}