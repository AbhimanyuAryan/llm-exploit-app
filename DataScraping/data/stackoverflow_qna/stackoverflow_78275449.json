{"questionTitle": "UEFI application doesn&#39;t read user input", "question": "<p>I was trying to make a simple application using EDK2 that reads the user input and prints it out, but it doesn't work.</p>\n<p>That's my source:</p>\n<pre><code>#include &quot;UserInput.h&quot;\n\nEFI_STATUS EFIAPI UefiMain(IN EFI_HANDLE ImageHandle, IN EFI_SYSTEM_TABLE *SystemTable) {\n  EFI_STATUS Status;\n  EFI_INPUT_KEY Key;\n\n  Print(L&quot;Enter something: &quot;);\n\n  Status = SystemTable-&gt;ConIn-&gt;ReadKeyStroke(SystemTable-&gt;ConIn, &amp;Key);\n  if (EFI_ERROR(Status)) {\n    Print(L&quot;Failed to read user input\\n&quot;);\n    return Status;\n  }\n\n  Print(L&quot;\\nUser input: %c\\n&quot;, Key.UnicodeChar);\n\n  return EFI_SUCCESS;\n}\n</code></pre>\n<p>Result is &quot;Failed to read user input&quot;</p>\n", "acceptedAnswer": "<p>You have two options if you want to wait for the user input:</p>\n<ul>\n<li>Poll until the user presses a key:</li>\n</ul>\n<pre><code>EFI_STATUS\nReadUserInputPoll(\n    OUT CHAR16* Unicode)\n{\n    EFI_STATUS Status;\n    EFI_INPUT_KEY Key;\n    \n    if (Unicode == NULL) {\n        return EFI_INVALID_PARAMETER;\n    }\n\n    do {\n        Status = gST-&gt;ConIn-&gt;ReadKeyStroke(gST-&gt;ConIn, &amp;Key);\n        if (EFI_ERROR(Status)) {\n            if (Status != EFI_NOT_READY) {\n                return Status;\n            }\n            // wait, check for timeout, ...\n        }\n    } while (EFI_ERROR(Status));\n\n    *Unicode = Key.UnicodeChar;\n\n    return Status;\n}\n</code></pre>\n<ul>\n<li>Use the WaitForKey event:</li>\n</ul>\n<pre><code>EFI_STATUS\nReadUserInputWait(\n    OUT CHAR16* Unicode)\n{\n    EFI_STATUS Status;\n    EFI_INPUT_KEY Key;\n    UINTN Index;\n\n    if (Unicode == NULL) {\n        return EFI_INVALID_PARAMETER;\n    }\n\n    // Combine this with a timer event if you don't want to wait forever\n    Status = gBS-&gt;WaitForEvent(1, &amp;gST-&gt;ConIn-&gt;WaitForKey, &amp;Index);\n    if (EFI_ERROR(Status)) {\n        return Status;\n    }\n\n    Status = gST-&gt;ConIn-&gt;ReadKeyStroke(gST-&gt;ConIn, &amp;Key);\n    if (EFI_ERROR(Status)) {\n        return Status;\n    }\n\n    *Unicode = Key.UnicodeChar;\n\n    return Status;\n}\n</code></pre>\n", "questionSource": "https://stackoverflow.com/questions/78275449/uefi-application-doesnt-read-user-input"}