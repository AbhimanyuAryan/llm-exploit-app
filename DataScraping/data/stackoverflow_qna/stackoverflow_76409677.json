{"questionTitle": "How to correctly use the API routes in the Next JS 13 Using App Router framework", "question": "<p>I'm fairly new to React JS and Next.js. I was previously using the Page Router API in Next.js but then switched to use the new App Router in Next.js 13.</p>\n<p>Previously, using the Page Router, the structure to create a single GET request was to nest your &quot;JS&quot; file under the <code>page\\api</code>. The server automatically creates the route and returns the methods + data. For example, I would export the following function:</p>\n<p><a href=\"https://i.stack.imgur.com/CUdpe.jpg\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/CUdpe.jpg\" alt=\"enter image description here\" /></a></p>\n<pre><code>export default (req, res) =&gt; {\n  res.statusCode = 200\n  res.json({ name: 'John Doe' })\n}\n</code></pre>\n<p>Now, using the App Router and TS on Next.js 13, I understand that the mechanism is different. The API folder is nested under the app folder and you have to define a &quot;route.ts&quot; file with all the different GET, POST (etc..) methods:</p>\n<p><a href=\"https://i.stack.imgur.com/sI91v.jpg\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/sI91v.jpg\" alt=\"enter image description here\" /></a></p>\n<pre><code>import { NextApiRequest } from 'next';\nimport React from 'react';\n\n\nexport async function GET (request:NextApiRequest){\n    return new Response('John Doe')\n} \n\n</code></pre>\n<p>I have some problems understanding how to use this <code>Response</code> object. How to you specify the structure of what you return, in my case <code>{ name: 'John Doe' }</code> ? I want to change the response status to 400, how do I do that?</p>\n<p>Going forward, I have to deal with a POST request.</p>\n<pre><code>import type {NextApiRequest, NextApiResponse} from 'next'\n\ntype MyData ={\n    name:string\n}\n\nexport async function POST(\n    req: NextApiRequest, \n    res: NextApiResponse&lt;Data&gt;\n){\n    \n    const {nameLookup} = req.body\n    if(!nameLookup){\n        \n        //WHAT I WOULD LIKE TO DO IF I WAS USING THE PAGE ROUTER \n        //BUT THIS IS NOT WORKING WITH THE APP ROUTER\n\n        res.statusCode = 400\n        //- error TypeError: res.json is not a function\n        res.json({name:'Please provide something to search for'})\n        return res\n    }\n\n     //WHAT I WOULD LIKE TO DO IF I WAS USING THE PAGE ROUTER \n     //BUT THIS IS NOT WORKING WITH THE APP ROUTER\n     //- error TypeError: res.status is not a function\n     return res.status(200).json({anwser:'John Doe'})\n})\n</code></pre>\n<p>Thanks for helping, the learning curve is a bit steep having to deal with everything at the same time (TS, Next.js 13)</p>\n", "acceptedAnswer": "<p>Here is a example based on your route:</p>\n<pre><code>export async function POST(request: NextRequest) {\n  const { nameLookup }: MyData = await request.json();\n\n  if (!nameLookup) {\n    return new NextResponse(\n      JSON.stringify({ name: &quot;Please provide something to search for&quot; }),\n      { status: 400 }\n    );\n  }\n  \n  return new NextResponse(JSON.stringify({ answer: &quot;John Doe&quot; }), {\n    status: 200,\n  });\n}\n</code></pre>\n<p>See the <a href=\"https://nextjs.org/docs/app/building-your-application/routing/router-handlers#static-route-handlers\" rel=\"nofollow noreferrer\">app router documentation</a> for more details.</p>\n", "questionSource": "https://stackoverflow.com/questions/76409677/how-to-correctly-use-the-api-routes-in-the-next-js-13-using-app-router-framework"}