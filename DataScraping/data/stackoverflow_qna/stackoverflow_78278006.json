{"questionTitle": "ORA-30926: unable to get a stable set of rows in the source tables when updating a a table in a database using another table in another database", "question": "<p>I am trying to update a table in a database using another table in another database. This script was working fine until recently when I started getting the error: ORA-30926: unable to get a stable set of rows in the source tables.</p>\n<p>Please find the Script below.</p>\n<p>MERGE INTO VANTAGEDB.CERT_UPLOAD A USING (SELECT PERSONNEL_ID,SURNAME,FORENAMES,BIRTH_DATE FROM PERSONNEL@ORA12C_TO_POBM WHERE REMARK LIKE'PORTAL_VANTAGE%') B ON ( A.SURNAME = B.SURNAME  AND A.FORENAMES=B.FORENAMES AND A.BIRTH_DATE=B.BIRTH_DATE) WHEN MATCHED THEN UPDATE SET A.PERSONNEL_ID =B.PERSONNEL_ID WHERE NOT REGEXP_LIKE(PERSONNEL_ID, '^[[:digit:]]+$') AND CERT_STATUS IS NULL;</p>\n<p>I have run these embedded scripts alone and they worked fine. What do i do please?</p>\n", "acceptedAnswer": "<p>(This can't fit into a comment and I can't format code there).</p>\n<p>Apparently,</p>\n<pre><code>select surname, forename, birth_date \nfrom personnel \ngroup by surname, forename, birth_date \nhaving count(*) &gt; 1;\n</code></pre>\n<p>returns some duplicates.</p>\n<p>That's the cause of your problems because you're using these 3 columns while joining target table (<code>CERT_UPLOAD</code>) to source data set (subquery). As there are duplicates, Oracle doesn't know which <code>PERSONNEL_ID</code> to take.</p>\n<p>For example, if <code>cert_upload</code> contains</p>\n<pre><code>surname forename birth_date personnel_id\n------- -------- ---------- ------------\nWhite   Mike     10.01.2020       (NULL)\n</code></pre>\n<p>and subquery returned</p>\n<pre><code>surname forename birth_date personnel_id\n------- -------- ---------- ------------ \nWhite   Mike     10.01.2020          100\nWhite   Mike     10.01.2020          992\n</code></pre>\n<p>which personnel_id (100 or 992) should be put into <code>cert_upload</code> table? I don't know, Oracle doesn't know it either.</p>\n<p>It means that you'll have to include additional column(s) to <strong>uniquely</strong> identify each row so that join would be 1:1.</p>\n", "questionSource": "https://stackoverflow.com/questions/78278006/ora-30926-unable-to-get-a-stable-set-of-rows-in-the-source-tables-when-updating"}