{"questionTitle": "How to convert map to column in hive?", "question": "<p>Suppose we have</p>\n\n<pre><code>columnsA        columnsB\n   1           {'A':22,'B':11}\n   2           {'A':13,'C':24}\n</code></pre>\n\n<p>How to convert it to</p>\n\n<pre><code>columnsA   A   B   C\n   1       22  11  NA\n   2       13  NA  24\n</code></pre>\n", "acceptedAnswer": "<p>Use <a href=\"https://cwiki.apache.org/confluence/display/Hive/LanguageManual+UDF#LanguageManualUDF-OperatorsonComplexTypes\" rel=\"nofollow noreferrer\">Map[key] operator</a></p>\n\n<pre><code>select m['A'] A,  \n       m['B'] B, \n       m['C'] C \n  from (select str_to_map(\"A:22,B:11\") m) s;\n</code></pre>\n\n<p>Returns:</p>\n\n<pre><code>A       B       C\n22      11      NULL\n</code></pre>\n\n<p>If you need 'NA' instead of NULL, use NVL() function:</p>\n\n<pre><code>NVL(m['A'],'NA') as A\n</code></pre>\n", "questionSource": "https://stackoverflow.com/questions/59410986/how-to-convert-map-to-column-in-hive"}